<!doctype html><html lang=tr><head><title>Zero downtime ile Deployment: Azure DevOps Deployment Slots Kullanarak Azure App Service Deployment iÅŸlemi :: Berk Selvi | Software Developer</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Azure App Service'te tek Ã¶rnek olarak Ã§alÄ±ÅŸan uygulamamÄ±zÄ± Azure DevOps pipeline ile deploy ederken bÃ¼yÃ¼k olasÄ±lÄ±kla birkaÃ§ saniyelik kesinti yaÅŸanacaktÄ±r. Ã‡Ã¼nkÃ¼ uygulamaâ€¦"><meta name=keywords content="ci/cd,azure devops,azure app service,.NET,azure"><meta name=robots content="noodp"><link rel=canonical href=https://berkselvi.dev/tr/posts/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/><link rel=stylesheet href=https://berkselvi.dev/assets/style.css><link rel=stylesheet href=https://berkselvi.dev/assets/green.css><link rel=canonical href=https://berkselvi.dev/tr/posts/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/><link rel=apple-touch-icon sizes=57x57 href=/icon/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/icon/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/icon/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/icon/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/icon/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/icon/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/icon/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/icon/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/icon/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/icon/android-icon-192x192.png><link rel=icon type=image/png sizes=32x32 href=/icon/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/icon/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/icon/favicon-16x16.png><link rel=manifest href=/icon/manifest.json><meta name=msapplication-TileColor content="#1D1E28"><meta name=msapplication-TileImage content="/icon/ms-icon-144x144.png"><meta name=theme-color content="#1D1E28"><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content="berkslv"><meta property="og:locale" content="tr"><meta property="og:type" content="article"><meta property="og:title" content="Zero downtime ile Deployment: Azure DevOps Deployment Slots Kullanarak Azure App Service Deployment iÅŸlemi"><meta property="og:description" content="Azure App Service'te tek Ã¶rnek olarak Ã§alÄ±ÅŸan uygulamamÄ±zÄ± Azure DevOps pipeline ile deploy ederken bÃ¼yÃ¼k olasÄ±lÄ±kla birkaÃ§ saniyelik kesinti yaÅŸanacaktÄ±r. Ã‡Ã¼nkÃ¼ uygulamaâ€¦"><meta property="og:url" content="https://berkselvi.dev/tr/posts/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/"><meta property="og:site_name" content="Berk Selvi | Software Developer"><meta property="og:image" content="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/cover.webp"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2023-05-21 00:00:00 +0300 +0300"><script async src="https://www.googletagmanager.com/gtag/js?id=G-W0L24EMSQ5"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W0L24EMSQ5")</script><link href=https://berkselvi.dev/css/custom.css rel=stylesheet></head><body class=green><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg></div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/tr>ana sayfa</a></li><div class=spacer></div><ul class=language-selector><ul class=language-selector-current><li>tÃ¼rkÃ§e â–¾</li></ul><ul class="language-selector__more hidden"><li><a href=https://berkselvi.dev/>english</a></li><li><a href=https://berkselvi.dev/tr/>tÃ¼rkÃ§e</a></li></ul></ul></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/tr>ana sayfa</a></li><hr><li><a href=https://berkselvi.dev/>english</a></li><li><a href=https://berkselvi.dev/tr/>tÃ¼rkÃ§e</a></li></ul></nav></header><div class=content><div class=post><h4>Ä°ngilizce Ã§evirisi iÃ§in;</h4><a href=/posts/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/>Achieving Zero Downtime: Azure App Service Deployment using Azure DevOps and Deployment Slots</a><h1 class=post-title><a href=https://berkselvi.dev/tr/posts/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/>Zero downtime ile Deployment: Azure DevOps Deployment Slots Kullanarak Azure App Service Deployment iÅŸlemi</a></h1><div class=post-meta><span class=post-date>21 MayÄ±s 2023
</span><span class=post-author>:: Berk Selvi</span>
<span class=post-reading-time>:: 6 min read (1107 words)</span></div><div class=post-content><div><p>Selamlar! Azure App Service&rsquo;te tek instance olarak Ã§alÄ±ÅŸan uygulamamÄ±zÄ± Azure DevOps iÅŸlem hatlarÄ±nÄ± kullanarak daÄŸÄ±tÄ±rken bÃ¼yÃ¼k olasÄ±lÄ±kla birkaÃ§ saniyelik kesinti yaÅŸanacaktÄ±r. Ã‡Ã¼nkÃ¼ tek instance olarak Ã§alÄ±ÅŸan uygulamanÄ±n yeni sÃ¼rÃ¼me gÃ¼ncellenmesi iÃ§in yeniden baÅŸlatÄ±lmasÄ± gerekecektir. En kÃ¶tÃ¼ senaryoda, uygulama sÃ¼rÃ¼mlerimizin geÃ§iÅŸinde bir hata oluÅŸmasÄ± durumunda geri alma nedeniyle kesinti sÃ¼resi uzayacaktÄ±r.</p><p>Bu Ã¶zel sorunu app servisi iÃ§in deployment slot Ã¶zelliÄŸini kullanarak Ã§Ã¶zebiliriz. Bu Ã¶zellikle, genellikle ayrÄ± Ã¶rnekler olarak aynÄ± app servis planÄ±nda Ã§alÄ±ÅŸan iki farklÄ± Ã¶rnek, genellikle staging ve production uygulamalarÄ±, birbirinden ayrÄ± Ã¶rnekler olarak Ã§alÄ±ÅŸÄ±r ve production ortamÄ±na geÃ§iÅŸ yapÄ±ldÄ±ÄŸÄ±nda app servisi tarafÄ±ndan deÄŸiÅŸtirme iÅŸlemi yÃ¶netilir ve kesinti yaÅŸanmaz.</p><p>Bu yazÄ±da, Ã§ok basit bir Dotnet Web API projesi oluÅŸturacak, Azure DevOps Repository kullanarak barÄ±ndÄ±racak, Azure DevOps pipeline ile CI/CD pipeline oluÅŸturarak Azure App Service&rsquo;e daÄŸÄ±tacak ve deployment slot Ã¶zelliÄŸi ile kesintisiz deployment yapacaÄŸÄ±z. AÅŸaÄŸÄ±daki adÄ±mlarÄ± takip ederek sÃ¼reci 5 adÄ±mda tamamlayacaÄŸÄ±z. BaÅŸlayalÄ±m.</p><ol><li>UygulamanÄ±n OluÅŸturulmasÄ±</li><li>Azure DevOps Repo</li><li>Azure DevOps build pipeline</li><li>Azure App service</li><li>Zero downtime testing</li></ol><p>##Â UygulamanÄ±n OluÅŸturulmasÄ±</p><p>Deploy etmek iÃ§in basit bir Dotnet Web API projesi oluÅŸturuyoruz. Bunun iÃ§in aÅŸaÄŸÄ±daki komutlarÄ± kullanÄ±yoruz.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir backend  
</span></span><span style=display:flex><span>cd ./backend  
</span></span><span style=display:flex><span>dotnet new sln -n Slot  
</span></span><span style=display:flex><span>dotnet new webapi -n Slot.API  
</span></span><span style=display:flex><span>dotnet sln add ./Slot.API/
</span></span></code></pre></div><p>properties/launchSetting.json dosyasÄ±ndaki <em>profiles.http</em> Ã¶zelliÄŸini aÅŸaÄŸÄ±daki gibi gÃ¼ncelliyoruz. Burada yalnÄ±zca <em>applicationUrl</em> ve <em>launchBrowser</em> Ã¶zelliklerini gÃ¼ncelledik.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#75715e>// ...  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#e6db74>&#34;profiles&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {  
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;http&#34;</span>: {  
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;commandName&#34;</span>: <span style=color:#e6db74>&#34;Project&#34;</span>,  
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;dotnetRunMessages&#34;</span>: <span style=color:#66d9ef>true</span>,  
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;launchBrowser&#34;</span>: <span style=color:#66d9ef>false</span>,  
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;launchUrl&#34;</span>: <span style=color:#e6db74>&#34;swagger&#34;</span>,  
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;applicationUrl&#34;</span>: <span style=color:#e6db74>&#34;http://localhost:5050&#34;</span>,  
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;environmentVariables&#34;</span>: {  
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;ASPNETCORE_ENVIRONMENT&#34;</span>: <span style=color:#e6db74>&#34;Development&#34;</span>  
</span></span><span style=display:flex><span>      }  
</span></span><span style=display:flex><span>    },  
</span></span><span style=display:flex><span><span style=color:#75715e>// ...
</span></span></span></code></pre></div><p>AÅŸaÄŸÄ±daki gÃ¼ncellemeyi Program.cs dosyasÄ±nda yaparak, uygulamanÄ±n eriÅŸilebilir ve /health uÃ§ noktasÄ±na yapÄ±lan isteklere yanÄ±t verebileceÄŸini test edeceÄŸiz. UygulamanÄ±zda bir veritabanÄ± kullanÄ±yorsanÄ±z, <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.extensions.dependencyinjection.entityframeworkcorehealthchecksbuilderextensions.adddbcontextcheck?view=dotnet-plat-ext-8.0">AddDbContextCheck</a> yÃ¶ntemi ile veritabanÄ±na eriÅŸimde bir sorun olup olmadÄ±ÄŸÄ±nÄ± da test edebilirsiniz.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>var</span> builder = WebApplication.CreateBuilder(args);  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#75715e>// ...  </span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>builder.Services.AddHealthChecks();  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> app = builder.Build();  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#75715e>// ...  </span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#75715e>// app.UseHttpsRedirection();  </span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>app.MapControllers();  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>app.UseHealthChecks(<span style=color:#e6db74>&#34;/health&#34;</span>);  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>app.Run();
</span></span></code></pre></div><p>UygulamamÄ±z iÃ§in bu kadar! Åimdi ÅŸu komutlarÄ± Ã§alÄ±ÅŸtÄ±rarak localhost:5050/health adresine eriÅŸebiliriz.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd ./Slot.API  
</span></span><span style=display:flex><span>dotnet run  
</span></span><span style=display:flex><span>curl -4 http://localhost:5050/health  
</span></span><span style=display:flex><span><span style=color:#75715e># Healthy</span>
</span></span></code></pre></div><p>Daha sonra uygulamamÄ±zÄ± daÄŸÄ±tmak iÃ§in Docker kullanacaÄŸÄ±z, bu yÃ¼zden Dockerfile dosyamÄ±zÄ± sln dosyamÄ±zla aynÄ± dizine koyuyoruz.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Dockerfile data-lang=Dockerfile><span style=display:flex><span><span style=color:#75715e># Build Stage  </span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>FROM</span><span style=color:#e6db74> mcr.microsoft.com/dotnet/aspnet:7.0-alpine AS base  </span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>WORKDIR</span><span style=color:#e6db74> /app  </span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>EXPOSE</span><span style=color:#e6db74> 8080  </span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  <span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  <span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Publish Stage  </span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>FROM</span><span style=color:#e6db74> mcr.microsoft.com/dotnet/sdk:7.0-alpine AS build  </span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>COPY</span> <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;Slot.API/Slot.API.csproj&#34;</span>, <span style=color:#e6db74>&#34;Slot.API/&#34;</span><span style=color:#f92672>]</span>  <span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> dotnet restore <span style=color:#e6db74>&#34;Slot.API/Slot.API.csproj&#34;</span>  <span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>COPY</span> . .  <span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>WORKDIR</span><span style=color:#e6db74> &#34;/Slot.API&#34;  </span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> dotnet build <span style=color:#e6db74>&#34;Slot.API.csproj&#34;</span> -c Release -o /app/build  <span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  <span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>FROM</span><span style=color:#e6db74> build AS publish  </span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> dotnet publish <span style=color:#e6db74>&#34;Slot.API.csproj&#34;</span> -c Release -o /app/publish /p:UseAppHost<span style=color:#f92672>=</span>false  <span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  <span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>FROM</span><span style=color:#e6db74> base AS final  </span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>WORKDIR</span><span style=color:#e6db74> /app  </span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>COPY</span> --from<span style=color:#f92672>=</span>publish /app/publish .  <span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>ENV</span> ASPNETCORE_URLS<span style=color:#f92672>=</span>http://*:8080  <span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>ENV</span> ASPNETCORE_ENVIRONMENT<span style=color:#f92672>=</span>Production  
</span></span><span style=display:flex><span><span style=color:#66d9ef>ENTRYPOINT</span> [<span style=color:#e6db74>&#34;dotnet&#34;</span>, <span style=color:#e6db74>&#34;Slot.API.dll&#34;</span>]<span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>AÅŸaÄŸÄ±daki iki komutu kullanarak imajÄ± baÅŸarÄ±yla oluÅŸturup container&rsquo;Ä± build edip Ã§alÄ±ÅŸtÄ±rabiliriz.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker build -t deployment-slots-demo .  
</span></span><span style=display:flex><span>docker run -it -p 80:8080 deployment-slots-demo -n deployment-slots-demo-container
</span></span></code></pre></div><h2 id=uygulamanÄ±n-Ã§alÄ±ÅŸÄ±yor-olduÄŸunu-doÄŸrulayÄ±n>UygulamanÄ±n Ã‡alÄ±ÅŸÄ±yor OlduÄŸunu DoÄŸrulayÄ±n<a href=#uygulamanÄ±n-Ã§alÄ±ÅŸÄ±yor-olduÄŸunu-doÄŸrulayÄ±n class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Ã–nceki adÄ±mda saÄŸlÄ±k kontrolÃ¼ Ã¶zelliÄŸi ile uygulamamÄ±zÄ± oluÅŸturduktan sonra, bu adrese her saniye bir istek yaparak uygulamanÄ±n eriÅŸilebilir olduÄŸunu doÄŸrulayabiliriz. Bu ÅŸekilde, Azure&rsquo;a daÄŸÄ±tÄ±ldÄ±ÄŸÄ±nda eriÅŸilebilir olduÄŸunu doÄŸrulamÄ±ÅŸ olacaÄŸÄ±z.</p><p>Bu bÃ¶lÃ¼mde, uygulamanÄ±n her 50 milisaniyede bir istek yaparak eriÅŸilebilir olup olmadÄ±ÄŸÄ±nÄ± doÄŸrulamak iÃ§in basit bir Node.js script&rsquo;i yazacaÄŸÄ±z. Bunun iÃ§in aÅŸaÄŸÄ±daki komutlarÄ± kullanÄ±yoruz.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir health-check  
</span></span><span style=display:flex><span>npm init -y  
</span></span><span style=display:flex><span>touch index.js  
</span></span><span style=display:flex><span>npm install node-fetch
</span></span></code></pre></div><p>AÅŸaÄŸÄ±daki kÄ±smÄ± package.json dosyasÄ±na ekliyoruz.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#75715e>// ...  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#e6db74>&#34;scripts&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {  
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;start&#34;</span>: <span style=color:#e6db74>&#34;node index.js&#34;</span>  
</span></span><span style=display:flex><span>}<span style=color:#960050;background-color:#1e0010>,</span>  
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;type&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#e6db74>&#34;module&#34;</span><span style=color:#960050;background-color:#1e0010>,</span>  
</span></span><span style=display:flex><span><span style=color:#75715e>// ...
</span></span></span></code></pre></div><p>index.js dosyamÄ±zÄ± aÅŸaÄŸÄ±daki gibi oluÅŸturabiliriz. Bu kod ile belirtilen url&rsquo;e her 50 milisaniyede bir istek yapacak ve yanÄ±tÄ± konsola yazacaktÄ±r.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>fetch</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;node-fetch&#34;</span>;  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>check</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>async</span> (<span style=color:#a6e22e>url</span>) =&gt; {  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>try</span> {  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>fetch</span>(<span style=color:#a6e22e>url</span>, {  
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>method</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;GET&#34;</span>,  
</span></span><span style=display:flex><span>    });  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>text</span>();  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>result</span> <span style=color:#f92672>!==</span> <span style=color:#e6db74>&#34;Healthy&#34;</span>) {  
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>new</span> Date().<span style=color:#a6e22e>toISOString</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>, </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>url</span><span style=color:#e6db74>}</span><span style=color:#e6db74> result is not OK`</span>);  
</span></span><span style=display:flex><span>    }  
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {  
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>new</span> Date().<span style=color:#a6e22e>toISOString</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>, </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>url</span><span style=color:#e6db74>}</span><span style=color:#e6db74> error is </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>message</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);  
</span></span><span style=display:flex><span>  }  
</span></span><span style=display:flex><span>};  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>(() =&gt; {  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>setInterval</span>(() =&gt; {  
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>check</span>(<span style=color:#e6db74>&#34;http://localhost:5050/health&#34;</span>);  
</span></span><span style=display:flex><span>  }, <span style=color:#ae81ff>50</span>);  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>setInterval</span>(() =&gt; {  
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>check</span>(<span style=color:#e6db74>&#34;http://localhost:5050/health&#34;</span>);  
</span></span><span style=display:flex><span>  }, <span style=color:#ae81ff>50</span>);  
</span></span><span style=display:flex><span>})();
</span></span></code></pre></div><p>API projemizde UseHttpsRedirection middleware&rsquo;ini kapatmazsanÄ±z, geÃ§ersiz bir SSL sertifikasÄ± hatasÄ± alabilirsiniz. Bunu aÅŸaÄŸÄ±daki gibi dÃ¼zeltebilirsiniz.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>fetch</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;node-fetch&#34;</span>;  
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>https</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;https&#34;</span>;  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>httpsAgent</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>https</span>.<span style=color:#a6e22e>Agent</span>({  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rejectUnauthorized</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>,  
</span></span><span style=display:flex><span>});  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>check</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>async</span> (<span style=color:#a6e22e>url</span>) =&gt; {  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>try</span> {  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>fetch</span>(<span style=color:#a6e22e>url</span>, {  
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>method</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;GET&#34;</span>,  
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>agent</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>httpsAgent</span>,  
</span></span><span style=display:flex><span>    });  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>text</span>();  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>result</span> <span style=color:#f92672>!==</span> <span style=color:#e6db74>&#34;Healthy&#34;</span>) {  
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>new</span> Date().<span style=color:#a6e22e>toISOString</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>, </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>url</span><span style=color:#e6db74>}</span><span style=color:#e6db74> result is not OK`</span>);  
</span></span><span style=display:flex><span>    }  
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {  
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>new</span> Date().<span style=color:#a6e22e>toISOString</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>, </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>url</span><span style=color:#e6db74>}</span><span style=color:#e6db74> error is </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>message</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);  
</span></span><span style=display:flex><span>  }  
</span></span><span style=display:flex><span>};  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>(() =&gt; {  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>setInterval</span>(() =&gt; {  
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>check</span>(<span style=color:#e6db74>&#34;https://localhost:5051/health&#34;</span>);  
</span></span><span style=display:flex><span>  }, <span style=color:#ae81ff>50</span>);  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>setInterval</span>(() =&gt; {  
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>check</span>(<span style=color:#e6db74>&#34;https://localhost:5051/health&#34;</span>);  
</span></span><span style=display:flex><span>  }, <span style=color:#ae81ff>50</span>);  
</span></span><span style=display:flex><span>})();
</span></span></code></pre></div><h2 id=azure-devops-repo>Azure DevOps Repo<a href=#azure-devops-repo class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Azure DevOps hesabÄ±mÄ±za giriÅŸ yapÄ±yoruz ve aÅŸaÄŸÄ±daki gibi yeni bir repo oluÅŸturuyoruz.</p><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-1.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-2.webp alt="Azure deployment" loading=lazy><p>Bu repo&rsquo;yu bilgisayarÄ±mÄ±za klonluyoruz, yazdÄ±ÄŸÄ±mÄ±z kodu bu repo klasÃ¶rÃ¼ne taÅŸÄ±yoruz ve kodlarÄ± origin&rsquo;e iletiyoruz.</p><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-3.webp alt="Azure deployment" loading=lazy><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git add .  
</span></span><span style=display:flex><span>git commit -m <span style=color:#e6db74>&#34;inital commit&#34;</span>  
</span></span><span style=display:flex><span>git push origin
</span></span></code></pre></div><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-4.webp alt="Azure deployment" loading=lazy><h2 id=azure-devops-build-pipeline>Azure DevOps build pipeline<a href=#azure-devops-build-pipeline class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Pipeline ekranÄ±nda, en saÄŸ Ã¼stteki New pipeline dÃ¼ÄŸmesine tÄ±klÄ±yoruz. ArdÄ±ndan aÅŸaÄŸÄ±daki adÄ±mlarÄ± izleyerek docker dosyasÄ±nÄ± oluÅŸturup ve Azure Container Registry&rsquo;e iteleriyoruz.</p><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-5.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-6.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-7.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-8.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-9.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-10.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-11.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-12.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-13.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-14.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-15.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-16.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-17.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-18.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-19.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-20.webp alt="Azure deployment" loading=lazy><p>Åimdi Azure Container Registry&rsquo;de image deployment iÅŸlemimizin baÅŸarÄ±lÄ± olduÄŸunu kontrol ediyoruz.</p><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-21.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-22.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-23.webp alt="Azure deployment" loading=lazy><p>GÃ¶rÃ¼ldÃ¼ÄŸÃ¼ gibi, boru hattÄ± Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±ÄŸÄ±nda, Docker image&rsquo;i baÅŸarÄ±yla Azure Container Registry&rsquo;de oluÅŸturulmuÅŸ ve kullanÄ±lmak Ã¼zere bizi bekliyor. Bu ayarlarÄ±n ardÄ±ndan, main branch&rsquo;de /backend dizininde yapÄ±lan her deÄŸiÅŸiklik ile tetiklenerek yeni bir Docker image&rsquo;i oluÅŸturulacak.</p><h2 id=azure-app-service>Azure App service<a href=#azure-app-service class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Azure App servisi, gÃ¼venlik, yÃ¼k dengeleme, otomatik Ã¶lÃ§eklendirme gibi Ã¶zellikleriyle Azure tarafÄ±ndan yÃ¶netilen web uygulamalarÄ±nÄ± daÄŸÄ±tmamÄ±za olanak tanÄ±r. Azure app servisleri ekranÄ± Ã¼zerinden yeni bir app servisi oluÅŸturabiliriz.</p><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-24.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-25.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-26.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-27.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-28.webp alt="Azure deployment" loading=lazy><p>App servisini oluÅŸturduktan sonra, Container Registry ÅŸifresini yapÄ±landÄ±rma sekmesinden gÃ¼ncellemeniz gerekebilir.</p><p>##Â Azure DevOps release pipeline</p><p>release pipeline ile, build pipeline tarafÄ±ndan oluÅŸturulan Docker image&rsquo;i kullanarak App servisine deploy edilir ve uygulamamÄ±zÄ± yayÄ±nlamÄ±ÅŸ oluruz.</p><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-29.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-30.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-31.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-32.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-33.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-34.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-35.webp alt="Azure deployment" loading=lazy><p>Staging daÄŸÄ±tÄ±mÄ±na girdiÄŸimizde, staging versiyonumuz iÃ§in daÄŸÄ±tÄ±m alÄ±rÄ±z ve Docker image&rsquo;inde yaptÄ±ÄŸÄ±mÄ±z deÄŸiÅŸikliklerin canlÄ± hale gelmesini saÄŸlamak iÃ§in uygulama servisimizi yeniden baÅŸlatÄ±rÄ±z.</p><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-36.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-37.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-38.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-39.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-40.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-41.webp alt="Azure deployment" loading=lazy><p>production aÅŸamasÄ±nda, app service&rsquo;de bir deployment yapmÄ±yoruz, bunun yerine staging aÅŸamasÄ±yla deÄŸiÅŸim iÅŸlemini gerÃ§ekleÅŸtiriyoruz ve bu ÅŸekilde, production eriÅŸiminde herhangi bir kesinti yaÅŸamadan staging&rsquo;de Ã§alÄ±ÅŸan uygulamamÄ±zÄ± production ile deÄŸiÅŸtirdiÄŸimiz iÃ§in production uygulamamÄ±za eriÅŸebiliyoruz.</p><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-42.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-43.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-44.webp alt="Azure deployment" loading=lazy><br><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-45.webp alt="Azure deployment" loading=lazy><p>Åimdi, main bracnh&rsquo;te yapÄ±lan herhangi bir deÄŸiÅŸiklik Ã¶nce build pipeline (CI) ile geÃ§ecek, ardÄ±ndan release pipeline (CD) geÃ§ecek ve release, staging ortamÄ±na yapÄ±lacak. Production ortamÄ±na geÃ§mek isterseniz, production deployment iÅŸlemi manuel olarak release ekranÄ±ndan tetiklenmelidir.</p><img src=/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-46.webp alt="Azure deployment" loading=lazy><h2 id=zero-downtime-testing>Zero downtime testing<a href=#zero-downtime-testing class=hanchor arialabel=Anchor>&#8983;</a></h2><p>UygulamamÄ±z iÃ§in gerekli pipeline&rsquo;larÄ± baÅŸarÄ±yla oluÅŸturduk, bundan sonra release sÄ±rasÄ±nda herhangi bir kesinti olup olmadÄ±ÄŸÄ±nÄ± test etmemiz gerekecek. Bunun iÃ§in <em>health-check/index.js</em> dosyamÄ±zÄ± aÅŸaÄŸÄ±daki gibi gÃ¼ncelliyorum ve uygulamayÄ± npm run start komutuyla Ã§alÄ±ÅŸtÄ±rÄ±p pipeline&rsquo;Ä± tetikliyorum. ArdÄ±ndan, konsolda herhangi bir hata mesajÄ± almadan, yani herhangi bir kesinti olmadan deployment sÃ¼recini tamamlÄ±yorum!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>fetch</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;node-fetch&#34;</span>;  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>check</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>async</span> (<span style=color:#a6e22e>url</span>) =&gt; {  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>try</span> {  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>fetch</span>(<span style=color:#a6e22e>url</span>, {  
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>method</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;GET&#34;</span>,  
</span></span><span style=display:flex><span>    });  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>text</span>();  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>result</span> <span style=color:#f92672>!==</span> <span style=color:#e6db74>&#34;Healthy&#34;</span>) {  
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>new</span> Date().<span style=color:#a6e22e>toISOString</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>, </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>url</span><span style=color:#e6db74>}</span><span style=color:#e6db74> result is not OK`</span>);  
</span></span><span style=display:flex><span>    }  
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {  
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>new</span> Date().<span style=color:#a6e22e>toISOString</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>, </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>url</span><span style=color:#e6db74>}</span><span style=color:#e6db74> error is </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>message</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);  
</span></span><span style=display:flex><span>  }  
</span></span><span style=display:flex><span>};  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>(() =&gt; {  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>setInterval</span>(() =&gt; {  
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>check</span>(<span style=color:#e6db74>&#34;https://deployment-slot-demo.azurewebsites.net/health&#34;</span>);  
</span></span><span style=display:flex><span>  }, <span style=color:#ae81ff>50</span>);  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>setInterval</span>(() =&gt; {  
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>check</span>(<span style=color:#e6db74>&#34;https://deployment-slot-demo-staging.azurewebsites.net/health&#34;</span>);  
</span></span><span style=display:flex><span>  }, <span style=color:#ae81ff>50</span>);  
</span></span><span style=display:flex><span>})();
</span></span></code></pre></div><p>Benzer bir iÅŸlemi deployment slots Ã¶zelliÄŸi uygulamayan bir App Service ile denersek, aÅŸaÄŸÄ±daki gibi bir hata alÄ±rÄ±z.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>2023-11-14T12:28:39.506Z, <span style=color:#f92672>[</span>some-url<span style=color:#f92672>]</span>/health error is request to <span style=color:#f92672>[</span>some-url<span style=color:#f92672>]</span>/health failed, reason: connect ETIMEDOUT 100.100.100.100:443
</span></span></code></pre></div><hr><h2 id=sonuÃ§>SonuÃ§<a href=#sonuÃ§ class=hanchor arialabel=Anchor>&#8983;</a></h2><p>OkuduÄŸunuz iÃ§in teÅŸekkÃ¼rler! ğŸ‰ YazÄ±lÄ±m geliÅŸtirme alanÄ±ndaki araÅŸtÄ±rmalarÄ±mÄ± kaÃ§Ä±rmamak iÃ§in <a href=https://x.com/berkslv>@berkslv</a> adresinden takipte kalabilirsiniz.</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>DiÄŸer yazÄ±larÄ± oku</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://berkselvi.dev/tr/posts/how-to-secure-dotnet-vue-application-with-keycloak/><span class=button__icon>â†</span>
<span class=button__text>Dotnet ve Vue.js uygulamasÄ±nÄ± Keycloak ile nasÄ±l gÃ¼venliÄŸi saÄŸlanÄ±r?</span>
</a></span><span class="button next"><a href=https://berkselvi.dev/tr/posts/how-to-deploy-a-react-app-with-nginx-using-docker-with-react-router-dom/><span class=button__text>React-router-dom kullanarak bir React uygulamasÄ±nÄ± Docker ile Nginx'e nasÄ±l deploy ederiz?</span>
<span class=button__icon>â†’</span></a></span></div></div><script src=https://utteranc.es/client.js repo=berkslv/berkselvi.dev issue-term=title theme=dark-blue crossorigin=anonymous async></script></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>Made by Berk Selvi</span></div></div></footer><script src=https://berkselvi.dev/assets/main.js></script><script src=https://berkselvi.dev/assets/prism.js></script><script src=https://berkselvi.dev/assets/languageSelector.js></script></div></body></html>