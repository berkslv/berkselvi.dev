<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Posts on Berk Selvi | Software Developer</title><link>https://berkselvi.dev/tr/posts/</link><description>Recent content in Posts on Berk Selvi | Software Developer</description><generator>Hugo -- gohugo.io</generator><language>tr-TR</language><copyright>Made by Berk Selvi. &lt;br> Bu websitesi &lt;a href='https://github.com/berkslv/berkselvi.dev' target='_blank'>open source&lt;/a> olarak yayÄ±nlanmÄ±ÅŸtÄ±r.</copyright><lastBuildDate>Thu, 24 Jul 2025 00:00:00 +0300</lastBuildDate><atom:link href="https://berkselvi.dev/tr/posts/index.xml" rel="self" type="application/rss+xml"/><item><title>.NETâ€™te Kod Kalitesini Zorunlu kÄ±lÄ±n: .editorconfig &amp; Analyzers &amp; Pre-Commit Hooks</title><link>https://berkselvi.dev/tr/posts/enforce-code-quality-in-net-editorconfig-analyzers-pre-commit-hooks/</link><pubDate>Thu, 24 Jul 2025 00:00:00 +0300</pubDate><guid>https://berkselvi.dev/tr/posts/enforce-code-quality-in-net-editorconfig-analyzers-pre-commit-hooks/</guid><description>&lt;p>Kod kalitesini korumak ve iyileÅŸtirmek yazdÄ±ÄŸÄ±mÄ±z her satÄ±rda hem kendimize hem de takÄ±m arkadaÅŸlarÄ±mÄ±za karÅŸÄ± bir sorumluluÄŸumuz olarak dÃ¼ÅŸÃ¼nÃ¼yorum. Bu sorumluluÄŸu uygularken kimi zaman acele yazÄ±lan kodlarla, yetiÅŸmesi gereken deadlineâ€™larla uygulanmasÄ± gereken pratikleri gÃ¶z ardÄ± edebiliyoruz. AyrÄ±ca, bu pratikleri takÄ±m arkadaÅŸlarÄ±mÄ±za yaygÄ±nlaÅŸtÄ±rÄ±rken de zorluklar yaÅŸayabiliyoruz.&lt;/p>
&lt;p>Bu tip sorunlarÄ± aÅŸÄ±p, Kod kalitesini developerâ€™Ä±n inisiyatifine bÄ±rakmadan bir zorunluluk haline getirmenin birkaÃ§ adÄ±mdan oluÅŸan ve 20+ developerâ€™Ä±n Ã§alÄ±ÅŸtÄ±ÄŸÄ±, 10+ servisten oluÅŸan projeden Ã§Ä±karÄ±lan deneyimlerle ispatlanan yÃ¶ntemini paylaÅŸmak istiyorum.&lt;/p></description><content>&lt;p>Kod kalitesini korumak ve iyileÅŸtirmek yazdÄ±ÄŸÄ±mÄ±z her satÄ±rda hem kendimize hem de takÄ±m arkadaÅŸlarÄ±mÄ±za karÅŸÄ± bir sorumluluÄŸumuz olarak dÃ¼ÅŸÃ¼nÃ¼yorum. Bu sorumluluÄŸu uygularken kimi zaman acele yazÄ±lan kodlarla, yetiÅŸmesi gereken deadlineâ€™larla uygulanmasÄ± gereken pratikleri gÃ¶z ardÄ± edebiliyoruz. AyrÄ±ca, bu pratikleri takÄ±m arkadaÅŸlarÄ±mÄ±za yaygÄ±nlaÅŸtÄ±rÄ±rken de zorluklar yaÅŸayabiliyoruz.&lt;/p>
&lt;p>Bu tip sorunlarÄ± aÅŸÄ±p, Kod kalitesini developerâ€™Ä±n inisiyatifine bÄ±rakmadan bir zorunluluk haline getirmenin birkaÃ§ adÄ±mdan oluÅŸan ve 20+ developerâ€™Ä±n Ã§alÄ±ÅŸtÄ±ÄŸÄ±, 10+ servisten oluÅŸan projeden Ã§Ä±karÄ±lan deneyimlerle ispatlanan yÃ¶ntemini paylaÅŸmak istiyorum.&lt;/p>
&lt;p>Ä°lk olarak TreatWarningsAsErrors flagâ€™i ile projenin 1000+ warning ile productionâ€™a Ã§Ä±kmasÄ±nÄ± engelleyeceÄŸiz.&lt;/p>
&lt;p>DevamÄ±nda .editorconfig dosyalarÄ± ile .NET tarafÄ±ndan default olarak saÄŸlanan kurallarla Ã¶rneÄŸin property isimlendirmeleri takÄ±ma yaygÄ±nlaÅŸtÄ±rÄ±lmasÄ± gereken genel-geÃ§er bir kural deÄŸil bir zorunluluk haline getireceÄŸiz.&lt;/p>
&lt;p>Bu kurallarÄ± SonarAnalyzer ve Roslynator gibi paketlerle geliÅŸtirip, sonar taramalarÄ±na daha girmeden ilgili sorunlarÄ± Ã§Ã¶zÃ¼p, daha performanslÄ± ve gÃ¼venli kodlar yazacaÄŸÄ±z.&lt;/p>
&lt;p>Son olarakta pre-commit hook ile, build olmayan projenin ve fail eden testlerin CI/CD pipelinelarÄ±nda hataya sebep olmadan Ã¶nce, daha commit atmadan bu testleri gÃ¶rÃ¼p, dÃ¼zelteceÄŸiz. Haydi baÅŸlayalÄ±m.&lt;/p>
&lt;h2 id="treatwarningsaserrors-ile-warning-iÃ§ermeyen-proje">TreatWarningsAsErrors ile warning iÃ§ermeyen proje&lt;/h2>
&lt;p>.NET ile proje geliÅŸtirirken en Ã§ok warning â€œPossible null referenceâ€ ile ortaya Ã§Ä±kÄ±yor. Bu warningle sÄ±nÄ±rlÄ± olmadan projemizde birÃ§ok farklÄ± warning ortaya Ã§Ä±kabilir ve bunlara saygÄ± duymazsak runtimeâ€™da her yerde NullReferenceException almamÄ±z kadar doÄŸal birÅŸey olamaz.&lt;/p>
&lt;p>Bu tip hatalar daha ortaya Ã§Ä±kmadan Ã§Ã¶zmek iÃ§in Warningâ€™lere Error olarak muamele edip, projenin build olmasÄ±nÄ± engelleyebiliriz. Bunun iÃ§inde .csproj dosyasÄ±na aÅŸaÄŸÄ±daki flagâ€™i eklememiz yeterlidir.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-xml" data-lang="xml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;PropertyGroup&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;TreatWarningsAsErrors&amp;gt;&lt;/span>true&lt;span style="color:#f92672">&amp;lt;/TreatWarningsAsErrors&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">&amp;lt;!-- Sadece gerÃ§ekten gerekli ise --&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;WarningsNotAsErrors&amp;gt;&lt;/span>CS0108;NU1901;NU1902;NU1903;NU1904;NU1701&lt;span style="color:#f92672">&amp;lt;/WarningsNotAsErrors&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;/PropertyGroup&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ancak bu flag ile .NET platformu tarafÄ±ndan verilen tÃ¼m Warningâ€™ler Error olarak gÃ¶rÃ¼leceÄŸi iÃ§in Ã¶rneÄŸin Nuget paketleri tarafÄ±ndan verilen ve bizim tarafÄ±mÄ±zca Ã§Ã¶zÃ¼lemeyecek warningler baÅŸÄ±mÄ±zÄ± Ã§okÃ§a aÄŸrÄ±tabilir. Bu tÃ¼r sorunlarÄ±n Ã¼stesinden gelmek iÃ§inde WarningsNotAsErrors flagâ€™ini kullanabiliyoruz. Ancak bunu sadece Ã§Ã¶zÃ¼lemez hatalar iÃ§in yapmak Ã¶nemli.&lt;/p>
&lt;h2 id="editorconfig-ile-projenin-kurallarÄ±nÄ±-belirleyelim">.editorconfig ile projenin kurallarÄ±nÄ± belirleyelim&lt;/h2>
&lt;p>EditorConfig, aynÄ± proje Ã¼zerinde Ã§alÄ±ÅŸan birden fazla geliÅŸtiricinin farklÄ± IDE&amp;rsquo;ler aracÄ±lÄ±ÄŸÄ±yla tutarlÄ± kodlama stilleri korumasÄ±na yardÄ±mcÄ± olur. .NET projelerine Ã¶zel bir pratik deÄŸildir, dil baÄŸÄ±msÄ±zdÄ±r ve ortak kurallarÄ± olduÄŸu gibi dil Ã¶zelinde kurallarÄ±da mevcuttur.&lt;/p>
&lt;p>Bu sayede sÄ±nÄ±flar &lt;a href="https://learn.microsoft.com/en-us/dotnet/fundamentals/code-analysis/categories">.NET&lt;/a> tarafÄ±ndan standart saÄŸlanan kurallar ile Ã¶rneÄŸin PascalCase, deÄŸiÅŸkenler camelCase, sabitler LOWER_CASE olmalÄ± gibi kurallarÄ± proje seviyesinde tanÄ±mlayabiliriz.&lt;/p>
&lt;p>Bu kurallara ek olarak &lt;a href="https://rules.sonarsource.com/csharp/">SonarAnalyzer&lt;/a> ile Ã¶rneÄŸin &lt;code>name == â€œâ€&lt;/code> gibi facia bir kullanÄ±mÄ± sonar taramasÄ±na girmeden yakalayÄ±p &lt;code>string.IsNullOrEmpty(name)&lt;/code> Ã¶nerisini Visual Studio kullanÄ±yorsanÄ±z Alt+Enter ile direk Ã§Ã¶zÃ¼m Ã¶nerisini olarak alÄ±p uygulayabilirsiniz. Bu sayede CI/CD adÄ±mÄ±nda sonar taramasÄ±na giren kodunuz Ã§ok daha az hatayla taramaya baÅŸlayacaktÄ±r.&lt;/p>
&lt;p>Harika bir diÄŸer code analyzer kÃ¼tÃ¼phanesi olan &lt;a href="https://josefpihrt.github.io/docs/roslynator/">Roslynator&lt;/a> sayesinde de Ã§ok daha spesifik kurallarÄ± projemizde uygulayabiliriz. Ã–rneÄŸin class propertyâ€™leri arasÄ±nda bir boÅŸluk olmalÄ± gibi kod okunaklÄ±ÄŸÄ±nÄ± arttÄ±ran kurallarÄ± bu sayede uygulayabiliriz.&lt;/p>
&lt;p>Bu tÃ¼r third party analyzer kÃ¼tÃ¼phanelerini repo iÃ§erisindeki tÃ¼m projelere uygulamak iÃ§in her projeye tek tek uygulamaktansa root dizinde Directory.Build.Props isminde bir dosya oluÅŸturup iÃ§eriÄŸini aÅŸaÄŸÄ±daki ÅŸekilde oluÅŸturursak build adÄ±mÄ±nda bu paketler tÃ¼m projelere otomatik eklenecektir.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-xml" data-lang="xml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;Project&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;ItemGroup&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;PackageReference&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">Include=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;Roslynator.Analyzers&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">Version=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;4.12.4&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">PrivateAssets=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;all&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">Condition=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;$(MSBuildProjectExtension) == &amp;#39;.csproj&amp;#39;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;PackageReference&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">Include=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;Roslynator.Formatting.Analyzers&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">Version=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;4.12.4&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">PrivateAssets=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;all&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">Condition=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;$(MSBuildProjectExtension) == &amp;#39;.csproj&amp;#39;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;PackageReference&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">Include=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;SonarAnalyzer.CSharp&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">Version=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;9.32.0.97167&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">PrivateAssets=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;all&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">Condition=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;$(MSBuildProjectExtension) == &amp;#39;.csproj&amp;#39;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;/ItemGroup&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;/Project&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ã–rnek olarak aÅŸaÄŸÄ±daki .editorconfig dosyasÄ±na gÃ¶z atabiliriz. Burada IDE ile tanÄ±mlanan kurallar .NET tarafÄ±ndan saÄŸlanan standart kurallar, rcs ile baÅŸlayanlar roslynator ve S ile baÅŸlayanlar sonar kurallarÄ±dÄ±r. Bu kurallar suggestion, warning ve error seviyesiyle tanÄ±mlanÄ±p her bir proje iÃ§in Ã¶zelleÅŸtirilebilir.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># top-most EditorConfig file&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>root &lt;span style="color:#f92672">=&lt;/span> true
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Don&amp;#39;t use tabs for indentation.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>*&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>indent_style &lt;span style="color:#f92672">=&lt;/span> space
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># (Please don&amp;#39;t specify an indent_size here; that has too many unintended consequences.)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>spelling_exclusion_path &lt;span style="color:#f92672">=&lt;/span> SpellingExclusions.dic
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Code files&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>*.&lt;span style="color:#f92672">{&lt;/span>cs,csx,vb,vbx&lt;span style="color:#f92672">}]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>indent_size &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>insert_final_newline &lt;span style="color:#f92672">=&lt;/span> true
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>charset &lt;span style="color:#f92672">=&lt;/span> utf-8-bom
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># XML project files&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>*.&lt;span style="color:#f92672">{&lt;/span>csproj,vbproj,vcxproj,vcxproj.filters,proj,projitems,shproj&lt;span style="color:#f92672">}]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>indent_size &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># XML config files&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>*.&lt;span style="color:#f92672">{&lt;/span>props,targets,ruleset,config,nuspec,resx,vsixmanifest,vsct&lt;span style="color:#f92672">}]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>indent_size &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># JSON files&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>*.json&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>indent_size &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Powershell files&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>*.ps1&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>indent_size &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Shell script files&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>*.sh&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>end_of_line &lt;span style="color:#f92672">=&lt;/span> lf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>indent_size &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Dotnet code style settings:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>*.&lt;span style="color:#f92672">{&lt;/span>cs,vb&lt;span style="color:#f92672">}]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Sort using and Import directives with System.* appearing first&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet_sort_system_directives_first &lt;span style="color:#f92672">=&lt;/span> true
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet_separate_import_directive_groups &lt;span style="color:#f92672">=&lt;/span> false
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># IDE0005: Remove unnecessary using directives&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet_diagnostic.IDE0005.severity &lt;span style="color:#f92672">=&lt;/span> warning
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># IDE0010: Add missing cases to switch statement &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet_diagnostic.IDE0010.severity &lt;span style="color:#f92672">=&lt;/span> warning
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Add blank line after using directive list&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet_diagnostic.rcs0003.severity &lt;span style="color:#f92672">=&lt;/span> error
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Place new line after/before &amp;#39;?:&amp;#39; operator&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet_diagnostic.rcs0028.severity &lt;span style="color:#f92672">=&lt;/span> error
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Track uses of &amp;#34;TODO&amp;#34; tags&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet_diagnostic.S1135.severity &lt;span style="color:#f92672">=&lt;/span> suggestion
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Son olarak bu pratiklerle aÅŸaÄŸÄ±daki gibi bir Ã¶neri alarak kodumuzun daha tutarlÄ± ve okunaklÄ± olmasÄ±nÄ± saÄŸlayabiliyoruz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>csharp_prefer_braces &lt;span style="color:#f92672">=&lt;/span> true:suggestion
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Good:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> (isActive)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> DoSomething();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Bad:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> (isActive)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> DoSomething();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>AyrÄ±ca GitHub&amp;rsquo;Ä±n bol yÄ±ldÄ±zlÄ± repolarÄ±nda &lt;a href="https://github.com/dotnet/roslyn/blob/main/.editorconfig">dotnet / roslyn&lt;/a> ve &lt;a href="https://github.com/christianhelle/refitter/blob/main/.editorconfig">christianhelle / refitter&lt;/a> gibi .editorconfig referanslarÄ± bulabilirsiniz.&lt;/p>
&lt;h2 id="pre-commit-hook-ile-sorunlarÄ±-lokalde-yakalayalÄ±m">pre-commit hook ile sorunlarÄ± lokalde yakalayalÄ±m&lt;/h2>
&lt;p>Pre-commit hookâ€™lar, Gitâ€™in her commitâ€™ten Ã¶nce Ã§alÄ±ÅŸtÄ±rdÄ±ÄŸÄ± scriptlerdir. Kod formatlama, linting veya testlerin Ã§alÄ±ÅŸtÄ±rÄ±lmasÄ± gibi kontroller iÃ§in oldukÃ§a uygundur, sorunlu kodlarÄ±n commitlenmesini engellerler. Testlerde hata alan bir kodu commitlemeyi engellemek kÄ±sa vadede sinir bozucu olsa da uzun vadede testleri canlÄ± tutmak adÄ±na Ã§ok Ã¶nemli. EÄŸer CI/CD pipelineâ€™Ä±nÄ±zda test adÄ±mÄ± varsa o adÄ±ma gelmeden Ã¶nce lokalde sorunlarÄ± gÃ¶rmemizi saÄŸlar.&lt;/p>
&lt;p>.NET projelerinde bu pre-commit hookâ€™larÄ±nÄ± register etmek iÃ§in ek paketlerden yardÄ±m alÄ±nabilir veya manuel sÃ¼reÃ§ler ile her developerâ€™Ä±n &lt;code>git config core.hooksPath ./.git-hooks&lt;/code> komudunu Ã§alÄ±ÅŸtÄ±rmasÄ± istenebilir. Biz burada projemizi ek bir pakete baÄŸÄ±mlÄ± hale getirmeden .NET platformunun bize saÄŸladÄ±ÄŸÄ± yeteneklerden faydalanacaÄŸÄ±z.&lt;/p>
&lt;p>&lt;code>.csproj&lt;/code> dosyanÄ±za aÅŸaÄŸÄ±daki gibi ekleyeceÄŸiniz basit bir MSBuild targetâ€™Ä± ile, her dotnet restore adÄ±mÄ±nda, dolayÄ±sÄ±ylada build adÄ±mÄ±nda Git hook dizininizin kurulmasÄ±nÄ± saÄŸlayabilirsiniz. BÃ¶ylece, projenizde Ã§alÄ±ÅŸan kim olursa olsun, projeyi build ettiÄŸi sÃ¼rece, ekstra adÄ±mlara gerek kalmadan pre-commit hook otomatik olarak yÃ¼klenecektir. AyrÄ±ca Production ortamÄ±nda bu adÄ±mÄ± atlÄ±yoruz, bÃ¶ylece CI/CD pipelineâ€™larÄ±nda ya da prod ortamlarda gereksiz kurulumlar yapÄ±lmÄ±yor.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-xml" data-lang="xml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;Target&lt;/span> &lt;span style="color:#a6e22e">Name=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;register git hooks&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">BeforeTargets=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;Restore;CollectPackageReferences&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">Condition=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&amp;#39;$(ASPNETCORE_ENVIRONMENT)&amp;#39; != &amp;#39;Production&amp;#39;&amp;#34;&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;Exec&lt;/span> &lt;span style="color:#a6e22e">Command=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;git config core.hooksPath ./.git-hooks&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">StandardOutputImportance=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;Low&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">StandardErrorImportance=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;High&amp;#34;&lt;/span> &lt;span style="color:#f92672">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;/Target&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Projenizin root dizininde &lt;code>.git-hooks&lt;/code> adlÄ± bir klasÃ¶r oluÅŸturun. Ä°Ã§ine &lt;code>pre-commit&lt;/code> isminde bir dosya oluÅŸturun:&lt;/p>
&lt;p>&lt;strong>&lt;code>./git-hooks/pre-commit&lt;/code>&lt;/strong>&lt;/p>
&lt;pre tabindex="0">&lt;code>#!/bin/sh
echo Running tests...
dotnet format
dotnet test
&lt;/code>&lt;/pre>&lt;p>DosyanÄ±zÄ± Ã§alÄ±ÅŸtÄ±rÄ±labilir yapmayÄ± unutmayÄ±n:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>chmod +x .git-hooks/pre-commit
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Bu akÄ±ÅŸ sayesinde testlerin hata aldÄ±ÄŸÄ± durumda commit atamayacaÄŸÄ±z&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ git commit -m &lt;span style="color:#e6db74">&amp;#39;failed commit&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Running tests...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Determining projects to restore...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> All projects are up-to-date &lt;span style="color:#66d9ef">for&lt;/span> restore.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Committer.API -&amp;gt; C:&lt;span style="color:#ae81ff">\P&lt;/span>rojects&lt;span style="color:#ae81ff">\P&lt;/span>ersonal&lt;span style="color:#ae81ff">\l&lt;/span>ecture-net-pre-commit&lt;span style="color:#ae81ff">\s&lt;/span>rc&lt;span style="color:#ae81ff">\C&lt;/span>ommitter.API&lt;span style="color:#ae81ff">\b&lt;/span>in&lt;span style="color:#ae81ff">\D&lt;/span>ebug&lt;span style="color:#ae81ff">\n&lt;/span>et9.0&lt;span style="color:#ae81ff">\C&lt;/span>ommitter.API.dll
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Committer.Tests -&amp;gt; C:&lt;span style="color:#ae81ff">\P&lt;/span>rojects&lt;span style="color:#ae81ff">\P&lt;/span>ersonal&lt;span style="color:#ae81ff">\l&lt;/span>ecture-net-pre-commit&lt;span style="color:#ae81ff">\t&lt;/span>ests&lt;span style="color:#ae81ff">\C&lt;/span>ommitter.Tests&lt;span style="color:#ae81ff">\b&lt;/span>in&lt;span style="color:#ae81ff">\D&lt;/span>ebug&lt;span style="color:#ae81ff">\n&lt;/span>et9.0&lt;span style="color:#ae81ff">\C&lt;/span>ommitter.Tests.dll
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Test run &lt;span style="color:#66d9ef">for&lt;/span> C:&lt;span style="color:#ae81ff">\P&lt;/span>rojects&lt;span style="color:#ae81ff">\P&lt;/span>ersonal&lt;span style="color:#ae81ff">\l&lt;/span>ecture-net-pre-commit&lt;span style="color:#ae81ff">\t&lt;/span>ests&lt;span style="color:#ae81ff">\C&lt;/span>ommitter.Tests&lt;span style="color:#ae81ff">\b&lt;/span>in&lt;span style="color:#ae81ff">\D&lt;/span>ebug&lt;span style="color:#ae81ff">\n&lt;/span>et9.0&lt;span style="color:#ae81ff">\C&lt;/span>ommitter.Tests.dll &lt;span style="color:#f92672">(&lt;/span>.NETCoreApp,Version&lt;span style="color:#f92672">=&lt;/span>v9.0&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>VSTest version 17.14.0 &lt;span style="color:#f92672">(&lt;/span>x64&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Starting test execution, please wait...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>A total of &lt;span style="color:#ae81ff">1&lt;/span> test files matched the specified pattern.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>xUnit.net 00:00:00.14&lt;span style="color:#f92672">]&lt;/span> Committer.Tests.Services.CalculatorServiceTests.Add_ShouldReturnCorrectSum&lt;span style="color:#f92672">(&lt;/span>a: 5, b: 3, expected: 7&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>FAIL&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Failed Committer.Tests.Services.CalculatorServiceTests.Add_ShouldReturnCorrectSum&lt;span style="color:#f92672">(&lt;/span>a: 5, b: 3, expected: 7&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span> ms&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Error Message:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Assert.Equal&lt;span style="color:#f92672">()&lt;/span> Failure: Values differ
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Expected: &lt;span style="color:#ae81ff">7&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Actual: &lt;span style="color:#ae81ff">8&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Stack Trace:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> at Committer.Tests.Services.CalculatorServiceTests.Add_ShouldReturnCorrectSum&lt;span style="color:#f92672">(&lt;/span>Double a, Double b, Double expected&lt;span style="color:#f92672">)&lt;/span> in C:&lt;span style="color:#ae81ff">\P&lt;/span>rojects&lt;span style="color:#ae81ff">\P&lt;/span>ersonal&lt;span style="color:#ae81ff">\l&lt;/span>ecture-net-pre-commit&lt;span style="color:#ae81ff">\t&lt;/span>ests&lt;span style="color:#ae81ff">\C&lt;/span>ommitter.Tests&lt;span style="color:#ae81ff">\S&lt;/span>ervices&lt;span style="color:#ae81ff">\C&lt;/span>alculatorServiceTests.cs:line &lt;span style="color:#ae81ff">25&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> at InvokeStub_CalculatorServiceTests.Add_ShouldReturnCorrectSum&lt;span style="color:#f92672">(&lt;/span>Object, Span&lt;span style="color:#e6db74">`&lt;/span>1&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs&lt;span style="color:#f92672">(&lt;/span>Object obj, BindingFlags invokeAttr, Binder binder, Object&lt;span style="color:#f92672">[]&lt;/span> parameters, CultureInfo culture&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Failed! - Failed: 1, Passed: 18, Skipped: 0, Total: 19, Duration: &lt;span style="color:#ae81ff">39&lt;/span> ms - Committer.Tests.dll &lt;span style="color:#f92672">(&lt;/span>net9.0&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ git log --oneline
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>9a89b16 &lt;span style="color:#f92672">(&lt;/span>HEAD -&amp;gt; main, origin/main&lt;span style="color:#f92672">)&lt;/span> test commit
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>10367df README.md added
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">0051724&lt;/span> Inital commit
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Testler baÅŸarÄ±lÄ± ise commit iÅŸlemi gerÃ§ekleÅŸecektir:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ git commit -m &lt;span style="color:#e6db74">&amp;#39;succeded commit&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Running tests...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Determining projects to restore...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> All projects are up-to-date &lt;span style="color:#66d9ef">for&lt;/span> restore.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Committer.API -&amp;gt; C:&lt;span style="color:#ae81ff">\P&lt;/span>rojects&lt;span style="color:#ae81ff">\P&lt;/span>ersonal&lt;span style="color:#ae81ff">\l&lt;/span>ecture-net-pre-commit&lt;span style="color:#ae81ff">\s&lt;/span>rc&lt;span style="color:#ae81ff">\C&lt;/span>ommitter.API&lt;span style="color:#ae81ff">\b&lt;/span>in&lt;span style="color:#ae81ff">\D&lt;/span>ebug&lt;span style="color:#ae81ff">\n&lt;/span>et9.0&lt;span style="color:#ae81ff">\C&lt;/span>ommitter.API.dll
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Committer.Tests -&amp;gt; C:&lt;span style="color:#ae81ff">\P&lt;/span>rojects&lt;span style="color:#ae81ff">\P&lt;/span>ersonal&lt;span style="color:#ae81ff">\l&lt;/span>ecture-net-pre-commit&lt;span style="color:#ae81ff">\t&lt;/span>ests&lt;span style="color:#ae81ff">\C&lt;/span>ommitter.Tests&lt;span style="color:#ae81ff">\b&lt;/span>in&lt;span style="color:#ae81ff">\D&lt;/span>ebug&lt;span style="color:#ae81ff">\n&lt;/span>et9.0&lt;span style="color:#ae81ff">\C&lt;/span>ommitter.Tests.dll
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Test run &lt;span style="color:#66d9ef">for&lt;/span> C:&lt;span style="color:#ae81ff">\P&lt;/span>rojects&lt;span style="color:#ae81ff">\P&lt;/span>ersonal&lt;span style="color:#ae81ff">\l&lt;/span>ecture-net-pre-commit&lt;span style="color:#ae81ff">\t&lt;/span>ests&lt;span style="color:#ae81ff">\C&lt;/span>ommitter.Tests&lt;span style="color:#ae81ff">\b&lt;/span>in&lt;span style="color:#ae81ff">\D&lt;/span>ebug&lt;span style="color:#ae81ff">\n&lt;/span>et9.0&lt;span style="color:#ae81ff">\C&lt;/span>ommitter.Tests.dll &lt;span style="color:#f92672">(&lt;/span>.NETCoreApp,Version&lt;span style="color:#f92672">=&lt;/span>v9.0&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>VSTest version 17.14.0 &lt;span style="color:#f92672">(&lt;/span>x64&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Starting test execution, please wait...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>A total of &lt;span style="color:#ae81ff">1&lt;/span> test files matched the specified pattern.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Passed! - Failed: 0, Passed: 19, Skipped: 0, Total: 19, Duration: &lt;span style="color:#ae81ff">31&lt;/span> ms - Committer.Tests.dll &lt;span style="color:#f92672">(&lt;/span>net9.0&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>main 0d9f3cf&lt;span style="color:#f92672">]&lt;/span> succeded commit
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">1&lt;/span> file changed, &lt;span style="color:#ae81ff">1&lt;/span> insertion&lt;span style="color:#f92672">(&lt;/span>+&lt;span style="color:#f92672">)&lt;/span>, &lt;span style="color:#ae81ff">1&lt;/span> deletion&lt;span style="color:#f92672">(&lt;/span>-&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ git log --oneline
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>0d9f3cf &lt;span style="color:#f92672">(&lt;/span>HEAD -&amp;gt; main&lt;span style="color:#f92672">)&lt;/span> succeded commit
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>9a89b16 &lt;span style="color:#f92672">(&lt;/span>origin/main&lt;span style="color:#f92672">)&lt;/span> test commit
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>10367df README.md added
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">0051724&lt;/span> Inital commit
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="Ã¶zet">Ã–zet&lt;/h2>
&lt;p>Ã–zetle, .NET projelerinde kod kalitesini geliÅŸtirici insiyatifinden Ã§Ä±karÄ±p, takÄ±m genelinde zorunlu hale getirmek iÃ§in uyguladÄ±ÄŸÄ±mÄ±z pratiklere gÃ¶z attÄ±k. &lt;code>TreatWarningsAsErrors&lt;/code>, .editorconfig kurallarÄ± ve geliÅŸmiÅŸ analyzer paketleriyle kodun hem okunabilirliÄŸini hem de gÃ¼venliÄŸini arttÄ±rdÄ±k. Pre-commit hookâ€™larÄ± sayesinde ise hatalÄ± veya testten geÃ§meyen kodun repoya girmesini baÅŸtan engelledik. Bu yaklaÅŸÄ±mlarla, takÄ±mda sÃ¼rdÃ¼rÃ¼lebilir ve yÃ¼ksek kaliteli bir yazÄ±lÄ±m geliÅŸtirme kÃ¼ltÃ¼rÃ¼ oturtmak mÃ¼mkÃ¼n oldu.&lt;/p>
&lt;p>Kaynak koduna eriÅŸmek isterseniz projenin tamamÄ±nÄ± GitHub hesabÄ±mda bulabilirsiniz:&lt;/p>
&lt;p>&lt;a href="https://github.com/berkslv/lecture-net-pre-commit">github.com/berkslv/lecture-net-pre-commit&lt;/a>&lt;/p>
&lt;h2 id="kapanÄ±ÅŸ">KapanÄ±ÅŸ&lt;/h2>
&lt;p>OkuduÄŸunuz iÃ§in teÅŸekkÃ¼rler! ðŸŽ‰ YazÄ±lÄ±m geliÅŸtirme alanÄ±ndaki araÅŸtÄ±rmalarÄ±mÄ± kaÃ§Ä±rmamak iÃ§in &lt;a href="https://x.com/berkslv">@berkslv&lt;/a> adresinden beni takip edebilirsiniz.&lt;/p></content></item><item><title>Feature Flagging in .NET with OpenFeature and flagd</title><link>https://berkselvi.dev/tr/posts/feature-flagging-in-dotnet-with-openfeature-and-flagd/</link><pubDate>Tue, 08 Jul 2025 00:00:00 +0300</pubDate><guid>https://berkselvi.dev/tr/posts/feature-flagging-in-dotnet-with-openfeature-and-flagd/</guid><description>&lt;p>Feature flagging (Ã¶zellik bayraklarÄ±), modern yazÄ±lÄ±m geliÅŸtirme pratiklerinin vazgeÃ§ilmezlerinden biri haline geldi. SÄ±k sÄ±k release alÄ±yorsanÄ±z, belirli kullanÄ±cÄ±larla Ã¶zellikleri test etmek istiyorsanÄ±z, daha gÃ¼venli sÃ¼rÃ¼mler arÄ±yorsanÄ±z, feature flagâ€™ler kesinlikle araÃ§ kutunuzda olmalÄ±. Bu yazÄ±da, vendor baÄŸÄ±msÄ±z bir feature flag standardÄ± olan OpenFeatureâ€™Ä± anlatacaÄŸÄ±m ve .NET projelerinde &lt;strong>flagd&lt;/strong> ile nasÄ±l entegre edilebileceÄŸini gÃ¶stereceÄŸim.&lt;/p>
&lt;h2 id="feature-flagging-nedir">Feature Flagging Nedir?&lt;/h2>
&lt;p>Feature flagâ€™ler (ya da diÄŸer adÄ±yla feature toggleâ€™lar), yeni bir kod release almadan uygulamanÄ±zdaki Ã¶zellikleri runtime sÄ±rasÄ±nda anlÄ±k olarak aÃ§Ä±p kapatmanÄ±zÄ± saÄŸlar. Hatta bir Ã¶zelliÄŸi kullanÄ±cÄ±, ortam veya istediÄŸiniz herhangi bir kritere gÃ¶re segmente edebilirsiniz. Bu sayede:&lt;/p></description><content>&lt;p>Feature flagging (Ã¶zellik bayraklarÄ±), modern yazÄ±lÄ±m geliÅŸtirme pratiklerinin vazgeÃ§ilmezlerinden biri haline geldi. SÄ±k sÄ±k release alÄ±yorsanÄ±z, belirli kullanÄ±cÄ±larla Ã¶zellikleri test etmek istiyorsanÄ±z, daha gÃ¼venli sÃ¼rÃ¼mler arÄ±yorsanÄ±z, feature flagâ€™ler kesinlikle araÃ§ kutunuzda olmalÄ±. Bu yazÄ±da, vendor baÄŸÄ±msÄ±z bir feature flag standardÄ± olan OpenFeatureâ€™Ä± anlatacaÄŸÄ±m ve .NET projelerinde &lt;strong>flagd&lt;/strong> ile nasÄ±l entegre edilebileceÄŸini gÃ¶stereceÄŸim.&lt;/p>
&lt;h2 id="feature-flagging-nedir">Feature Flagging Nedir?&lt;/h2>
&lt;p>Feature flagâ€™ler (ya da diÄŸer adÄ±yla feature toggleâ€™lar), yeni bir kod release almadan uygulamanÄ±zdaki Ã¶zellikleri runtime sÄ±rasÄ±nda anlÄ±k olarak aÃ§Ä±p kapatmanÄ±zÄ± saÄŸlar. Hatta bir Ã¶zelliÄŸi kullanÄ±cÄ±, ortam veya istediÄŸiniz herhangi bir kritere gÃ¶re segmente edebilirsiniz. Bu sayede:&lt;/p>
&lt;ul>
&lt;li>Kademeli yaygÄ±nlaÅŸtÄ±rma (progressive delivery)&lt;/li>
&lt;li>A/B testleri ve denemeler&lt;/li>
&lt;li>Problemli Ã¶zellikler iÃ§in anÄ±nda kill switch&lt;/li>
&lt;li>DaÄŸÄ±tÄ±m sÄ±rasÄ±nda daha dÃ¼ÅŸÃ¼k risk&lt;/li>
&lt;/ul>
&lt;p>Peki ya en Ã¶nemli faydasÄ± nedir? &lt;strong>Kontrol.&lt;/strong> ArtÄ±k yayÄ±na aldÄ±ÄŸÄ±nÄ±z kod, sadece ekibinize ya da kÃ¼Ã§Ã¼k bir beta grubuna gÃ¶rÃ¼nÃ¼r olabilir. Bir problem Ã§Ä±ktÄ±ÄŸÄ±nda ise, panikle rollback yapmak yerine, sadece flagâ€™i kapatÄ±rsÄ±nÄ±z.&lt;/p>
&lt;h2 id="eski-yÃ¶ntem-environment-variables">Eski YÃ¶ntem: Environment Variables&lt;/h2>
&lt;p>OpenFeature ve flagdâ€™dan Ã¶nce biraz gerÃ§ek dÃ¼nyada yaÅŸanan acÄ±lardan bahsetmek istiyorum. Pek Ã§ok ekip gibi, ben de baÅŸlangÄ±Ã§ta feature flag yÃ¶netimini &lt;strong>environment variable&lt;/strong> (veya &lt;code>appsettings.json&lt;/code>) Ã¼zerinden yaptÄ±m. Åžu yapÄ± eminim size de tanÄ±dÄ±k gelecektir:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;EnableNewDashboard&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Kodda da ÅŸÃ¶yle bir kontrol:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> (Configuration[&lt;span style="color:#e6db74">&amp;#34;EnableNewDashboard&amp;#34;&lt;/span>] == &lt;span style="color:#e6db74">&amp;#34;true&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// Yeni dashboardâ€™u gÃ¶ster&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Tabiki ilk baÅŸta iÅŸe yarÄ±yorâ€¦ ama bir sÃ¼re sonra sorunlar baÅŸlÄ±yor:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Hedefleme yok:&lt;/strong> Ya hep ya hiÃ§. Sadece iÃ§ kullanÄ±cÄ±lar iÃ§in mi aÃ§mak istiyorsunuz? MÃ¼mkÃ¼n deÄŸil.&lt;/li>
&lt;li>&lt;strong>AnlÄ±k deÄŸiÅŸiklik yok:&lt;/strong> DeÄŸiÅŸiklik iÃ§in Ã§oÄŸu zaman yeniden deploy veya restart gerekiyor.&lt;/li>
&lt;li>&lt;strong>Config karmaÅŸasÄ±:&lt;/strong> Zamanla onlarca flag, diÄŸer konfigÃ¼rasyonlarla karÄ±ÅŸÄ±yor.&lt;/li>
&lt;li>&lt;strong>Audit veya geÃ§miÅŸ yok:&lt;/strong> Kim ne zaman deÄŸiÅŸtirdi, iz yok.&lt;/li>
&lt;li>&lt;strong>Standart yok:&lt;/strong> Her ekip, her uygulama kendince yapÄ±yor.&lt;/li>
&lt;/ul>
&lt;p>Ekipler bÃ¼yÃ¼dÃ¼kÃ§e bu yaklaÅŸÄ±m kÄ±rÄ±lganlaÅŸÄ±yor. Progressive delivery, canary deployment veya A/B testleri iÃ§in dinamik kontrol ÅŸart. Ä°ÅŸte bu noktada feature flag platformlarÄ± ve OpenFeature gibi standartlar devreye giriyor.&lt;/p>
&lt;h2 id="neden-openfeature">Neden OpenFeature?&lt;/h2>
&lt;p>OpenFeature dÄ±ÅŸÄ±ndaki Ã§oÄŸu feature flag Ã§Ã¶zÃ¼mÃ¼ (LaunchDarkly, Unleash, vs.) sizi kendi SDKâ€™sÄ±na ve APIâ€™sine baÄŸÄ±mlÄ± kÄ±lar. OpenFeature burada devreye giriyor:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Vendor baÄŸÄ±msÄ±z:&lt;/strong> SaÄŸlayÄ±cÄ± deÄŸiÅŸtirmek iÃ§in kodunuzu yeniden yazmanÄ±z gerekmez.&lt;/li>
&lt;li>&lt;strong>Standart API:&lt;/strong> FarklÄ± dil ve platformlarda aynÄ± yaklaÅŸÄ±mÄ± kullanabilirsiniz.&lt;/li>
&lt;li>&lt;strong>GeniÅŸletilebilir:&lt;/strong> Loglama, telemetry gibi hookâ€™lar ekleyebilirsiniz.&lt;/li>
&lt;li>&lt;strong>Cloud-native uyumlu:&lt;/strong> Modern mimariler iÃ§in tasarlanmÄ±ÅŸtÄ±r.&lt;/li>
&lt;/ul>
&lt;p>OpenFeature ile uygulamanÄ±z sadece OpenFeature SDKâ€™ya baÄŸÄ±mlÄ± olur; belli bir saÄŸlayÄ±cÄ±ya deÄŸil. Zamanla farklÄ± bir saÄŸlayÄ±cÄ±ya geÃ§mek isterseniz, providerâ€™Ä± deÄŸiÅŸtirmeniz yeterli olacaktÄ±r.&lt;/p>
&lt;h2 id="neden-flagd">Neden flagd?&lt;/h2>
&lt;p>&lt;a href="https://github.com/open-feature/flagd">flagd&lt;/a>, aÃ§Ä±k kaynak ve hafif bir feature flag backendâ€™idir. OpenFeature ile doÄŸrudan Ã§alÄ±ÅŸmak iÃ§in tasarlanmÄ±ÅŸtÄ±r ve flagâ€™leri JSON dosyalarÄ±ndan, HTTP endpoint veya gRPC Ã¼zerinden yÃ¶netilebilir. Fakat ne yazÄ±k ki ÅŸu anda flagâ€™leri yÃ¶netmek iÃ§in official bir kullanÄ±cÄ± arayÃ¼zÃ¼ (UI) bulunmuyor, bunun yerine GitOps pratikleri ile yÃ¶netim saÄŸlanÄ±yor. flagd, hiÃ§bir vendor-lockin yaÅŸamadan, self host edebileceÄŸiniz, bulut tabanlÄ± bir feature flag backendi istiyorsanÄ±z idealdir.&lt;/p>
&lt;h2 id="gerÃ§ek-hayattan-Ã¶rnek-envden-feature-flage">GerÃ§ek Hayattan Ã–rnek: ENVâ€™den Feature Flagâ€™e&lt;/h2>
&lt;p>GerÃ§ek hayattan bir Ã¶rnekle, bir .NET web APIâ€™niz var diyelim. Yeni bir Ã¶zelliÄŸi yayÄ±na alÄ±yorsunuz; ama Ã¶nce sadece iÃ§ kullanÄ±cÄ±larÄ±nÄ±za aÃ§mak istiyorsunuz. Bir environment variable tanÄ±mlayÄ±p, bunu &lt;code>isInternalUser&lt;/code> gibi bir deÄŸiÅŸkene baÄŸlayarak feature flag pratiklerini kÄ±smen uygulayabilirsiniz. Ancak bu deÄŸiÅŸkende her deÄŸiÅŸiklikte kodu tekrar deploy etmeniz gerekiyor ve belirli bir kullanÄ±cÄ± grubu iÃ§in deÄŸil, servisi kullanan tÃ¼m kullanÄ±cÄ±lar iÃ§in bu iÅŸlemi yapabiliyorsunuz.&lt;/p>
&lt;p>Enviroment variable ile yÃ¶netilen bir feature flag ortamÄ±nda Product Manager, bir Ã¶zelliÄŸi kullanÄ±cÄ±larÄ±n %10â€™u ile A/B test yapmak istiyorsa Ã¶zel kod ve yeniden deploy gerekecektir.&lt;/p>
&lt;p>&lt;strong>Feature flagâ€™ler&lt;/strong> bu tabloyu deÄŸiÅŸtiriyor:&lt;/p>
&lt;ul>
&lt;li>Ã–zelliÄŸi anÄ±nda, spesifik kullanÄ±cÄ±/gruplar iÃ§in aÃ§Ä±p kapatÄ±n.&lt;/li>
&lt;li>Herkese aÃ§maya hazÄ±r olduÄŸunuzda deploy gerekmeden canlÄ±ya Ã§Ä±kÄ±n.&lt;/li>
&lt;li>Sorun Ã§Ä±karsa, tek tuÅŸla anÄ±nda kapatÄ±n.&lt;/li>
&lt;/ul>
&lt;p>Modern Ã¼rÃ¼n ekipleri bu sayede daha hÄ±zlÄ± iterasyon yapabiliyor, riski azaltÄ±yor ve sÃ¼rekli deÄŸer sunabiliyor.&lt;/p>
&lt;h2 id="nette-openfeature-ve-flagd-entegrasyonu">.NETâ€™te OpenFeature ve flagd Entegrasyonu&lt;/h2>
&lt;p>Åžimdi kurulumun nasÄ±l yapÄ±lacaÄŸÄ±na bakalÄ±m.&lt;/p>
&lt;h3 id="1-nuget-paketlerini-ekleyin">1. NuGet Paketlerini Ekleyin&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet add package OpenFeature
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet add package OpenFeature.Contrib.Providers.Flagd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="2-flagdi-docker-compose-ile-Ã§alÄ±ÅŸtÄ±rÄ±n">2. flagdâ€™i docker-compose ile Ã§alÄ±ÅŸtÄ±rÄ±n&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">services&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">flagd&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">image&lt;/span>: &lt;span style="color:#ae81ff">ghcr.io/open-feature/flagd:latest&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./flags:/etc/flagd&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">command&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;start&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;--uri&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;file:/etc/flagd/flags.json&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;--debug&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ports&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#39;8013:8013&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ã–rnek &lt;code>flags.json&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;$schema&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;https://flagd.dev/schema/v0/flags.json&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;flags&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;new-greeting&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;state&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;ENABLED&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;variants&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;on&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;off&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;defaultVariant&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;off&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;targeting&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;if&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;$ref&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;userAgentIsFirefox&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;on&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">null&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;$evaluators&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;userAgentIsFirefox&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;in&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;firefox&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;var&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;userAgent&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="3-net-uygulamanÄ±zda-openfeatureÄ±-konfigÃ¼re-edin">3. .NET UygulamanÄ±zda OpenFeatureâ€™Ä± KonfigÃ¼re Edin&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">using&lt;/span> OpenFeature.Contrib.Providers.Flagd;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">using&lt;/span> OpenFeature.Model;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> builder = WebApplication.CreateBuilder(args);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">await&lt;/span> OpenFeature.Api.Instance.SetProviderAsync(&lt;span style="color:#66d9ef">new&lt;/span> FlagdProvider(&lt;span style="color:#66d9ef">new&lt;/span> Uri(&lt;span style="color:#e6db74">&amp;#34;http://localhost:8013&amp;#34;&lt;/span>)));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> app = builder.Build();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.MapGet(&lt;span style="color:#e6db74">&amp;#34;/greet&amp;#34;&lt;/span>, &lt;span style="color:#66d9ef">async&lt;/span> context =&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> client = OpenFeature.Api.Instance.GetClient();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// Get User-Agent header&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> userAgent = context.Request.Headers[&lt;span style="color:#e6db74">&amp;#34;User-Agent&amp;#34;&lt;/span>].FirstOrDefault() ?? &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> evalContext = EvaluationContext.Builder().Set(&lt;span style="color:#e6db74">&amp;#34;userAgent&amp;#34;&lt;/span>, userAgent).Build();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> useNewGreeting = &lt;span style="color:#66d9ef">await&lt;/span> client.GetBooleanValueAsync(&lt;span style="color:#e6db74">&amp;#34;new-greeting&amp;#34;&lt;/span>, &lt;span style="color:#66d9ef">false&lt;/span>, evalContext);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">string&lt;/span> greeting = useNewGreeting
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ? &lt;span style="color:#e6db74">&amp;#34;Hey there! Welcome to the new greeting experience! ðŸŽ‰&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> : &lt;span style="color:#e6db74">&amp;#34;Hello, World!&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">await&lt;/span> context.Response.WriteAsync(greeting);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>});
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.Run();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="4-test-edin">4. Test Edin&lt;/h3>
&lt;p>&lt;code>flags.json&lt;/code> dosyanÄ±zdan flagâ€™i deÄŸiÅŸtirin. .NET uygulamanÄ±z deÄŸiÅŸikliÄŸi anÄ±nda yakalayacaktÄ±r. API ucunu test ettiÄŸimizde aÅŸaÄŸÄ±daki gibi bir sonuÃ§la karÅŸÄ±laÅŸÄ±rÄ±z.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ curl http://localhost:5050/greet
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Hello, World!
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ curl http://localhost:5050/greet -H &lt;span style="color:#e6db74">&amp;#39;User-Agent: firefox&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Hey there! Welcome to the new greeting experience! ðŸŽ‰
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>EÄŸer flagd backendine direk olarak istek atÄ±p flagin durumunu gÃ¶rmek istersek ise aÅŸaÄŸÄ±daki ÅŸekilde sorgulama yapabiliriz&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ curl -X POST &lt;span style="color:#e6db74">&amp;#34;http://localhost:8013/flagd.evaluation.v1.Service/ResolveBoolean&amp;#34;&lt;/span> -d &lt;span style="color:#e6db74">&amp;#39;{&amp;#34;flagKey&amp;#34;:&amp;#34;new-greeting&amp;#34;,&amp;#34;context&amp;#34;:{}}&amp;#39;&lt;/span> -H &lt;span style="color:#e6db74">&amp;#34;Content-Type: application/json&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;value&amp;#34;&lt;/span>:false, &lt;span style="color:#e6db74">&amp;#34;reason&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;DEFAULT&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;variant&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;off&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;metadata&amp;#34;&lt;/span>:&lt;span style="color:#f92672">{}}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ curl -X POST &lt;span style="color:#e6db74">&amp;#34;http://localhost:8013/flagd.evaluation.v1.Service/ResolveBoolean&amp;#34;&lt;/span> -d &lt;span style="color:#e6db74">&amp;#39;{&amp;#34;flagKey&amp;#34;:&amp;#34;new-greeting&amp;#34;,&amp;#34;context&amp;#34;:{&amp;#34;userAgent&amp;#34;: &amp;#34;firefox&amp;#34;}}&amp;#39;&lt;/span> -H &lt;span style="color:#e6db74">&amp;#34;Content-Type: application/json&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;value&amp;#34;&lt;/span>:true, &lt;span style="color:#e6db74">&amp;#34;reason&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;TARGETING_MATCH&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;variant&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;on&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;metadata&amp;#34;&lt;/span>:&lt;span style="color:#f92672">{}}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="Ã¶zet">Ã–zet&lt;/h2>
&lt;p>Feature flagâ€™ler riski azaltÄ±r, daha hÄ±zlÄ± daÄŸÄ±tÄ±m saÄŸlar ve kullanÄ±cÄ± hedeflemesini kolaylaÅŸtÄ±rÄ±r. OpenFeature, .NETâ€™te feature flag yÃ¶netimi iÃ§in size standart ve geleceÄŸe dÃ¶nÃ¼k bir API sunar. flagd ise kendi kendinize barÄ±ndÄ±rabileceÄŸiniz, Kubernetes ile uyumlu aÃ§Ä±k kaynak bir backendâ€™dir.&lt;/p>
&lt;p>HÃ¢lÃ¢ environment variable ya da config dosyalarÄ± ile Ã¶zellik yÃ¶netimi yapÄ±yorsanÄ±z, OpenFeature ve flagdâ€™ye bir ÅŸans verin. Gelecekte kendinize teÅŸekkÃ¼r edeceksiniz, Ã¶zellikle bir cuma akÅŸamÄ± bir Ã¶zelliÄŸi acil kapatmanÄ±z gerekirse.&lt;/p>
&lt;p>Kaynak koduna eriÅŸmek isterseniz projenin tamamÄ±nÄ± GitHub hesabÄ±mda bulabilirsiniz:&lt;/p>
&lt;p>&lt;a href="https://github.com/berkslv/lecture-net-openfeature">https://github.com/berkslv/lecture-net-pre-commit&lt;/a>&lt;/p>
&lt;h2 id="sonuÃ§">SonuÃ§&lt;/h2>
&lt;p>OkuduÄŸunuz iÃ§in teÅŸekkÃ¼rler! ðŸŽ‰ YazÄ±lÄ±m geliÅŸtirme alanÄ±ndaki araÅŸtÄ±rmalarÄ±mÄ± kaÃ§Ä±rmamak iÃ§in &lt;a href="https://x.com/berkslv">@berkslv&lt;/a> adresinden beni takip edebilirsiniz.&lt;/p></content></item><item><title>SignalR ile GerÃ§ek ZamanlÄ± Ä°letiÅŸim: Derinlemesine Ä°nceleme</title><link>https://berkselvi.dev/tr/posts/realtime-communication-with-signalr-a-deep-dive/</link><pubDate>Fri, 29 Nov 2024 00:00:00 +0300</pubDate><guid>https://berkselvi.dev/tr/posts/realtime-communication-with-signalr-a-deep-dive/</guid><description>&lt;p>GÃ¼nÃ¼mÃ¼z dÃ¼nyasÄ±nda verilerin hÄ±zla hareket ettiÄŸi bir ortamda, modern uygulamalarÄ±n kullanÄ±cÄ±larÄ±na sorunsuz deneyimler sunabilmesi iÃ§in gerÃ§ek zamanlÄ± iletiÅŸim bir zorunluluk haline gelmiÅŸtir. SignalR, .NET uygulamalarÄ± iÃ§in gerÃ§ek zamanlÄ± iletiÅŸim Ã¶zelliklerini kolayca hayata geÃ§irmenize yardÄ±mcÄ± olan temel bir kÃ¼tÃ¼phanedir. SignalR kullanÄ±rken tÃ¼m iletiÅŸim ve network gereksinimleri kÃ¼tÃ¼phane tarafÄ±ndan soyutlanÄ±r; sadece bir RPC Ã§aÄŸrÄ±sÄ± yapar gibi yÃ¶ntem Ã§aÄŸrÄ±sÄ±nda bulunmanÄ±z yeterlidir. SignalR sayesinde canlÄ± panolar, sohbet uygulamalarÄ± veya web uygulamalarÄ±nda sÄ±kÃ§a ihtiyaÃ§ duyulan basit bildirim Ã¶zelliklerini kolayca oluÅŸturabilirsiniz. Haydi baÅŸlayalÄ±m.&lt;/p></description><content>&lt;p>GÃ¼nÃ¼mÃ¼z dÃ¼nyasÄ±nda verilerin hÄ±zla hareket ettiÄŸi bir ortamda, modern uygulamalarÄ±n kullanÄ±cÄ±larÄ±na sorunsuz deneyimler sunabilmesi iÃ§in gerÃ§ek zamanlÄ± iletiÅŸim bir zorunluluk haline gelmiÅŸtir. SignalR, .NET uygulamalarÄ± iÃ§in gerÃ§ek zamanlÄ± iletiÅŸim Ã¶zelliklerini kolayca hayata geÃ§irmenize yardÄ±mcÄ± olan temel bir kÃ¼tÃ¼phanedir. SignalR kullanÄ±rken tÃ¼m iletiÅŸim ve network gereksinimleri kÃ¼tÃ¼phane tarafÄ±ndan soyutlanÄ±r; sadece bir RPC Ã§aÄŸrÄ±sÄ± yapar gibi yÃ¶ntem Ã§aÄŸrÄ±sÄ±nda bulunmanÄ±z yeterlidir. SignalR sayesinde canlÄ± panolar, sohbet uygulamalarÄ± veya web uygulamalarÄ±nda sÄ±kÃ§a ihtiyaÃ§ duyulan basit bildirim Ã¶zelliklerini kolayca oluÅŸturabilirsiniz. Haydi baÅŸlayalÄ±m.&lt;/p>
&lt;h2 id="neden-signalr">Neden SignalR?&lt;/h2>
&lt;p>Geleneksel istemci-sunucu iletiÅŸim modelleri, yÃ¼ksek etkileÅŸim ihtiyaÃ§larÄ± iÃ§in daha az verimli ve sÄ±nÄ±rlÄ± olan istek-cevap modeline dayanÄ±r ve veriye ihtiyaÃ§ duyulduÄŸunda istemcinin bir istek gÃ¶ndermesini gerektirir. SignalR, istemci ile sunucu arasÄ±ndaki aynÄ± baÄŸlantÄ±yÄ± sÃ¼rekli aÃ§Ä±k tutarak bu zorluklarÄ± ortadan kaldÄ±rmak iÃ§in tasarlanmÄ±ÅŸtÄ±r.&lt;/p>
&lt;h3 id="signalrÄ±n-temel-avantajlarÄ±">SignalRâ€™Ä±n Temel AvantajlarÄ±:&lt;/h3>
&lt;ul>
&lt;li>&lt;strong>GerÃ§ek ZamanlÄ± Ä°letiÅŸim:&lt;/strong> Ä°stemciler, yeni bir istek gÃ¶ndermeye gerek kalmadan anÄ±nda gÃ¼ncellemeleri alÄ±r.&lt;/li>
&lt;li>&lt;strong>Ã‡apraz Platform DesteÄŸi:&lt;/strong> SignalR, platform ve tarayÄ±cÄ±dan baÄŸÄ±msÄ±zdÄ±r.&lt;/li>
&lt;li>&lt;strong>KarmaÅŸÄ±k Protokollerin SoyutlanmasÄ±:&lt;/strong> SignalR, WebSocket, Server-Sent Events ve Long Polling protokollerini kullanma yeteneÄŸine sahiptir. Bu, istemci ve sunucu arasÄ±nda daha verimli bir iliÅŸki saÄŸlar ve en uygun protokolÃ¼n seÃ§ilmesine olanak tanÄ±r. WebSocket protokolÃ¼ istemci tarafÄ±ndan desteklenmiyorsa, SignalR kendi iÃ§ algoritmasÄ±na gÃ¶re diÄŸer yÃ¶ntemleri seÃ§erek kullanÄ±r.&lt;/li>
&lt;li>&lt;strong>.NET UygulamalarÄ± ile Entegrasyon:&lt;/strong> .NET ile baÅŸarÄ±lÄ± bir ÅŸekilde entegre olarak modern .NET uygulamalarÄ±nda sorunsuz bir kullanÄ±m saÄŸlar.&lt;/li>
&lt;/ul>
&lt;h3 id="signalr-ile-baÅŸlangÄ±Ã§">SignalR ile BaÅŸlangÄ±Ã§&lt;/h3>
&lt;p>.NET projenize SignalRâ€™Ä± entegre etmek iÃ§in aÅŸaÄŸÄ±daki adÄ±mlarÄ± takip edebilirsiniz:&lt;/p>
&lt;h3 id="1-signalr-nuget-paketi">1. SignalR NuGet Paketi&lt;/h3>
&lt;p>SignalR, .NET sistem kÃ¼tÃ¼phaneleriyle birlikte gelir, bu nedenle ek bir paket yÃ¼klemenize gerek yoktur. Ancak Visual Studio saÃ§malamaya baÅŸlarsa &lt;code>Microsoft.AspNetCore.SignalR&lt;/code> paketini yÃ¼klemeyi deneyebilirsiniz.&lt;/p>
&lt;h3 id="2-hub-sÄ±nÄ±fÄ±-oluÅŸturma">2. Hub SÄ±nÄ±fÄ± OluÅŸturma&lt;/h3>
&lt;p>Hub, baÄŸlantÄ±larÄ± yÃ¶neten ve istemcilere mesaj gÃ¶nderen merkezi bir bileÅŸen gÃ¶revi gÃ¶rÃ¼r. Bu sÄ±nÄ±fÄ±, HTTP isteklerini kabul ettiÄŸiniz Controller&amp;rsquo;lara benzetebilirsiniz, ancak burada istemciden gelen istekleri kabul edebilir veya istemciye doÄŸrudan istek gÃ¶nderebilirsiniz. Basit bir Ã¶rnek:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">using&lt;/span> Microsoft.AspNetCore.SignalR;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">NotificationsHub&lt;/span> : Hub
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> Task SendNotification(&lt;span style="color:#66d9ef">string&lt;/span> content)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">await&lt;/span> Clients.All.SendAsync(&lt;span style="color:#e6db74">&amp;#34;ReceiveNotification&amp;#34;&lt;/span>, content);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="3-programcs-dosyasÄ±nda-hubÄ±-yapÄ±landÄ±rma">3. Program.cs DosyasÄ±nda Hubâ€™Ä± YapÄ±landÄ±rma&lt;/h3>
&lt;p>SignalR servislerini kaydedin ve hub uÃ§ noktasÄ±nÄ± ÅŸu ÅŸekilde eÅŸleyin:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> builder = WebApplication.CreateBuilder(args);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">//...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.Services.AddSignalR();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> app = builder.Build();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">//...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.MapHub&amp;lt;NotificationsHub&amp;gt;(&lt;span style="color:#e6db74">&amp;#34;hubs/notification&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.Run();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="4-signalr-istemcisi">4. SignalR Ä°stemcisi&lt;/h3>
&lt;p>SignalR, Javascript, .NET ve Java gibi Ã§eÅŸitli istemci platformlarÄ±nÄ± destekler. EÄŸer bu platformlarda SignalR kÃ¼tÃ¼phanesini uygulamak istemiyorsanÄ±z, uÃ§ noktanÄ±zÄ± test etmek iÃ§in basitÃ§e Postman kullanabilirsiniz. Ancak JSON sonuna 0x1E karakterini eklemeniz gerekir. SignalRâ€™Ä±n dahili protokol gerekliliÄŸi budur. Javascript kÃ¼tÃ¼phanesi kullanÄ±yorsanÄ±z bu detayla uÄŸraÅŸmanÄ±za gerek yoktur.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;protocol&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;json&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;version&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>SignalR Hubâ€™a mesaj gÃ¶ndermek ve almak iÃ§in ÅŸu ÅŸekilde bir JSON kullanabilirsiniz:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;arguments&amp;#34;&lt;/span> : [&lt;span style="color:#e6db74">&amp;#34;hello world&amp;#34;&lt;/span>],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;target&amp;#34;&lt;/span> : &lt;span style="color:#e6db74">&amp;#34;SendNotification&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;type&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>KÄ±sa bir Postman ve SignalR demosu:&lt;/p>
&lt;img src="https://berkselvi.dev/img/realtime-communication-with-signalr-a-deep-dive/postman-signalr-demo.gif" alt="SignalR ve Postman demo" loading="lazy" />
&lt;p class="image-sub-title">SignalR ve Postman demo&lt;/p>
&lt;h2 id="geliÅŸmiÅŸ-Ã¶zellikler">GeliÅŸmiÅŸ Ã–zellikler&lt;/h2>
&lt;h3 id="1-tip-gÃ¼venli-hublar">1. Tip GÃ¼venli Hubâ€™lar&lt;/h3>
&lt;p>BakÄ±mÄ± daha kolay hale getirmek iÃ§in hub arayÃ¼zÃ¼nÃ¼ belirterek tip gÃ¼venli hubâ€™lar kullanabilirsiniz:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">interface&lt;/span> &lt;span style="color:#a6e22e">INotificationsClient&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Task ReceiveNotification(&lt;span style="color:#66d9ef">string&lt;/span> content);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">NotificationsHub&lt;/span> : Hub&amp;lt;INotificationsClient&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> Task SendNotification(&lt;span style="color:#66d9ef">string&lt;/span> content)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">await&lt;/span> Clients.All.ReceiveNotification(content);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="2-belirli-istemcilere-mesaj-gÃ¶nderme">2. Belirli Ä°stemcilere Mesaj GÃ¶nderme&lt;/h3>
&lt;p>SignalR, belirli kullanÄ±cÄ±lar veya gruplara mesaj gÃ¶nderme yeteneÄŸine sahiptir. KullanÄ±cÄ±yÄ± bir grup adÄ±na ekledikten sonra yalnÄ±zca ilgili kullanÄ±cÄ±ya bildirim gÃ¶nderebilirsiniz:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">await&lt;/span> Clients.User(userId).ReceiveNotification(&lt;span style="color:#e6db74">&amp;#34;Hello, User!&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">await&lt;/span> Clients.Group(groupName).ReceiveNotification(&lt;span style="color:#e6db74">&amp;#34;Hello, Group!&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>KullanÄ±cÄ± kimliÄŸi (userId) ile hedefleme yapmak iÃ§in IUserIdProvider uygulamanÄ±z gerekir:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">UserIdProvider&lt;/span> : IUserIdProvider
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span> GetUserId(HubConnectionContext connection)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> connection.User?.FindFirst(ClaimTypes.NameIdentifier)?.Value;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Program.cs&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>services.AddSingleton&amp;lt;IUserIdProvider, CustomUserIdProvider&amp;gt;();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="3-hub-dÄ±ÅŸÄ±ndan-ihubcontext-kullanÄ±mÄ±">3. Hub DÄ±ÅŸÄ±ndan IHubContext KullanÄ±mÄ±&lt;/h3>
&lt;p>Hub dÄ±ÅŸÄ±nda istemcilere mesaj gÃ¶ndermek iÃ§in aÅŸaÄŸÄ±daki ÅŸekilde bir yaklaÅŸÄ±m izleyebilirsiniz. IHubContext tÃ¼rÃ¼nÃ¼ enjekte edin ve mesajÄ±nÄ±zÄ± istemcilere gÃ¶nderin.&lt;/p>
&lt;p>Sisteminizde bir olay gerÃ§ekleÅŸtiÄŸinde bu Ã¶zelliÄŸi kullanarak hub&amp;rsquo;Ä± tetikleyebilirsiniz. Ã–rneÄŸin, uzun sÃ¼ren bir toplu iÅŸlem tamamlandÄ±ÄŸÄ±nda kullanÄ±cÄ±larÄ±nÄ±za sonuÃ§ hakkÄ±nda bildirim gÃ¶nderebilirsiniz.&lt;/p>
&lt;p>KÄ±sa bir not: Kodunuzu daha temiz hale getirmek iÃ§in bu IHubContext arayÃ¼zÃ¼nÃ¼, Ã¶rneÄŸin &lt;code>INotificationDispatcher&lt;/code> gibi baÅŸka bir arayÃ¼zle soyutlamanÄ±z iyi bir fikir olabilir.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">NotificationDispatcher&lt;/span>(IHubContext&amp;lt;NotificationsHub&amp;gt; hubContext) : INotificationDispatcher
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> Task SendNotification(&lt;span style="color:#66d9ef">string&lt;/span> content)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">await&lt;/span> hubContext.Clients.All.SendAsync(&lt;span style="color:#e6db74">&amp;#34;ReceiveNotification&amp;#34;&lt;/span>, content);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> Task SendNotificationToUser(&lt;span style="color:#66d9ef">string&lt;/span> userId, &lt;span style="color:#66d9ef">string&lt;/span> content)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">await&lt;/span> hubContext.Clients.User(userId).SendAsync(&lt;span style="color:#e6db74">&amp;#34;ReceiveNotification&amp;#34;&lt;/span>, content);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> Task SendNotificationToGroup(&lt;span style="color:#66d9ef">string&lt;/span> groupName, &lt;span style="color:#66d9ef">string&lt;/span> content)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">await&lt;/span> hubContext.Clients.Group(groupName).SendAsync(&lt;span style="color:#e6db74">&amp;#34;ReceiveNotification&amp;#34;&lt;/span>, content);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="4">
&lt;li>SignalR GÃ¼venliÄŸini SaÄŸlama&lt;/li>
&lt;/ol>
&lt;p>SignalR hubâ€™larÄ±nÄ± [Authorize] Ã¶zniteliÄŸi ile gÃ¼vence altÄ±na alabilirsiniz:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">[Authorize]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">NotificationsHub&lt;/span> : Hub
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// Hub methods&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="5">
&lt;li>Redis Backplane ile SignalR Ã–lÃ§ekleme&lt;/li>
&lt;/ol>
&lt;p>SignalRâ€™Ä± birden fazla sunucuya Ã¶lÃ§eklendirmek, birden Ã§ok instance Ã¼zerinde Ã§alÄ±ÅŸan yÃ¼ksek talep gÃ¶ren uygulamalar iÃ§in gÃ¼venilir gerÃ§ek zamanlÄ± iletiÅŸim saÄŸlar. Redis backplane, SignalR sunucularÄ± arasÄ±ndaki mesajlarÄ± senkronize ederek, farklÄ± sunuculara baÄŸlÄ± istemcilerin sorunsuz bir ÅŸekilde mesaj almasÄ±nÄ± saÄŸlar. Ä°ÅŸte Microsoft belgelerinden bir alÄ±ntÄ±:&lt;/p>
&lt;blockquote>
&lt;p>SignalR Redis backplane, mesajlarÄ± diÄŸer sunuculara iletmek iÃ§in pub/sub Ã¶zelliÄŸini kullanÄ±r. Bir istemci baÄŸlantÄ± kurduÄŸunda, baÄŸlantÄ± bilgileri backplaneâ€™e iletilir. Bir sunucu tÃ¼m istemcilere mesaj gÃ¶ndermek istediÄŸinde, bunu backplaneâ€™e iletir. Backplane, tÃ¼m baÄŸlÄ± istemcileri ve hangi sunucularda olduklarÄ±nÄ± bilir. MesajÄ± ilgili sunucular aracÄ±lÄ±ÄŸÄ±yla tÃ¼m istemcilere gÃ¶nderir.&lt;/p>&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet add package Microsoft.AspNetCore.SignalR.StackExchangeRedis
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Program.cs&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.Services.AddSignalR()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .AddStackExchangeRedis(&lt;span style="color:#e6db74">&amp;#34;localhost:6379&amp;#34;&lt;/span>, options =&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> options.Configuration.ChannelPrefix = &lt;span style="color:#e6db74">&amp;#34;SignalR&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>EÄŸer bana inanmÄ±yorsanÄ±z, SignalR uygulamanÄ±zÄ± yerel test ortamÄ±nda birden fazla instance ile Ã§alÄ±ÅŸtÄ±rmayÄ± Docker Compose kullanarak deneyebilirsiniz:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">services&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">signalr&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">image&lt;/span>: &lt;span style="color:#ae81ff">your-app&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ports&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;5000:5000&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">depends_on&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">redis&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">redis&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">image&lt;/span>: &lt;span style="color:#ae81ff">redis:latest&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ports&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;6379:6379&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker-compose up --scale signalr&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="signalr-iletiÅŸim-modelleri">SignalR Ä°letiÅŸim Modelleri&lt;/h2>
&lt;p>SignalR, uyumluluk ve performansÄ± saÄŸlamak iÃ§in birden fazla taÅŸÄ±ma yÃ¶ntemini soyutlar:&lt;/p>
&lt;h3 id="websocket-websockets">&lt;strong>WebSocket (&lt;/strong>&lt;code>webSockets&lt;/code>&lt;strong>)&lt;/strong>:&lt;/h3>
&lt;p>WebSockets, SignalR iÃ§in en verimli ve tercih edilen gerÃ§ek zamanlÄ±, Ã§ift yÃ¶nlÃ¼ iletiÅŸim yÃ¶ntemidir. Tek bir TCP kanalÄ± Ã¼zerinden kalÄ±cÄ±, tam Ã§ift yÃ¶nlÃ¼ bir baÄŸlantÄ± kurarak istemci ve sunucu arasÄ±nda eÅŸzamanlÄ± mesaj alÄ±ÅŸveriÅŸine olanak tanÄ±r. Bu, canlÄ± sohbetler, ortak dÃ¼zenleme araÃ§larÄ±, Ã§evrimiÃ§i oyunlar ve finansal veri akÄ±ÅŸlarÄ± gibi dÃ¼ÅŸÃ¼k gecikme ve yÃ¼ksek hÄ±z gerektiren uygulamalar iÃ§in idealdir.&lt;/p>
&lt;p>WebSockets, ilk HTTP el sÄ±kÄ±ÅŸmasÄ±nÄ±n ardÄ±ndan kendi hafif protokolÃ¼ne (&lt;code>ws://&lt;/code> veya &lt;code>wss://&lt;/code>) geÃ§erek geleneksel HTTP tabanlÄ± iletiÅŸimin getirdiÄŸi yÃ¼kÃ¼ azaltÄ±r. Ancak, WebSockets&amp;rsquo;in Ã¶lÃ§eklendirilmesi, WebSocket uyumlu yÃ¼k dengeleyiciler ve yapÄ±ÅŸkan oturumlar gibi Ã¶zel altyapÄ±lar gerektirir. SignalR, baÄŸlantÄ± sÃ¼rekliliÄŸini, otomatik yeniden baÄŸlantÄ±larÄ± ve WebSockets kullanÄ±lamadÄ±ÄŸÄ±nda alternatif protokollere geÃ§iÅŸi yÃ¶neterek bu zorluklarÄ± basitleÅŸtirir.&lt;/p>
&lt;h3 id="server-sent-events-serversentevents">&lt;strong>Server-Sent Events (&lt;/strong>&lt;code>serverSentEvents&lt;/code>&lt;strong>):&lt;/strong>&lt;/h3>
&lt;p>SSE (Server-Sent Events), uzun Ã¶mÃ¼rlÃ¼ bir baÄŸlantÄ± Ã¼zerinden sunucudan istemciye gerÃ§ek zamanlÄ± gÃ¼ncellemeler saÄŸlayan hafif bir HTTP tabanlÄ± mekanizmadÄ±r. StandartlaÅŸtÄ±rÄ±lmÄ±ÅŸ EventSource API&amp;rsquo;sini kullanÄ±r ve verileri &lt;code>text/event-stream&lt;/code> formatÄ±nda iletir. Bu, canlÄ± panolar, bildirimler ve haber akÄ±ÅŸlarÄ± gibi yalnÄ±zca sunucudan istemciye veri aktarÄ±mÄ± gerektiren durumlar iÃ§in basit ve etkilidir.&lt;/p>
&lt;p>SSE, standart HTTP Ã¼zerinde Ã§alÄ±ÅŸtÄ±ÄŸÄ± iÃ§in mevcut HTTP altyapÄ±sÄ± ile kolayca entegre olur ve WebSockets&amp;rsquo;e kÄ±yasla daha kolay Ã¶lÃ§eklenebilir. Ancak, SSE Internet Explorer tarafÄ±ndan desteklenmez ve istemciden sunucuya iletiÅŸim gerektiren durumlar iÃ§in ayrÄ± HTTP istekleri gerektirir. SignalR, WebSockets kullanÄ±lamadÄ±ÄŸÄ±nda otomatik olarak SSE&amp;rsquo;yi tercih ederek kesintisiz bir deneyim sunar.&lt;/p>
&lt;h3 id="long-polling-longpolling">&lt;strong>Long Polling (&lt;/strong>&lt;code>longPolling&lt;/code>&lt;strong>):&lt;/strong>&lt;/h3>
&lt;p>Long Polling, sÃ¼rekli olarak HTTP baÄŸlantÄ±larÄ± aÃ§Ä±p kapatarak gerÃ§ek zamanlÄ± iletiÅŸimi taklit eder. Ä°stemci, sunucuya bir istek gÃ¶nderir ve sunucu veri gÃ¶nderene kadar baÄŸlantÄ±yÄ± aÃ§Ä±k tutar. Veriler iletildikten sonra istemci hemen yeni bir istek oluÅŸturur. Bu yÃ¶ntem, gÃ¼ncellemeler arasÄ±ndaki gecikmeyi en aza indirir ve bir tÃ¼r push tabanlÄ± baÄŸlantÄ± hissi yaratÄ±r.&lt;/p>
&lt;p>Long Polling, tÃ¼m tarayÄ±cÄ±larla Ã§alÄ±ÅŸabilir ve uygulanmasÄ± kolaydÄ±r. Ancak, sÄ±k HTTP istekleri ve yanÄ±tlarÄ± nedeniyle daha fazla yÃ¼k oluÅŸturur. Bu, Ã¶zellikle yÃ¼ksek frekanslÄ± gÃ¼ncellemelerde, WebSockets veya SSE&amp;rsquo;ye kÄ±yasla daha az verimlidir. SignalR, WebSockets veya SSE desteklenmediÄŸinde Long Pollingâ€™i bir yedek Ã§Ã¶zÃ¼m olarak kullanÄ±r.&lt;/p>
&lt;h3 id="forever-frame-foreverframe">&lt;strong>Forever Frame (&lt;/strong>&lt;code>foreverFrame&lt;/code>&lt;strong>):&lt;/strong>&lt;/h3>
&lt;p>Forever Frame, eski Internet Explorer sÃ¼rÃ¼mlerine Ã¶zgÃ¼ bir protokoldÃ¼r ve gerÃ§ek zamanlÄ±, tek yÃ¶nlÃ¼ iletiÅŸim saÄŸlar. Ä°stemci tarayÄ±cÄ±sÄ±nda gizli bir iframe oluÅŸturur ve sunucu bu iframeâ€™e sÃ¼rekli olarak Ã§alÄ±ÅŸtÄ±rÄ±labilir komut dosyalarÄ± gÃ¶nderir.&lt;/p>
&lt;p>Forever Frame, Ã§ift yÃ¶nlÃ¼ iletiÅŸimi desteklememesi ve yÃ¼ksek ek yÃ¼k getirmesi gibi sÄ±nÄ±rlamalara sahiptir. Ä°stemciden sunucuya iletiÅŸim, ayrÄ± standart HTTP istekleri gerektirir ve bu da uygulamayÄ± daha az verimli ve zahmetli hale getirir. SignalR, yalnÄ±zca eski Internet Explorer tarayÄ±cÄ±larÄ±na Ã¶zgÃ¼ ortamlar iÃ§in bir son Ã§are olarak Forever Frameâ€™i kullanÄ±r.&lt;/p>
&lt;h3 id="websockets-ve-server-sent-events-karÅŸÄ±laÅŸtÄ±rmasÄ±">WebSockets ve Server-Sent Events KarÅŸÄ±laÅŸtÄ±rmasÄ±&lt;/h3>
&lt;p>WebSockets ve Server-Sent Events (SSE), farklÄ± gerÃ§ek zamanlÄ± iletiÅŸim ihtiyaÃ§larÄ±na hitap eder. &lt;strong>WebSockets&lt;/strong>, dÃ¼ÅŸÃ¼k gecikmeli, Ã§ift yÃ¶nlÃ¼ iletiÅŸim sunarak sohbet, oyun ve ortak Ã§alÄ±ÅŸma araÃ§larÄ± iÃ§in idealdir. &lt;strong>SSE&lt;/strong> ise hafif, tek yÃ¶nlÃ¼ gÃ¼ncellemeler saÄŸlayarak canlÄ± panolar ve bildirimler gibi durumlar iÃ§in mÃ¼kemmeldir.&lt;/p>
&lt;p>WebSockets, etkili iki yÃ¶nlÃ¼ mesajlaÅŸma iÃ§in Ã¶zel bir protokol (&lt;code>ws://&lt;/code> veya &lt;code>wss://&lt;/code>) kullanÄ±r ancak Ã¶lÃ§eklendirme iÃ§in WebSocket uyumlu altyapÄ± gerektirir. SSE ise standart HTTP (&lt;code>text/event-stream&lt;/code>) Ã¼zerinde Ã§alÄ±ÅŸÄ±r ve geleneksel HTTP araÃ§larÄ± ile daha kolay Ã¶lÃ§eklenebilir. Ancak, yalnÄ±zca sunucudan istemciye iletiÅŸim saÄŸlar ve Internet Explorer desteÄŸi bulunmaz.&lt;/p>
&lt;p>SignalR, bu farklÄ±lÄ±klarÄ± soyutlayarak performans iÃ§in WebSockets&amp;rsquo;i Ã¶nceliklendirir ve kesintisiz gerÃ§ek zamanlÄ± iÅŸlevsellik saÄŸlamak iÃ§in SSE veya diÄŸer yÃ¶ntemlere otomatik olarak geÃ§iÅŸ yapar.&lt;/p>
&lt;h2 id="protokolÃ¼-belirleme">ProtokolÃ¼ Belirleme&lt;/h2>
&lt;p>SignalR, gerÃ§ek zamanlÄ± iletiÅŸim iÃ§in kullanÄ±lacak taÅŸÄ±ma protokolÃ¼nÃ¼ aÃ§Ä±kÃ§a belirtmenize olanak tanÄ±r. VarsayÄ±lan olarak, SignalR dahili algoritmasÄ±yla mevcut en iyi protokolÃ¼ otomatik olarak seÃ§er. Ancak, bu davranÄ±ÅŸÄ± uygulamanÄ±zÄ±n ihtiyaÃ§larÄ±na gÃ¶re Ã¶zelleÅŸtirebilirsiniz.&lt;/p>
&lt;p>WebSocketsâ€™in verimliliÄŸinden yararlanmak ve WebSockets kullanÄ±lamadÄ±ÄŸÄ±nda Long Pollingâ€™e geÃ§iÅŸ yapmak iÃ§in &lt;code>Program.cs&lt;/code> dosyasÄ±na ÅŸu kodu ekleyebilirsiniz:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.MapHub&amp;lt;NotificationsHub&amp;gt;(&lt;span style="color:#e6db74">&amp;#34;/hubs/notification&amp;#34;&lt;/span>, opt =&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> opt.Transports = HttpTransportType.WebSockets | HttpTransportType.LongPolling;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>});
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Veya istemci tarafÄ±nda JavaScript ile ÅŸu ÅŸekilde yapÄ±landÄ±rabilirsiniz:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> &lt;span style="color:#a6e22e">connection&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">signalR&lt;/span>.&lt;span style="color:#a6e22e">HubConnectionBuilder&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .&lt;span style="color:#a6e22e">withUrl&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/hubs/notification&amp;#34;&lt;/span>, {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">transport&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">signalR&lt;/span>.&lt;span style="color:#a6e22e">HttpTransportType&lt;/span>.&lt;span style="color:#a6e22e">WebSockets&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">|&lt;/span> &lt;span style="color:#a6e22e">signalR&lt;/span>.&lt;span style="color:#a6e22e">HttpTransportType&lt;/span>.&lt;span style="color:#a6e22e">LongPolling&lt;/span> })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .&lt;span style="color:#a6e22e">build&lt;/span>();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="Ã¶zet">Ã–zet&lt;/h2>
&lt;p>SignalR, .NET uygulamalarÄ±na gerÃ§ek zamanlÄ± Ã¶zellikler eklemeyi kolay ve verimli hale getirir. KarmaÅŸÄ±k aÄŸ protokollerini soyutlayarak, alt yapÄ± detaylarÄ±yla uÄŸraÅŸmadan canlÄ± panolar, sohbet uygulamalarÄ± veya bildirimler oluÅŸturmanÄ±za olanak tanÄ±r. WebSockets, Server-Sent Events (SSE) ve Long Polling gibi protokolleri destekleyen SignalR, ortamÄ±nÄ±za en uygun protokolÃ¼ otomatik olarak seÃ§erek kesintisiz bir deneyim sunar.&lt;/p>
&lt;p>Kaynak koduna eriÅŸmek isterseniz projenin tamamÄ±nÄ± GitHub hesabÄ±mda bulabilirsiniz:&lt;/p>
&lt;p>&lt;a href="https://github.com/berkslv/lecture-signalr-deep-dive">GitHub - berkslv/lecture-signalr-deep-dive&lt;/a>&lt;/p>
&lt;hr>
&lt;h2 id="sonuÃ§">SonuÃ§&lt;/h2>
&lt;p>OkuduÄŸunuz iÃ§in teÅŸekkÃ¼rler! ðŸŽ‰ YazÄ±lÄ±m geliÅŸtirme alanÄ±ndaki araÅŸtÄ±rmalarÄ±mÄ± kaÃ§Ä±rmamak iÃ§in &lt;a href="https://x.com/berkslv">@berkslv&lt;/a> adresinden takipte kalabilirsiniz.&lt;/p></content></item><item><title>Event-Driven Architecture: Mikroservis mimarisinde baÅŸka servislerin verilerine mi ihtiyacÄ±nÄ±z var</title><link>https://berkselvi.dev/tr/posts/do-you-need-other-services-data-in-microservice-architecture-event-driven-architecture/</link><pubDate>Sat, 07 Sep 2024 00:00:00 +0300</pubDate><guid>https://berkselvi.dev/tr/posts/do-you-need-other-services-data-in-microservice-architecture-event-driven-architecture/</guid><description>&lt;p>Microservice mimarisinde geliÅŸtirilen uygulamalarda domainler genellikle birbirlerinden sÄ±kÄ± bir ÅŸekilde ayrÄ±lmaya Ã§alÄ±ÅŸÄ±lÄ±yor, inceleyeceÄŸimiz Ã¶rnekte Ã¼rÃ¼n ile ilgili tÃ¼m logic ve data product servisinde yer alÄ±rken, bu Ã¼rÃ¼n ile sipariÅŸ oluÅŸturabilecek satÄ±ÅŸ danÄ±ÅŸmanlarÄ±nÄ± yÃ¶neten organization serviside kendi logic ve datasÄ±nÄ± barÄ±ndÄ±rÄ±yor.&lt;/p>
&lt;p>Ancak organization servisinde satÄ±ÅŸ danÄ±ÅŸmanÄ± oluÅŸturmak iÃ§in yapacaÄŸÄ±mÄ±z &lt;code>createUnit()&lt;/code> isteÄŸi validasyon sebepleri iÃ§in product servisinin verisine ihtiyaÃ§ duyacaktÄ±r. Var olmayan bir Ã¼rÃ¼n iÃ§in oluÅŸturma izni unitâ€™e verilmemeli deÄŸil mi? Bu durumda organization servisi kendi domainâ€™inde yer almayan ve kendi sorumluluÄŸunda olmayan product servisinin verisine ihtiyaÃ§ duyacak.&lt;/p></description><content>&lt;p>Microservice mimarisinde geliÅŸtirilen uygulamalarda domainler genellikle birbirlerinden sÄ±kÄ± bir ÅŸekilde ayrÄ±lmaya Ã§alÄ±ÅŸÄ±lÄ±yor, inceleyeceÄŸimiz Ã¶rnekte Ã¼rÃ¼n ile ilgili tÃ¼m logic ve data product servisinde yer alÄ±rken, bu Ã¼rÃ¼n ile sipariÅŸ oluÅŸturabilecek satÄ±ÅŸ danÄ±ÅŸmanlarÄ±nÄ± yÃ¶neten organization serviside kendi logic ve datasÄ±nÄ± barÄ±ndÄ±rÄ±yor.&lt;/p>
&lt;p>Ancak organization servisinde satÄ±ÅŸ danÄ±ÅŸmanÄ± oluÅŸturmak iÃ§in yapacaÄŸÄ±mÄ±z &lt;code>createUnit()&lt;/code> isteÄŸi validasyon sebepleri iÃ§in product servisinin verisine ihtiyaÃ§ duyacaktÄ±r. Var olmayan bir Ã¼rÃ¼n iÃ§in oluÅŸturma izni unitâ€™e verilmemeli deÄŸil mi? Bu durumda organization servisi kendi domainâ€™inde yer almayan ve kendi sorumluluÄŸunda olmayan product servisinin verisine ihtiyaÃ§ duyacak.&lt;/p>
&lt;p>Bu veriye senkron veya asenkron olarak eriÅŸebiliriz. ilk olarak senkron olarak eriÅŸecek ve yaÅŸayacaÄŸÄ±mÄ±z sorunlarÄ± ele aldÄ±ktan sonra, asenkron methodu kullanÄ±p yaÅŸayabileceÄŸimiz sorunlarÄ± ele alacaÄŸÄ±z, hadi baÅŸlayalÄ±m.&lt;/p>
&lt;h2 id="synchronous-communication">Synchronous communication&lt;/h2>
&lt;p>Organization servisimize rest ile gÃ¶ndereceÄŸimiz istek ile, createUnit() methodunu tetikletecek ve unit oluÅŸturacaÄŸÄ±z, ancak bu servis product verisine validasyon sebebiyle iÃ§in ihtiyaÃ§ duyacaÄŸÄ± iÃ§in bu veriyi senkron olarak, HTTP REST yardÄ±mÄ±yla yapacaÄŸÄ± &lt;code>getProduct()&lt;/code> isteÄŸi ile getirmesi gerekecektir.&lt;/p>
&lt;p>runtime sÄ±rasÄ±nda, createUnit methodunun iÅŸlenebilmesi iÃ§in organization servisine ek olarak product servisininde ayakta ve eriÅŸilebilir olmasÄ±, aradaki network baÄŸlantÄ±sÄ±nda bir sorun olmamasÄ± gerekiyor. EÄŸer product servisi Ã§alÄ±ÅŸmÄ±yorsa, organization serviside Ã§alÄ±ÅŸmayacaktÄ±r. Her iki serviste ayakta ve eriÅŸilebilir olduÄŸu durumlarda ise product servisi yavaÅŸ Ã§alÄ±ÅŸÄ±yorsa, senkron yapacaÄŸÄ±mÄ±z istek akÄ±ÅŸÄ± bloklayacaÄŸÄ± iÃ§in, organization serviside yavaÅŸ Ã§alÄ±ÅŸacaktÄ±r. Bu sorunu aÅŸmak iÃ§in organization servisinin yoÄŸun istek aldÄ±ÄŸÄ± durumlarda scale edilecektir. Ancak runtime baÄŸÄ±mlÄ±lÄ±ÄŸÄ± bulunan product servisininde organizationdan gelecek bol miktarda isteÄŸi karÅŸÄ±layabilmek iÃ§in aynÄ± ÅŸekilde scale etmemiz gerekecektir. Bu pratiÄŸi tÃ¼m servislere uyguladÄ±ÄŸÄ±mÄ±z senaryoda, tÃ¼m servislerin beraber scale edilmesi gerekecektir. Bu sebeple Organization servisi, Product servisine son derece baÄŸÄ±mlÄ± olup, yaÅŸamlarÄ±na kendi baÅŸlarÄ±na deÄŸil, beraber devam etmek zorunda kalacaklardÄ±r. EÄŸer microservice mimarimizdeki tÃ¼m servislerimiz birbirlerine bu ÅŸekilde baÄŸÄ±mlÄ± olursa tek bir servisin eriÅŸilemez olmasÄ± diÄŸer tÃ¼m servislerin eriÅŸilemez olmasÄ±na yol aÃ§abilir.&lt;/p>
&lt;p>design time sÄ±rasÄ±nda ise product servisinin getProduct APIâ€™Ä±nda yapÄ±lacak olan bir geliÅŸtirme sonrasÄ± Organization servisinin geliÅŸtirici takÄ±mÄ±da aynÄ± deÄŸiÅŸikliÄŸi kendi Product HTTP Client entegrasyonlarÄ±nda yapmalarÄ± gerekecektir. Bu deÄŸiÅŸiklik bÃ¼yÃ¼k olasÄ±lÄ±kla organization servisinin iÅŸ akÄ±ÅŸlarÄ±ndada kod deÄŸiÅŸikliÄŸe yol aÃ§acaktÄ±r.&lt;/p>
&lt;p>SonuÃ§ olarak hem runtimeâ€™da hemde design timeâ€™da coupling ortaya Ã§Ä±kacaÄŸÄ± iÃ§in iki servis birbirine gÃ¶bekten baÄŸlÄ± olacaktÄ±r, Jonathan Towerâ€™Ä±n tabiriyle &lt;a href="https://www.youtube.com/watch?v=p2GlRToY5HI&amp;amp;t=1203s">distributed monolith&lt;/a> geliÅŸtirmiÅŸ olacaÄŸÄ±z. Bir servisimizde yapÄ±lacak olan deÄŸiÅŸiklik, diÄŸer serviside direk olarak etkileyeceÄŸinden Ã¶tÃ¼rÃ¼, sÃ¼rekli deÄŸiÅŸen iÅŸ gereksinimlerine hÄ±zlÄ±ca cevap veremeyeceÄŸiz. Product servisinin getProduct() methodunda yapÄ±lan herhangi bir geliÅŸtirmeye istinaden, bu ucu kullanan diÄŸer servislerinde aynÄ± geliÅŸtirmeyi kendi servislerinde yapmasÄ± gerekecektir. GeliÅŸtirmeyi bir ÅŸekilde tamamladÄ±ktan sonrada son kullanÄ±cÄ±larÄ±n uygulamamÄ±zÄ± kullanabilmesi iÃ§in senkron olarak birbirlerine baÄŸlÄ± olan tÃ¼m servislerin eriÅŸilebilir olmasÄ± gerekecektir.&lt;/p>
&lt;img src="https://berkselvi.dev/img/do-you-need-other-services-data-in-microservice-architecture-event-driven-architecture/synchronous-communication.png" alt="Synchronous communication" loading="lazy" />
&lt;p class="image-sub-title">Synchronous communication&lt;/p>
&lt;p>MÃ¼ÅŸterimize bir SLA garantisi vermek istediÄŸimiz senaryoda, iyimser olarak Product ve Organization servislerimiz iÃ§in %99.5 uptime garantisi verecek olursak yÄ±llÄ±k 43 saat downtime yaÅŸanabileceÄŸini kabul ediyoruz. product ve organization servislerinin runtimeâ€™da baÄŸÄ±mlÄ± olacaÄŸÄ± senaryoda $0.995 * 0,995 = 0.990$ hesabÄ±yla senkron iletiÅŸimle beraber Ã§alÄ±ÅŸan servislerimiz ile yaÅŸanan baÄŸÄ±mlÄ±lÄ±k sonucunda, her bir servisimiz iki kat daha kÃ¶tÃ¼ uptime garanti ederek, yÄ±llÄ±k 87 saat downtime yaÅŸayabileceklerini gÃ¶rÃ¼yoruz.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>&lt;/th>
&lt;th>Product&lt;/th>
&lt;th>Organization&lt;/th>
&lt;th>Product &amp;amp; Organization&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Uptime percentege&lt;/td>
&lt;td>99.5&lt;/td>
&lt;td>99.5&lt;/td>
&lt;td>99.0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Month&lt;/td>
&lt;td>716&lt;/td>
&lt;td>716&lt;/td>
&lt;td>712&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Downtime in month&lt;/td>
&lt;td>4&lt;/td>
&lt;td>4&lt;/td>
&lt;td>7&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Year&lt;/td>
&lt;td>8716&lt;/td>
&lt;td>8716&lt;/td>
&lt;td>8672&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Downtime in year&lt;/td>
&lt;td>43&lt;/td>
&lt;td>43&lt;/td>
&lt;td>87&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>Peki baÅŸÄ±mÄ±zÄ± bu kadar aÄŸrÄ±tabileceÄŸini Ã¶n gÃ¶rdÃ¼ÄŸÃ¼mÃ¼z bu yÃ¶ntemden nasÄ±l kaÃ§Ä±nacaÄŸÄ±z? Servisler arasÄ± iletiÅŸimdeki diÄŸer Ã§Ã¶zÃ¼m Ã¶nerimize bir bakalÄ±m.&lt;/p>
&lt;h2 id="asynchronous-communication">Asynchronous communication&lt;/h2>
&lt;p>Senkron iletiÅŸim, servisler arasÄ± baÄŸÄ±mlÄ±lÄ±ÄŸÄ± mÃ¼mkÃ¼n olan her yÃ¶nde arttÄ±rdÄ±ÄŸÄ± iÃ§in bu seÃ§eneÄŸi tercih etmek istemezsek, diÄŸer seÃ§eneÄŸimiz olan asenkron iletiÅŸimle devam edebiliriz. Asenkron yÃ¶ntemle oklarÄ± tersine Ã§evirerek Product servisinin Product tablosunda bir gÃ¼ncelleme yaÅŸanmasÄ± durumunda ProductCreatedEvent isminde bir domain event publish ediyoruz. Bu eventi dinleyen tÃ¼m servisler, kendi veritabanlarÄ±nda tuttuklarÄ± products tablolarÄ±nÄ± gÃ¼ncelliyorlar.&lt;/p>
&lt;p>Organization servisi product verisine ihtiyaÃ§ duyduÄŸunda kendi veritabanÄ±nda yer alan products tablosundan okuma yapacaktÄ±r. Bu tablo organizationâ€™Ä±n iÅŸ akÄ±ÅŸlarÄ±ndan etkilenmeden, sadece okuma yapÄ±lacaktÄ±r. Bu ÅŸekilde createUnit() methodumuzda ihtiyacÄ±mÄ±z olacak Ã¼rÃ¼n bilgisini sorgulamak iÃ§in unit verisini kaydedeceÄŸimiz aynÄ± veritabanÄ±ndan okuma yaparak ilgili veriye ulaÅŸmÄ±ÅŸ oluruz.&lt;/p>
&lt;img src="https://berkselvi.dev/img/do-you-need-other-services-data-in-microservice-architecture-event-driven-architecture/asynchronous-communication.png" alt="Asynchronous communication" loading="lazy" />
&lt;p class="image-sub-title">Asynchronous communication&lt;/p>
&lt;p>Bu yÃ¶ntemle createUnit() akÄ±ÅŸÄ±mÄ±zda product verisine organizationâ€™Ä±n kendi veritabanÄ±ndan eriÅŸerek, Product servisimize runtime sÄ±rasÄ±ndaki baÄŸÄ±mlÄ±lÄ±ÄŸÄ±mÄ±zÄ± ortadan kaldÄ±rÄ±yoruz.&lt;/p>
&lt;p>Bu sayede, run time sÄ±rasÄ±ndaki baÄŸÄ±mlÄ±lÄ±k ortadan kalkÄ±yor, Ã§Ã¼nkÃ¼ product servisinin verdiÄŸi getProduct() ucunu senkron bir ÅŸekilde sorgulamayÄ± bÄ±raktÄ±k. design time sÄ±rasÄ±ndada geliÅŸtirme yaparken yaÅŸadÄ±ÄŸÄ±mÄ±z baÄŸÄ±mlÄ±lÄ±kta ortadan kalkmÄ±ÅŸ oluyor. Ã‡Ã¼nkÃ¼ Product servisinin getProduct() methodunda yaptÄ±ÄŸÄ±mÄ±z bir deÄŸiÅŸiklik sonrasÄ±nda Organization servisine sahip olan takÄ±mÄ±n kendi servislerinde bir deÄŸiÅŸiklik yapmasÄ± gerekmiyor.&lt;/p>
&lt;p>Design time sÄ±rasÄ±ndada asenkron bir baÄŸÄ±mlÄ±lÄ±ÄŸÄ±mÄ±z var, sadece ihtiyacÄ±mÄ±z olduÄŸu durumlarda ilgili deÄŸiÅŸiklikleri yapmamÄ±z gerekiyor. EÄŸer Product servisinin product domain modelinde bir deÄŸiÅŸiklik yapÄ±larak yeni bir kolon eklenirse, bu kolon direk olarak eventâ€™e yeni bir field olarak eklenebilir. EÄŸer product tablosunda bir kolon silindiyse, bu kolon, event tipinde silinmeden default deÄŸerleri ile gÃ¶nderilmeye baÅŸlanÄ±p, obsolete olarakta iÅŸaretlenebilir. Bu eklenip Ã§Ä±kartÄ±lan kolonlara diÄŸer servisler diledikleri gibi cevap verebilir veya hiÃ§ bir deÄŸiÅŸiklik yapmadan kendi hayatlarÄ±na devam edebilirler.&lt;/p>
&lt;p>Publish edilen eventin, kimler tarafÄ±ndan iÅŸlendiÄŸi publish eden taraf olan Product servisini ilgilendirmez. ArtÄ±k bu veriye ihtiyacÄ± olan herkes bu eventi consume edip, kendi veritabanlarÄ±nda product verisinin bir kopyasÄ±nÄ± tutarak, Product servisiyle senkron bir iletiÅŸime geÃ§meden kendi iÅŸlerini kendi baÅŸlarÄ±na halledebiliyorlar. Bu ÅŸekilde daha scale edilebilir ve daha eriÅŸilebilir uygulamalar ortaya Ã§Ä±karmÄ±ÅŸ oluyoruz, Ã§Ã¼nkÃ¼ artÄ±k uygulamalarÄ±mÄ±zÄ±n farklÄ± bir servise baÄŸÄ±mlÄ±lÄ±ÄŸÄ± bulunmadan kendi baÅŸlarÄ±na hareket edilebiliyorlar.&lt;/p>
&lt;p>EÄŸer tablolarÄ±mÄ±zÄ±n domain bazÄ±nda karÄ±ÅŸacaÄŸÄ±nÄ± dÃ¼ÅŸÃ¼nÃ¼yorsak farklÄ± domainlerden gelecek olan tablolarÄ± aÅŸaÄŸÄ±daki Ã¶rnekteki gibi farklÄ± bir veritabanÄ± ÅŸemasÄ±nda tutabiliriz.&lt;/p>
&lt;img src="https://berkselvi.dev/img/do-you-need-other-services-data-in-microservice-architecture-event-driven-architecture/asynchronous-communication-2.png" alt="Asynchronous communication" loading="lazy" />
&lt;p class="image-sub-title">Asynchronous communication 2&lt;/p>
&lt;h2 id="eventual-consistency">Eventual consistency&lt;/h2>
&lt;p>Bu yÃ¶ntemin karÅŸÄ±mÄ±za Ã§Ä±kartacaÄŸÄ± en bÃ¼yÃ¼k sorun, eventual consistency yaratacak olmasÄ±dÄ±r. Product servisine eklenen bir Ã¼rÃ¼nÃ¼n, organization servisindeki ilgili tabloya yansÄ±masÄ± aynÄ± t anÄ±nda deÄŸil, aradaki message brokerâ€™Ä±n eriÅŸilebilirlik durumuna gÃ¶re, birkaÃ§ milisaniye veya saniye gecikme ile yaÅŸanacaktÄ±r.&lt;/p>
&lt;p>Bu durumu CAP teorisiylede aÃ§Ä±klayabiliriz. CAP teorisinin 3 bacaÄŸÄ±ndan biri olan Partition tolarence bacaÄŸÄ±nÄ± sabit tutarsak, Consistency ve Availability bacaklarÄ±ndan birisi artarken diÄŸeri azalacaktÄ±r. DolayÄ±sÄ±yla bu Ã¼Ã§ seÃ§eneÄŸi aynÄ± anda saÄŸlayamayacaÄŸÄ±z. Buradada Ã§alÄ±ÅŸtÄ±ÄŸÄ±mÄ±z iÅŸ akÄ±ÅŸÄ±na gÃ¶re karar vermemiz gerekiyor.&lt;/p>
&lt;p>Ã–rneÄŸin bir eticaret sisteminde sepete ekleme Ã¶zelliÄŸinin highly avaliable olmasÄ± gerekebilir, Ã§Ã¼nkÃ¼ sepete ekleme Ã¶zelliÄŸi Ã§alÄ±ÅŸmÄ±yorsa, lÃ¼tfen daha sonra tekrar deneyin gibi bir hata alÄ±yorsak, o sitede deÄŸil rakip sitede alÄ±ÅŸveriÅŸe devam etmemiz olasÄ±dÄ±r. Ancak sepete devam ettiÄŸimizde istediÄŸimiz Ã¼rÃ¼nden 1 deÄŸil 2 adet gÃ¶rÃ¼rsek ilgili dÃ¼zeltmemizi yapÄ±p Ã¶demeye devam edebiliriz.&lt;/p>
&lt;p>Fakat aynÄ± durumu otel rezervasyonlarÄ±nda uygulayamayabiliriz. Sepet Ã¶rneÄŸimizin tersine consistency muhtemelen daha Ã¶nemli olacaktÄ±r. AynÄ± odayÄ± birden Ã§ok kiÅŸiye kiralamak yerine, lÃ¼tfen daha sonra tekrar deneyin gibi bir hata dÃ¶nmek Ã§ok daha mantÄ±klÄ± olabilir.&lt;/p>
&lt;p>SonuÃ§ olarak senkron iletiÅŸimin uygun olduÄŸu immediate consistency isteyen akÄ±ÅŸlar iÃ§in senkron iletiÅŸim, high avalability ihtiyacÄ± olan akÄ±ÅŸlar iÃ§in ise asenkron iletiÅŸimden faydalanabiliriz. Burada kÃ¼Ã§Ã¼k bir yorum olarak microservice mimarisindeki akÄ±ÅŸlarda genellikle high avalability tercih edilmesi gerekiyor, Ã§Ã¼nkÃ¼ diÄŸer senkron iletiÅŸim yÃ¶ntemiyle tÃ¼m servislerimiz gÃ¶bekten birbirlerine baÄŸÄ±mlÄ± olacaklardÄ±r.&lt;/p>
&lt;img src="https://berkselvi.dev/img/do-you-need-other-services-data-in-microservice-architecture-event-driven-architecture/high-avalability-vs-immidiate-consistency.png" alt="High avalability vs Immidiate consistency" loading="lazy" />
&lt;p class="image-sub-title">High avalability vs Immidiate consistency&lt;/p>
&lt;h2 id="edge-cases-in-asynchronous-communication">Edge cases in asynchronous communication&lt;/h2>
&lt;p>EÄŸer servisleriniz arasÄ±ndaki iletiÅŸimde, event driven architecture ile ilerlemeye karar verdiyseniz sistemdeki veri tutarlÄ±lÄ±ÄŸÄ±nÄ± saÄŸlamak iÃ§inde bir ÅŸeyler yapmanÄ±z gerekecektir. Bir servisimize create isteÄŸi gelir ve CreatedEvent publish edersek, ilk Ã¶nce veritabanÄ±nÄ± gÃ¼ncelleyip, sornasÄ±nda event publish ettiÄŸimiz durumda, eÄŸer veritabanÄ±nda yÃ¼rÃ¼ttÃ¼ÄŸÃ¼mÃ¼z transaction hatayla sonuÃ§lanÄ±r, ve bunu takip etmeden eventi publish edersek, veya veritabanÄ±nda yÃ¼rÃ¼ttÃ¼ÄŸÃ¼mÃ¼z transaction baÅŸarÄ±yla sonuÃ§lanÄ±r, ancak sonrasÄ±nda event busâ€™a eriÅŸilemezse, uygulamalarÄ±mÄ±zda daÄŸÄ±tÄ±k olarak duran veri, insonsistent stateâ€™e dÃ¼ÅŸebilir. Bu durumun Ã¶nÃ¼ne geÃ§mek iÃ§in product servisi kendi veritabanÄ±ndaki product verisini gÃ¼ncellerken aynÄ± zamanda aynÄ± veritabanÄ±nda yer alan outbox tablosunada ilgili eventi ekledikten sonra, farklÄ± bir thread bu tabloyu devamlÄ± olarak tarayarak yeni gelen eventleri publish eder. VeritabanÄ±na yaptÄ±ÄŸÄ±mÄ±z kayÄ±t atomic olarak iÅŸleneceÄŸi iÃ§in product verisi oluÅŸturulurken event verisininde outbox tablosunda oluÅŸturulacaÄŸÄ± garanti edilir. Fakat birden Ã§ok instance olarak Ã§alÄ±ÅŸan bir uygulamada bir eventin aynÄ± outbox tablosundan 2 defa okuyup, 2 defa publish etmesi gibi durumlarla karÅŸÄ±laÅŸÄ±labilir. Bu durumda zaten idempotency sorununa Ã§Ä±kÄ±yor.&lt;/p>
&lt;p>Bir metodun bir defa Ã§aÄŸrÄ±ldÄ±ÄŸÄ±nda alÄ±nan sonuÃ§ ile birden fazla kez Ã§aÄŸrÄ±ldÄ±ÄŸÄ±nda alÄ±nan sonuÃ§ aynÄ± ise bu bir idempotent metottur. Bir eventin, farklÄ± sebeplerden Ã¶tÃ¼rÃ¼, birden Ã§ok kez iÅŸlenip sistemdeki veri tutarlÄ±lÄ±ÄŸÄ±nÄ± bozulmasÄ±nÄ± Ã¶nlemek iÃ§in, eventlerin benzersiz message id deÄŸerlerini consume edildikten sonra veritabanÄ±na kaydedip, yeni bir event consume edileceÄŸi zaman, message id deÄŸeri veritabanÄ±nda yoksa iÅŸleme devam etmemiz gerekecektir. Chris Richardson (microservices.io) bu konuya Pattern: Idempotent Consumer isimli yazÄ±sÄ±ndada deÄŸiniyor.&lt;/p>
&lt;img src="https://berkselvi.dev/img/do-you-need-other-services-data-in-microservice-architecture-event-driven-architecture/without-outbox-idempotency.png" alt="Without Outbox &amp; Idempotency" loading="lazy" />
&lt;p class="image-sub-title">Without Outbox &amp; Idempotency&lt;/p>
&lt;img src="https://berkselvi.dev/img/do-you-need-other-services-data-in-microservice-architecture-event-driven-architecture/outbox-idempotency.png" alt="Outbox &amp; Idempotency" loading="lazy" />
&lt;p class="image-sub-title">Outbox &amp; Idempotency&lt;/p>
&lt;p>SonuÃ§ olarak Computer Science alanÄ±ndaki Ã§oÄŸu problemle sunulan Ã§Ã¶zÃ¼m Ã¶nerilerinde olduÄŸu gibi elimizde bir silver bullet bulunmuyor. Her iki yÃ¶nteminde avantajlarÄ± ve dezavantajlarÄ±nÄ± kapsamlÄ± bir ÅŸekilde, Ã§alÄ±ÅŸtÄ±ÄŸÄ±mÄ±z domainâ€™inde aklÄ±mÄ±zda bulundurup deÄŸerlendirdikten sonra dilediÄŸimiz yÃ¶ntemle devam edebiliriz. Ancak benim Ã¶nerim, servisler arasÄ±ndaki baÄŸÄ±mlÄ±lÄ±ÄŸÄ± mÃ¼mkÃ¼n olduÄŸu durumlarda asenkron iletiÅŸim kullanarak ortadan kaldÄ±rmak olacaktÄ±r.&lt;/p>
&lt;p>Asenkron ve senkron veri iletiÅŸimiyle Ã§alÄ±ÅŸÄ±rken yaÅŸanbilecek durumlarÄ± simule etmek iÃ§in geliÅŸtirdiÄŸim .NET projesine aÅŸaÄŸÄ±daki github reposundan ulaÅŸabilirsiniz. Ã–rnekte outbox yapÄ±sÄ± iÃ§in MassTransit tarafÄ±ndan saÄŸlanan altyapÄ± kullanÄ±larak bu Ã¶zellik iÃ§in Ã¶zel bir geliÅŸtirme yapÄ±lmamÄ±ÅŸtÄ±r.&lt;/p>
&lt;p>&lt;a href="https://github.com/berkslv/lecture-fetch-other-service-data-with-event-driven-architecture">GitHub - berkslv/lecture-fetch-other-service-data-with-event-driven-architecture&lt;/a>&lt;/p>
&lt;h2 id="resources">Resources&lt;/h2>
&lt;p>&lt;a href="https://www.youtube.com/watch?v=p2GlRToY5HI&amp;amp;t=1203s">Donâ€™t Build a Distributed Monolith - Jonathan &amp;ldquo;J.&amp;rdquo; Tower - NDC London 2023&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.youtube.com/watch?v=STKCRSUsyP0">The Many Meanings of Event-Driven Architecture â€¢ Martin Fowler â€¢ GOTO 2017&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.youtube.com/watch?v=AEbJgpamZ4w&amp;amp;t=898s">Solving distributed data problems in a microservice architecture | Microservices.io&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.youtube.com/watch?v=rZxIzrjvSGg&amp;amp;t=716s">You Keep Using That Word â€¢ Sam Newman â€¢ GOTO 2023&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://microservices.io/patterns/communication-style/idempotent-consumer.html">Microservices Pattern: Pattern: Idempotent Consumer&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.reactivemanifesto.org/en">The Reactive Manifesto&lt;/a>&lt;/p>
&lt;hr>
&lt;h2 id="sonuÃ§">SonuÃ§&lt;/h2>
&lt;p>OkuduÄŸunuz iÃ§in teÅŸekkÃ¼rler! ðŸŽ‰ YazÄ±lÄ±m geliÅŸtirme alanÄ±ndaki araÅŸtÄ±rmalarÄ±mÄ± kaÃ§Ä±rmamak iÃ§in &lt;a href="https://x.com/berkslv">@berkslv&lt;/a> adresinden takipte kalabilirsiniz.&lt;/p></content></item><item><title>HTTP ve MassTransit ile .NET Mikroservislerinde CorrelationId Takibi</title><link>https://berkselvi.dev/tr/posts/correlationid-tracing-net-microservices-with-http-and-rabbitmq/</link><pubDate>Sun, 14 Jul 2024 00:00:00 +0300</pubDate><guid>https://berkselvi.dev/tr/posts/correlationid-tracing-net-microservices-with-http-and-rabbitmq/</guid><description>&lt;p>Microservice mimarisinde daÄŸÄ±tÄ±k olarak Ã§alÄ±ÅŸan uygulamalarÄ±n kendi aralarÄ±nda yaptÄ±klarÄ± iletiÅŸimler sÄ±rasÄ±nda devam eden iÅŸlemin takip edilebilirliÄŸi ve eÄŸer bir serviste performans sebepli veya akÄ±ÅŸsal bir sorun varsa hangi adÄ±mlardan sonra buraya geldiÄŸini anlamlandÄ±rabilmek iÃ§in Distributed tracing baÅŸlÄ±ÄŸÄ± altÄ±nda CorrelationId Ã§ok Ã¶nemli bir yere sahiptir.&lt;/p>
&lt;p>CorrelationId, bir isteÄŸin tÃ¼m yaÅŸam dÃ¶ngÃ¼sÃ¼ boyunca taÅŸÄ±narak, farklÄ± servisler arasÄ±ndaki baÄŸÄ±ntÄ±yÄ± saÄŸlamalÄ±dÄ±r. Bu yazÄ±da, .NET tabanlÄ± bir microservice mimarisinde HTTP ve RabbitMQ istekleri kullanarak CorrelationId deÄŸerinin nasÄ±l gezdirilebileceÄŸini inceleyeceÄŸiz. Bu Ã§Ã¶zÃ¼m sorunumuza net bir ÅŸekilde cevap olmak iÃ§in tasarlandÄ± ancak her tÃ¼rlÃ¼ yoruma ve geliÅŸtirmeye aÃ§Ä±ktÄ±r, eÄŸer aklÄ±nÄ±zda daha iyi bir Ã§Ã¶zÃ¼m gelirse lÃ¼tfen bana ulaÅŸÄ±n.&lt;/p></description><content>&lt;p>Microservice mimarisinde daÄŸÄ±tÄ±k olarak Ã§alÄ±ÅŸan uygulamalarÄ±n kendi aralarÄ±nda yaptÄ±klarÄ± iletiÅŸimler sÄ±rasÄ±nda devam eden iÅŸlemin takip edilebilirliÄŸi ve eÄŸer bir serviste performans sebepli veya akÄ±ÅŸsal bir sorun varsa hangi adÄ±mlardan sonra buraya geldiÄŸini anlamlandÄ±rabilmek iÃ§in Distributed tracing baÅŸlÄ±ÄŸÄ± altÄ±nda CorrelationId Ã§ok Ã¶nemli bir yere sahiptir.&lt;/p>
&lt;p>CorrelationId, bir isteÄŸin tÃ¼m yaÅŸam dÃ¶ngÃ¼sÃ¼ boyunca taÅŸÄ±narak, farklÄ± servisler arasÄ±ndaki baÄŸÄ±ntÄ±yÄ± saÄŸlamalÄ±dÄ±r. Bu yazÄ±da, .NET tabanlÄ± bir microservice mimarisinde HTTP ve RabbitMQ istekleri kullanarak CorrelationId deÄŸerinin nasÄ±l gezdirilebileceÄŸini inceleyeceÄŸiz. Bu Ã§Ã¶zÃ¼m sorunumuza net bir ÅŸekilde cevap olmak iÃ§in tasarlandÄ± ancak her tÃ¼rlÃ¼ yoruma ve geliÅŸtirmeye aÃ§Ä±ktÄ±r, eÄŸer aklÄ±nÄ±zda daha iyi bir Ã§Ã¶zÃ¼m gelirse lÃ¼tfen bana ulaÅŸÄ±n.&lt;/p>
&lt;img src="https://berkselvi.dev/img/correlationid-tracing-net-microservices-with-http-and-rabbitmq/big-picture.png" alt="Big picture" loading="lazy" />
&lt;p class="image-sub-title">Big picture&lt;/p>
&lt;p>CorrelationId deÄŸerini HTTP ve MassTransit kullanarak servisler arasÄ±ndaki iletiÅŸim sÄ±rasÄ±nda Middleware ve Filter yapÄ±larÄ±yla gelen ve giden isteklerde araya girerek header deÄŸerleri Ã¼zerinde manipulasyonda bulunarak CorrelationId deÄŸerini servisler arasÄ±nda gezdireceÄŸiz. Bu gezdirme sÄ±rasÄ±ndada gelen isteklerle baÅŸlatÄ±lan contextlerin, verilen CorrelationId deÄŸeri ile loglanmasÄ± iÃ§in Serilog tarafÄ±ndan saÄŸlanan LogContext sÄ±nÄ±fÄ±ndan faydalanacaÄŸÄ±z. TÃ¼m Ã¶rneklere aÅŸaÄŸÄ±daki repodan ulaÅŸabilirsiniz.&lt;/p>
&lt;p>&lt;a href="https://github.com/berkslv/lecture-correlation-id-microservices">GitHub - berkslv/lecture-correlation-id-microservices&lt;/a>&lt;/p>
&lt;p>Serivisimize gelen isteklerde aldÄ±ÄŸÄ±mÄ±z CorrelationId deÄŸerini, giden isteklerde gÃ¶ndermek iÃ§in Scoped olarak tanÄ±mlayabileceÄŸimiz Correlation sÄ±nÄ±fÄ±mÄ±zdan yararlanabiliriz. Ancak bu ÅŸekilde Dependency Injection yÃ¶ntemleri ile sÄ±nÄ±flar arasÄ±nda gezdirdiÄŸimiz state deÄŸerimiz async olarak ilerleyen isteÄŸimizde Ã¶zel bir durumda eriÅŸilemez oluyor: DelegatingHandler sÄ±nÄ±fÄ± kullanarak HttpClient ile yapacaÄŸÄ±mÄ±z isteklerde araya girecek olan &lt;code>CorrelationHeaderHandler&lt;/code> sÄ±nÄ±fÄ±mÄ±z uygulamamÄ±zdan ayrÄ± bir DI scope iÃ§erisinde Ã§alÄ±ÅŸacaÄŸÄ± iÃ§in Scoped olarak tanÄ±mlayabileceÄŸimiz Correlation sÄ±nÄ±fÄ±mÄ±zÄ±n deÄŸerine bu Ã¶zel durumda eriÅŸemeyeceÄŸiz. Bu konu microsoft&amp;rsquo;un kendi dÃ¶kÃ¼mantasyonundada ÅŸÃ¶yle aktarÄ±lÄ±yor&lt;/p>
&lt;blockquote>
&lt;p>When IHttpClientFactory creates a new delegating handler, it uses DI to fulfill the handler&amp;rsquo;s constructor parameters. IHttpClientFactory creates a separate DI scope for each handler, which can lead to surprising behavior when a handler consumes a scoped service.&lt;/p>&lt;/blockquote>
&lt;p>Bu soruna Ã§Ã¶zÃ¼m olarak &lt;code>AsyncStorage&lt;/code> isminde bir sÄ±nÄ±f oluÅŸturup Microsoft tarafÄ±ndan saÄŸlanan &lt;code>AsyncLocal&lt;/code> sÄ±nÄ±fÄ±nÄ± kullanarak CorrelationId deÄŸerini async olarak ilerleyen isteÄŸimizde aynÄ± thread iÃ§erisinde dilediÄŸimiz zaman eriÅŸebileceÄŸimiz bir yapÄ± oluÅŸturacaÄŸÄ±z:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">namespace&lt;/span> Order.API.Filters.Correlation;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// &amp;lt;summary&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// Stores and retrieves values in an async context.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// &amp;lt;/summary&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// &amp;lt;typeparam name=&amp;#34;T&amp;#34;&amp;gt;What should be stored&amp;lt;/typeparam&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">AsyncStorage&lt;/span>&amp;lt;T&amp;gt; &lt;span style="color:#66d9ef">where&lt;/span> T : &lt;span style="color:#66d9ef">new&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#66d9ef">readonly&lt;/span> AsyncLocal&amp;lt;T&amp;gt; _asyncLocal = &lt;span style="color:#66d9ef">new&lt;/span> AsyncLocal&amp;lt;T&amp;gt;();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">static&lt;/span> T Store(T val)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _asyncLocal.Value = val;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> _asyncLocal.Value;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">static&lt;/span> T? Retrieve()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> _asyncLocal.Value;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>AsyncStorage sÄ±nÄ±fÄ±na type olarak vereceÄŸimiz Correlation sÄ±nÄ±fÄ±nÄ±, aÅŸaÄŸÄ±daki gibi tanÄ±mlayarak Id property&amp;rsquo;sinde CorrelationId deÄŸerini barÄ±ndÄ±racaÄŸÄ±z.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">namespace&lt;/span> Order.API.Filters.Correlation;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// &amp;lt;summary&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// It holds the CorrelationId value that comes with HTTP requests and events handled via MassTransit.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// &amp;lt;/summary&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">Correlation&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> Guid Id { &lt;span style="color:#66d9ef">get&lt;/span>; &lt;span style="color:#66d9ef">init&lt;/span>; }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>CorrelationId deÄŸerini yapÄ±lan istek boyunca eriÅŸebileceÄŸimiz bir konumda sakladÄ±ÄŸÄ±mÄ±za gÃ¶re, ÅŸimdi gelen isteklerde araya girerek header&amp;rsquo;lardan CorrelationId deÄŸerini Ã§ekelim. Microservice mimarisinde geliÅŸtirilen uygulamalarda servisler arasÄ±nda sadece HTTP deÄŸil, aynÄ± zamanda event tabanlÄ± yÃ¶ntemlerle iletiÅŸim kurulabiliyor. Ancak bu ÅŸekilde baÅŸlatÄ±lan isteklerde, CorrelationId deÄŸerini HTTP header&amp;rsquo;larÄ±nda deÄŸil, MassTransit tarafÄ±ndan saÄŸlanan header deÄŸerlerinde taÅŸÄ±yacaÄŸÄ±z.&lt;/p>
&lt;img src="https://berkselvi.dev/img/correlationid-tracing-net-microservices-with-http-and-rabbitmq/filters-for-correlationid.png" alt="Filters for CorrelationId" loading="lazy" />
&lt;p class="image-sub-title">Filters for CorrelationId&lt;/p>
&lt;h1 id="correlationmiddleware">CorrelationMiddleware&lt;/h1>
&lt;p>Gelen HTTP isteklerinde araya girecek ve CorrelationId HTTP header&amp;rsquo;Ä±ndan deÄŸeri alacak olan CorrelationMiddleware sÄ±nÄ±fÄ±mÄ±zÄ± aÅŸaÄŸÄ±daki gibi tanÄ±mlÄ±yoruz. EÄŸer headerda deÄŸer varsa ilk Ã¶nce Serilog tarafÄ±ndan saÄŸlanan &lt;code>LogContext&lt;/code> sÄ±nÄ±fÄ±na bu deÄŸeri ayrÄ± bir field olarak koyarak bir nevi enrich iÅŸlemi yapÄ±yoruz. Daha sonra &lt;code>AsyncStorage&lt;/code> sÄ±nÄ±fÄ±mÄ±za Correlation sÄ±nÄ±fÄ±nÄ± vererek CorrelationId deÄŸerini saklÄ±yoruz. Bu sayede gelen isteklerde CorrelationId deÄŸerini alÄ±p, giden isteklerde bu deÄŸeri kullanabileceÄŸiz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">namespace&lt;/span> Order.API.Filters.Correlation;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// &amp;lt;summary&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// When the Http request is made, it takes the CorrelationId value from the HttpContext Header and sets the Correlation.Id value.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// &amp;lt;/summary&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">CorrelationMiddleware&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">readonly&lt;/span> RequestDelegate _next;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> CorrelationMiddleware(RequestDelegate next)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _next = next;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> Task InvokeAsync(HttpContext context, Correlation correlation)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> correlationIdHeader = context.Request.Headers[&lt;span style="color:#e6db74">&amp;#34;CorrelationId&amp;#34;&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (!&lt;span style="color:#66d9ef">string&lt;/span>.IsNullOrWhiteSpace(correlationIdHeader))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> correlationId = Guid.Parse(correlationIdHeader.ToString());
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> LogContext.PushProperty(&lt;span style="color:#e6db74">&amp;#34;CorrelationId&amp;#34;&lt;/span>, &lt;span style="color:#66d9ef">new&lt;/span> ScalarValue(correlationId));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> AsyncStorage&amp;lt;Correlation&amp;gt;.Store(&lt;span style="color:#66d9ef">new&lt;/span> Correlation
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Id = correlationId
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">await&lt;/span> _next(context);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Bu middleware&amp;rsquo;i uygulamamÄ±za eklemek iÃ§in Progam.cs iÃ§erisinde aÅŸaÄŸÄ±daki gibi dÃ¼zenliyoruz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> builder = WebApplication.CreateBuilder(args);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">//...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> app = builder.Build();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.UseMiddleware&amp;lt;CorrelationMiddleware&amp;gt;();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">//...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.Run();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="correlationconsumefilter">CorrelationConsumeFilter&lt;/h1>
&lt;p>EÄŸer servisimize gelen istek HTTP deÄŸil, event ile tetiklenen bir istek ise ortada bir HTTP headerÄ± olmayacaktÄ±r. Bu sebeple MassTransit tarafÄ±ndan saÄŸlanan header deÄŸerlerinden CorrelationId deÄŸerini almak iÃ§in CorrelationConsumeFilter sÄ±nÄ±fÄ±mÄ±zÄ± aÅŸaÄŸÄ±daki gibi tanÄ±mlÄ±yoruz. Bu sÄ±nÄ±fÄ±mÄ±zda IConsumer ile imzalanan sÄ±nÄ±flarda consume iÅŸlemi gerÃ§ekleÅŸtirilmeden Ã¶nce, gelen eventlerde araya girerek CorrelationId deÄŸerini alÄ±p, &lt;code>LogContext&lt;/code> ve &lt;code>AsyncStorage&amp;lt;Correlation&amp;gt;&lt;/code> iÃ§erisine ekliyoruz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">namespace&lt;/span> Order.API.Filters.Correlation;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// &amp;lt;summary&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// It is triggered when there is an event consumed by MassTransit and sets the CorrelationId value to the Correlation class.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// &amp;lt;/summary&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">CorrelationConsumeFilter&lt;/span>&amp;lt;T&amp;gt; : IFilter&amp;lt;ConsumeContext&amp;lt;T&amp;gt;&amp;gt; &lt;span style="color:#66d9ef">where&lt;/span> T : &lt;span style="color:#66d9ef">class&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> Task Send(ConsumeContext&amp;lt;T&amp;gt; context, IPipe&amp;lt;ConsumeContext&amp;lt;T&amp;gt;&amp;gt; next)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> correlationIdHeader = context.CorrelationId;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (correlationIdHeader.HasValue)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> correlationId = correlationIdHeader.Value;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> LogContext.PushProperty(&lt;span style="color:#e6db74">&amp;#34;CorrelationId&amp;#34;&lt;/span>, &lt;span style="color:#66d9ef">new&lt;/span> ScalarValue(correlationId));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> AsyncStorage&amp;lt;Correlation&amp;gt;.Store(&lt;span style="color:#66d9ef">new&lt;/span> Correlation
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Id = correlationId
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> next.Send(context);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">void&lt;/span> Probe(ProbeContext context)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Bu ÅŸekilde gelen isteklerde &lt;code>AsyncStorage&amp;lt;Correlation&amp;gt;&lt;/code> iÃ§erisinde tuttuÄŸumuz Correlation deÄŸerimizi, yapÄ±lacak olan event isteklerinde ilgili header alanlarÄ±na eklemek iÃ§in neler yapabileceÄŸimizi inceleyelim.&lt;/p>
&lt;h1 id="correlationpublishfilter">CorrelationPublishFilter&lt;/h1>
&lt;p>MassTransit tarafÄ±ndan saÄŸlanan &lt;code>IPublishEndpoint&lt;/code> ile publish edilen eventlerde araya girecek olan &lt;code>CorrelationPublishFilter&lt;/code> sÄ±nÄ±fÄ±mÄ±zÄ± aÅŸaÄŸÄ±daki gibi tanÄ±mlÄ±yoruz. Bu sÄ±nÄ±fÄ±mÄ±z, publish edilen eventlerde araya girerek &lt;code>AsyncStorage&amp;lt;Correlation&amp;gt;&lt;/code> iÃ§erisinden CorrelationId deÄŸerini alÄ±p, MassTransit&amp;rsquo;in CorrelationId header deÄŸerine ekleyecektir.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">namespace&lt;/span> Order.API.Filters.Correlation;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// &amp;lt;summary&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// Sets the CorrelationId value of events published via MassTransit.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// &amp;lt;/summary&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">CorrelationPublishFilter&lt;/span>&amp;lt;T&amp;gt; : IFilter&amp;lt;PublishContext&amp;lt;T&amp;gt;&amp;gt; &lt;span style="color:#66d9ef">where&lt;/span> T : &lt;span style="color:#66d9ef">class&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> Task Send(PublishContext&amp;lt;T&amp;gt; context, IPipe&amp;lt;PublishContext&amp;lt;T&amp;gt;&amp;gt; next)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> correlation = AsyncStorage&amp;lt;Correlation&amp;gt;.Retrieve();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (correlation &lt;span style="color:#66d9ef">is&lt;/span> not &lt;span style="color:#66d9ef">null&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> context.CorrelationId = Guid.Parse(correlation.Id.ToString()!);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> next.Send(context);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">void&lt;/span> Probe(ProbeContext context)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="correlationsendfilter">CorrelationSendFilter&lt;/h1>
&lt;p>EÄŸer MassTransit&amp;rsquo;e gÃ¶nderilen event publish edilmemiÅŸ ve request/response yapÄ±sÄ± ile &lt;code>IRequestClient&amp;lt;T&amp;gt;&lt;/code> kullanÄ±larak gÃ¶nderildiyse &lt;code>CorrelationPublishFilter&lt;/code> deÄŸil &lt;code>CorrelationSendFilter&lt;/code> sÄ±nÄ±fÄ±mÄ±z araya girecek. Bu sÄ±nÄ±fÄ±mÄ±zda send edilen eventlerde araya girerek &lt;code>AsyncStorage&amp;lt;Correlation&amp;gt;&lt;/code> iÃ§ersinden CorrelationId deÄŸerini alÄ±p, MassTransit&amp;rsquo;in CorrelationId header deÄŸerininin iÃ§erisine ekliyoruz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">namespace&lt;/span> Order.API.Filters.Correlation;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// &amp;lt;summary&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// Sets the CorrelationId value of events sent via MassTransit.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// &amp;lt;/summary&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">CorrelationSendFilter&lt;/span>&amp;lt;T&amp;gt; : IFilter&amp;lt;SendContext&amp;lt;T&amp;gt;&amp;gt; &lt;span style="color:#66d9ef">where&lt;/span> T : &lt;span style="color:#66d9ef">class&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> Task Send(SendContext&amp;lt;T&amp;gt; context, IPipe&amp;lt;SendContext&amp;lt;T&amp;gt;&amp;gt; next)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> correlation = AsyncStorage&amp;lt;Correlation&amp;gt;.Retrieve();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (correlation &lt;span style="color:#66d9ef">is&lt;/span> not &lt;span style="color:#66d9ef">null&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> context.CorrelationId = Guid.Parse(correlation.Id.ToString());
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> next.Send(context);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">void&lt;/span> Probe(ProbeContext context)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>CorrelationConsumeFilter&lt;/code>, &lt;code>CorrelationPublishFilter&lt;/code> ve &lt;code>CorrelationSendFilter&lt;/code> sÄ±nÄ±flarÄ±mÄ±zÄ± uygulamamÄ±za eklemek iÃ§in aÅŸaÄŸÄ±daki gibi ConfigureServices sÄ±nÄ±fÄ±mÄ±zÄ± tanÄ±mlayÄ±p bu methodu Program.cs iÃ§erisinde kullanÄ±yoruz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">ConfigureServices&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">static&lt;/span> WebApplicationBuilder AddMassTransit(&lt;span style="color:#66d9ef">this&lt;/span> WebApplicationBuilder builder, IConfiguration configuration)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> messageBroker = builder.Configuration.GetSection(&lt;span style="color:#e6db74">&amp;#34;MessageBroker&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> builder.Services.AddMassTransit(cfg =&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cfg.SetKebabCaseEndpointNameFormatter();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cfg.AddConsumers(Assembly.GetExecutingAssembly());
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cfg.UsingRabbitMq((context, config) =&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> config.UseSendFilter(&lt;span style="color:#66d9ef">typeof&lt;/span>(CorrelationSendFilter&amp;lt;&amp;gt;), context);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> config.UsePublishFilter(&lt;span style="color:#66d9ef">typeof&lt;/span>(CorrelationPublishFilter&amp;lt;&amp;gt;), context);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> config.UseConsumeFilter(&lt;span style="color:#66d9ef">typeof&lt;/span>(CorrelationConsumeFilter&amp;lt;&amp;gt;), context);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> config.Host(messageBroker[&lt;span style="color:#e6db74">&amp;#34;Host&amp;#34;&lt;/span>], messageBroker[&lt;span style="color:#e6db74">&amp;#34;VirtualHost&amp;#34;&lt;/span>], h =&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> h.Username(messageBroker[&lt;span style="color:#e6db74">&amp;#34;Username&amp;#34;&lt;/span>]!);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> h.Password(messageBroker[&lt;span style="color:#e6db74">&amp;#34;Password&amp;#34;&lt;/span>]!);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> config.ConfigureEndpoints(context);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> builder;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> builder = WebApplication.CreateBuilder(args);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.AddMassTransit(builder.Configuration);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> app = builder.Build();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.Run();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="correlationheaderhandler">CorrelationHeaderHandler&lt;/h1>
&lt;p>EÄŸer servisimizden yapÄ±lan istek event deÄŸil HTTP isteÄŸi ise &lt;code>IHttpClientFactory&lt;/code> ile oluÅŸturacaÄŸÄ±mÄ±z HttpClient sÄ±nÄ±fÄ±mÄ±zdan yapacaÄŸÄ±mÄ±z isteklerde araya girecek olan &lt;code>CorrelationHeaderHandler&lt;/code> sÄ±nÄ±fÄ±mÄ±zÄ± aÅŸaÄŸÄ±daki gibi tanÄ±mlÄ±yoruz. Bu sÄ±nÄ±fÄ±mÄ±zda uygulamamÄ±zdan yapÄ±lan HTTP isteklerinde araya girerek &lt;code>AsyncStorage&amp;lt;Correlation&amp;gt;&lt;/code> iÃ§ersinden CorrelationId deÄŸerini alÄ±p, HTTP header olarak ekliyoruz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// &amp;lt;summary&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// Middleware to be used in requests made with HttpClient. Adds the CorrelationId header to the requests made.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// &amp;lt;/summary&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">CorrelationHeaderHandler&lt;/span> : DelegatingHandler
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">protected&lt;/span> &lt;span style="color:#66d9ef">override&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> Task&amp;lt;HttpResponseMessage&amp;gt; SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> correlation = AsyncStorage&amp;lt;Correlation&amp;gt;.Retrieve();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (correlation &lt;span style="color:#66d9ef">is&lt;/span> not &lt;span style="color:#66d9ef">null&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> request.Headers.Add(&lt;span style="color:#e6db74">&amp;#34;CorrelationId&amp;#34;&lt;/span>, correlation.Id.ToString());
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#66d9ef">base&lt;/span>.SendAsync(request, cancellationToken);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Bu middleware&amp;rsquo;i uygulamamÄ±za eklemek iÃ§in Progam.cs iÃ§erisinde aÅŸaÄŸÄ±daki gibi Named Http Client tanÄ±mlayÄ±p &lt;code>AddHttpMessageHandler&lt;/code> ile yapÄ±lacak isteklerde araya girecek olan middleware&amp;rsquo;i ekliyoruz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> builder = WebApplication.CreateBuilder(args);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.Services.AddTransient&amp;lt;CorrelationHeaderHandler&amp;gt;();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.Services.AddHttpClient(&lt;span style="color:#e6db74">&amp;#34;Inventory&amp;#34;&lt;/span>, c =&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> c.BaseAddress = &lt;span style="color:#66d9ef">new&lt;/span> Uri(&lt;span style="color:#e6db74">&amp;#34;http://localhost:5053&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .AddHttpMessageHandler&amp;lt;CorrelationHeaderHandler&amp;gt;();;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> app = builder.Build();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.Run();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>OluÅŸturduÄŸumuz Named Http Client iÃ§in kullanÄ±mÄ± aÅŸaÄŸÄ±daki gibi yapÄ±yoruz. Burada yapacaÄŸÄ±mÄ±z isteklerin async olmazsa middleware araya giremiyor.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">InventoryService&lt;/span> : IInventoryService
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">readonly&lt;/span> IHttpClientFactory _httpClientFactory;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> InventoryService(IHttpClientFactory httpClientFactory)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _httpClientFactory = httpClientFactory;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> Task RemoveStockAsync(&lt;span style="color:#66d9ef">string&lt;/span> productId, &lt;span style="color:#66d9ef">int&lt;/span> quantity)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> httpClient = _httpClientFactory.CreateClient(&lt;span style="color:#e6db74">&amp;#34;Inventory&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> response = &lt;span style="color:#66d9ef">await&lt;/span> httpClient.PostAsync(&lt;span style="color:#e6db74">$&amp;#34;remove-stock/{productId}/{quantity}&amp;#34;&lt;/span>, &lt;span style="color:#66d9ef">null&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> response.EnsureSuccessStatusCode();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Bu makalede, HTTP ve RabbitMQ kullanarak .NET microservice mimarisinde daÄŸÄ±tÄ±k izlenebilirliÄŸi artÄ±rmak iÃ§in CorrelationId&amp;rsquo;yi nasÄ±l etkili bir ÅŸekilde kullanabileceÄŸimizi inceledik. Middleware ve Filter yapÄ±larÄ±ndan yararlanarak, farklÄ± servisler arasÄ±nda CorrelationId&amp;rsquo;yi yayarak header deÄŸerlerini manipÃ¼le edebildik ve Serilog&amp;rsquo;un LogContext framework&amp;rsquo;Ã¼ ile kapsamlÄ± loglama ve izleme saÄŸladÄ±k.&lt;/p>
&lt;p>CorrelationId&amp;rsquo;yi hem HTTP isteklerinde hem de MassTransit tarafÄ±ndan saÄŸlanan event tabanlÄ± iletiÅŸimde nasÄ±l ele alacaÄŸÄ±mÄ±zÄ± gÃ¶sterdik. HTTP iÃ§in &lt;code>CorrelationMiddleware&lt;/code> ve &lt;code>CorrelationHeaderHandler&lt;/code> sÄ±nÄ±flarÄ±nÄ±; event tabanlÄ± iletiÅŸim iÃ§in ise &lt;code>CorrelationConsumeFilter&lt;/code>, &lt;code>CorrelationPublishFilter&lt;/code> ve &lt;code>CorrelationSendFilter&lt;/code> sÄ±nÄ±flarÄ±nÄ± uygulayarak, CorrelationId&amp;rsquo;nin bir isteÄŸin tÃ¼m yaÅŸam dÃ¶ngÃ¼sÃ¼ boyunca tutarlÄ± bir ÅŸekilde taÅŸÄ±nmasÄ±nÄ± saÄŸladÄ±k. Bu, iÅŸlem akÄ±ÅŸÄ±nÄ±n net bir ÅŸekilde izlenmesini saÄŸladÄ± ve performans veya akÄ±ÅŸ sorunlarÄ±nÄ± belirlemeye yardÄ±mcÄ± oldu.&lt;/p>
&lt;p>&lt;code>AsyncLocal&lt;/code> sÄ±nÄ±fÄ±yla birlikte &lt;code>AsyncStorage&amp;lt;Correlation&amp;gt;&lt;/code> kullanÄ±mÄ±, CorrelationId deÄŸerini farklÄ± kapsamlar arasÄ±nda saklamak ve almak iÃ§in gÃ¼venilir bir yol saÄŸladÄ± ve Dependency Injection ve asenkron iÅŸlemeyle ilgili zorluklarÄ± ele aldÄ±.&lt;/p>
&lt;p>UmarÄ±m bu rehber, kendi microservice mimarinizde saÄŸlam bir daÄŸÄ±tÄ±k izleme Ã§Ã¶zÃ¼mÃ¼ uygulamanÄ±za yardÄ±mcÄ± olur. Daha detaylÄ± Ã¶rnekler iÃ§in, GitHub reposunu inceleyebilirsiniz:&lt;/p>
&lt;p>&lt;a href="https://github.com/berkslv/lecture-correlation-id-microservices">GitHub - berkslv/lecture-correlation-id-microservices&lt;/a>&lt;/p>
&lt;h1 id="kaynaklar">Kaynaklar&lt;/h1>
&lt;p>AsyncLocal sÄ±nÄ±fnÄ±n doÄŸru kullanÄ±mÄ± iÃ§in yararlandÄ±ÄŸÄ±m kaynak:&lt;/p>
&lt;p>&lt;a href="https://medium.com/@mbearz/how-to-log-everything-using-middleware-and-httpclient-handler-42b8f628fe84">https://medium.com/@mbearz/how-to-log-everything-using-middleware-and-httpclient-handler-42b8f628fe84&lt;/a>&lt;/p>
&lt;hr>
&lt;h2 id="sonuÃ§">SonuÃ§&lt;/h2>
&lt;p>OkuduÄŸunuz iÃ§in teÅŸekkÃ¼rler! ðŸŽ‰ YazÄ±lÄ±m geliÅŸtirme alanÄ±ndaki araÅŸtÄ±rmalarÄ±mÄ± kaÃ§Ä±rmamak iÃ§in &lt;a href="https://x.com/berkslv">@berkslv&lt;/a> adresinden takipte kalabilirsiniz.&lt;/p></content></item><item><title>.NET GeliÅŸtiricisi Perspektifinden API Gateway Alternatifleri: YARP, Ocelot, Kong, APISIX ve KrakenD</title><link>https://berkselvi.dev/tr/posts/api-gateway-alternatives-from-a-net-developer-standpoint/</link><pubDate>Mon, 20 May 2024 00:00:00 +0300</pubDate><guid>https://berkselvi.dev/tr/posts/api-gateway-alternatives-from-a-net-developer-standpoint/</guid><description>&lt;p>API Gateway servislerini microservice mimarisinde servislerimizi dÄ±ÅŸ dÃ¼nyaya aÃ§arken bir ara katman olarak kullanabiliyoruz. Bu yazÄ±mÄ±zda kÄ±saca API Gateway nedirden bahsedip sonrasÄ±nda kullanabileceÄŸimiz .NET, OpenResty ve Go tabanlÄ± API Gateway alternatiflerinden performans testleri ile beraber bahsedip sonlandÄ±racaÄŸÄ±z.&lt;/p>
&lt;p>&lt;a href="https://github.com/berkslv/lecture-api-gateway-comparison">GitHub - berkslv/lecture-api-gateway-comparison&lt;/a>&lt;/p>
&lt;h2 id="api-gateway-nedir">API Gateway nedir?&lt;/h2>
&lt;p>API Gateway, sistemlerimize aÅŸaÄŸÄ±daki gibi bir giriÅŸ noktasÄ± saÄŸlarak dÄ±ÅŸ dÃ¼nyadan izole eder. Ä°Ã§erisinde her bir alt serviste tekrar tekrar implemente edilmesi gereken yetkilendirme, loglama, Rate limiting gibi ortak sorunlarÄ± tek bir servis ile Ã§Ã¶zer.&lt;/p></description><content>&lt;p>API Gateway servislerini microservice mimarisinde servislerimizi dÄ±ÅŸ dÃ¼nyaya aÃ§arken bir ara katman olarak kullanabiliyoruz. Bu yazÄ±mÄ±zda kÄ±saca API Gateway nedirden bahsedip sonrasÄ±nda kullanabileceÄŸimiz .NET, OpenResty ve Go tabanlÄ± API Gateway alternatiflerinden performans testleri ile beraber bahsedip sonlandÄ±racaÄŸÄ±z.&lt;/p>
&lt;p>&lt;a href="https://github.com/berkslv/lecture-api-gateway-comparison">GitHub - berkslv/lecture-api-gateway-comparison&lt;/a>&lt;/p>
&lt;h2 id="api-gateway-nedir">API Gateway nedir?&lt;/h2>
&lt;p>API Gateway, sistemlerimize aÅŸaÄŸÄ±daki gibi bir giriÅŸ noktasÄ± saÄŸlarak dÄ±ÅŸ dÃ¼nyadan izole eder. Ä°Ã§erisinde her bir alt serviste tekrar tekrar implemente edilmesi gereken yetkilendirme, loglama, Rate limiting gibi ortak sorunlarÄ± tek bir servis ile Ã§Ã¶zer.&lt;/p>
&lt;p>Ä°stekleri yÃ¶nlendirirken url ve body bilgilerinde hatta protokollerinde dÃ¶nÃ¼ÅŸÃ¼mler uygulayabilirler, http bir isteÄŸi alt servislere daha performanslÄ± olmasÄ± iÃ§in gRPC protokolÃ¼ ile iletebilirler. Gelen istekleri yÃ¶nlendirecekleri servislerin adresini bulmak iÃ§in flat file veya veritabanlarÄ±ndan yararlanabilirler.&lt;/p>
&lt;img src="https://berkselvi.dev/img/api-gateway-alternatives-from-a-net-developer-standpoint/what-is-api-gateway.png" alt="What is API Gateway" loading="lazy" />
&lt;br/>
&lt;h2 id="seÃ§enekler-nelerdir">SeÃ§enekler nelerdir&lt;/h2>
&lt;p>Sistemlerimizde kullanabileceÄŸimiz API Gateway alternatiflerini deÄŸerlendirirken, gereken Ã¶zelleÅŸtirme miktarÄ±, performans, daÄŸÄ±tÄ±k mimariye uygunluk ve admin paneli Ã¼zerinden route bilgilerini gÃ¼ncelleme gibi ihtiyaÃ§larÄ± deÄŸerlendirip uygun kararÄ± vermemiz gerekir. TÃ¼m bu Ã¶zellikleri iÃ§erisinde barÄ±ndÄ±ran, tÃ¼m ihtiyaÃ§larÄ±mÄ±zÄ± tek seferde Ã§Ã¶zen bir gateway Ã¼rÃ¼nÃ¼ maalesef yok, bu deÄŸerlendirmeleri sistemimizin Ã¶zel ihtiyaÃ§larÄ±na gÃ¶re yapmamÄ±z gerekiyor.&lt;/p>
&lt;p>Ä°lk olarak .NET tabanlÄ±, C# ile Ã¶zelleÅŸtirilebilen YARP ve Ocelot API gateway Ã¼rÃ¼nlerini inceleyip, OpenResty yani ngnix ve lua ikilisini beraber kullanan Kong ve Apache APISIXâ€™den bahsettikten sonra son olarak cloud native ortamdada sÄ±klÄ±kla kullanÄ±lan Go ile geliÅŸtirilmiÅŸ KrakenDâ€™yi inceleyeceÄŸiz. TÃ¼m bu seÃ§enekler open source olarak Ã¼cretsiz bir ÅŸekilde kullanÄ±labilir, ancak Kong, Apache APISIX ve KrakenD seÃ§eneklerinde gerektiÄŸinde enterprise desteÄŸide alabiliriz.&lt;/p>
&lt;p>SeÃ§eneklerimizi deÄŸerlendirmeye geÃ§meden Ã¶nce 1 saniye bekleyerek veritabanÄ± sorgularÄ±nÄ± simule eden Ã§ok basit bir .NET API servisi geliÅŸtirdim, bu servisi API Gatewayâ€™in arkasÄ±na aldÄ±ktan sonra isteklerimizi yÃ¶nlendirmeye Ã§alÄ±ÅŸacak ve basit bir performans aracÄ± olan Apache Benchmark kullanarak performans testlerimizi yapacaÄŸÄ±z. Kaynak tÃ¼ketimini daha yakÄ±ndan inceleyebilmek iÃ§in bu uygulamayÄ± diÄŸer gatewayâ€™lerle beraber docker compose ile Ã§alÄ±ÅŸtÄ±rÄ±p service:8080 adresinden isteklerimize cevap alacaÄŸÄ±z.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Program.cs&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> builder = WebApplication.CreateBuilder(args);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.Services.AddEndpointsApiExplorer();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.Services.AddSwaggerGen();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> app = builder.Build();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> (app.Environment.IsDevelopment())
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> app.UseSwagger();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> app.UseSwaggerUI();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.MapGet(&lt;span style="color:#e6db74">&amp;#34;/weather&amp;#34;&lt;/span>, () =&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Task.Delay(&lt;span style="color:#ae81ff">1000&lt;/span>).Wait();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Weather is OK!&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>})
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>.WithName(&lt;span style="color:#e6db74">&amp;#34;GetWeather&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>.WithOpenApi();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.Run();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="net-based">.NET Based&lt;/h2>
&lt;p>.NET developerlarÄ± olarak genellikle aklÄ±mÄ±za ilk gelen Ã§Ã¶zÃ¼m yine .NET teknolojileri ile geliÅŸtirilebilen YARP ve Ocelot API Gatewayâ€™den bahsederek seÃ§eneklerimizi incelemeye baÅŸlayabiliriz. Bu seÃ§enekler performans olarak Ã§ok basit senaryolarda diÄŸer rakipleriyle yarÄ±ÅŸabilirken, kaynak tÃ¼ketimi ve admin dashboard gibi kompleks ihtiyaÃ§lara cevap veremiyorlar.&lt;/p>
&lt;h2 id="yarp">YARP&lt;/h2>
&lt;p>Microsoft&amp;rsquo;un geliÅŸtirdiÄŸi YARP (Yet Another Reverse Proxy), bir reverse proxy Ã¼rÃ¼nÃ¼ olarak Ã¶ne Ã§Ä±kÄ±yor ve API Gateway olarak da kullanÄ±labiliyor. Microsoft&amp;rsquo;un GitHub&amp;rsquo;da yayÄ±nladÄ±ÄŸÄ± eShop Ã¶rnek microservice projelerinde API Gateway olarak kullanÄ±ldÄ±ÄŸÄ± iÃ§in benim dikkatimi Ã§ekmiÅŸti. YARP, load balancing desteÄŸi sunuyor ve birden fazla servis olduÄŸunda bu servislerin adreslerini service discovery yÃ¶ntemleriyle alarak istekleri round robin gibi algoritmalarla bu servislere iletebiliyor. .NET tabanlÄ± olmasÄ± sebebiyle standart .NET API projelerinde kullanÄ±labilen yetkilendirme, rate limiting, distributed tracing, loglama gibi iÅŸlemler de kolayca ve aÅŸina olduÄŸumuz yÃ¶ntemlerle uygulanabiliyor. AyrÄ±ca, middleware eklemesi ile Ã¶zelleÅŸtirmeler yapÄ±labiliyor, HTTP isteklerini gRPC isteklerine dÃ¶nÃ¼ÅŸtÃ¼rebiliyor.&lt;/p>
&lt;p>YARP projesi oluÅŸturmak iÃ§in bir .NET web api projesi oluÅŸturulduktan sonra Yarp.ReverseProxy paketini uygulamaya dahil edip, gerekli konfigÃ¼rasyonlarÄ± yaptÄ±ktan sonra istekleri yÃ¶nlendirmek iÃ§in hazÄ±rÄ±z.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Program.cs&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> builder = WebApplication.CreateBuilder(args);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.Services.AddReverseProxy()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .LoadFromConfig(builder.Configuration.GetSection(&lt;span style="color:#e6db74">&amp;#34;ReverseProxy&amp;#34;&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> app = builder.Build();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.MapReverseProxy();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.Run();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// appsettings.json
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;ReverseProxy&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Routes&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;weaher_route&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;ClusterId&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;weather_api&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Match&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Path&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/weather&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Clusters&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;weather_api&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Destinations&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;destination1&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Address&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;http://service:8080&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Logging&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;LogLevel&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Default&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;Information&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Microsoft.AspNetCore&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;Warning&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;AllowedHosts&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;*&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ocelot">Ocelot&lt;/h2>
&lt;p>Ocelot, YARP ile birÃ§ok ortak Ã¶zelliÄŸe sahip bir API Gateway Ã§Ã¶zÃ¼mÃ¼dÃ¼r. .NET API projelerinde kullanÄ±labilecek tÃ¼m Ã¶zellikleri yine buradada kullanabiliriz, baÄŸÄ±msÄ±z bir open source projesi olarak geliÅŸtiriliyor. Ocelot, YARPâ€™a kÄ±yasla direk olarak API Gateway Ã¼rÃ¼nÃ¼ olarak kendisini konumlandÄ±rÄ±yor. FarklÄ± olarak, gRPC desteÄŸi bulunmamakla birlikte request aggregation gibi Ã¶zellikler sunuyor. Bu Ã¶zellik, backend for frontend yapÄ±larÄ±nda tercih edilebiliyor.&lt;/p>
&lt;p>Ocelot uygulamasÄ± oluÅŸturmak iÃ§in benzer ÅŸekilde bir .NET API projesi oluÅŸturulur ve Program.cs iÃ§erisindeki konfigurasyonlarla birlikte servis konfigÃ¼rasyonlarÄ± appsettings.json deÄŸil ayrÄ± bir ocelot.json dosyasÄ±ndan okunacak ÅŸekilde ayarlanÄ±r. Ocelot ile route tanÄ±mlarÄ±nÄ± yaparken servis adreslerini tekrar tekrar vermemiz gerekiyor, YARP ile bunu tek bir yerden verip oluÅŸturduÄŸumuz servisin bilgisini router iÃ§erisinde belirtmemiz yeterliydi. Request aggregation iÅŸleminide route tanÄ±mlamalarÄ±ndan sonra aggregates kÄ±smÄ±nda yapabiliriz. Daha kompleks ihtiyaÃ§lar iÃ§in ise IDefinedAggregator interface&amp;rsquo;inden yararlanÄ±larak Ã¶zel aggregate&amp;rsquo;ler tanÄ±mlayabiliyoruz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Program.cs&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">using&lt;/span> Ocelot.DependencyInjection;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">using&lt;/span> Ocelot.Middleware;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> builder = WebApplication.CreateBuilder(args);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.Configuration.AddJsonFile(&lt;span style="color:#e6db74">&amp;#34;ocelot.json&amp;#34;&lt;/span>, optional: &lt;span style="color:#66d9ef">false&lt;/span>, reloadOnChange: &lt;span style="color:#66d9ef">true&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.Services.AddOcelot(builder.Configuration);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> app = builder.Build();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">await&lt;/span> app.UseOcelot();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">await&lt;/span> app.RunAsync();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ocelot.json
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Routes&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;DownstreamPathTemplate&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/weather&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;DownstreamScheme&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;http&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;DownstreamHostAndPorts&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Host&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;service&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Port&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">8080&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;UpstreamPathTemplate&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/weather&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;UpstreamHttpMethod&amp;#34;&lt;/span>: [ &lt;span style="color:#e6db74">&amp;#34;Get&amp;#34;&lt;/span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;GlobalConfiguration&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;BaseUrl&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;https://service:8080&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="yarp-vs-ocelot">YARP vs Ocelot&lt;/h2>
&lt;p>Ocelot ve YARP teknolojilerinin karÅŸÄ±laÅŸtÄ±rÄ±lmasÄ± iÃ§in hazÄ±rladÄ±ÄŸÄ±m tabloda gÃ¶rebileceÄŸiniz Ã¼zere Ã§oÄŸu Ã¶zellikte ortaklar. Burada iki teknoloji arasÄ±nda tercih sebebimiz destekledikleri Ã¶zellikler, community desteÄŸi ve konfigurasyon dosyasÄ±nÄ±n yapÄ±sÄ± olabilir diye dÃ¼ÅŸÃ¼nÃ¼yorum.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Ã–zellik&lt;/th>
&lt;th>YARP&lt;/th>
&lt;th>Ocelot&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Routing &amp;amp; Request mapping&lt;/td>
&lt;td>Var&lt;/td>
&lt;td>Var&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Authn &amp;amp; Authz&lt;/td>
&lt;td>Var&lt;/td>
&lt;td>Var&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Rate limiting&lt;/td>
&lt;td>Var&lt;/td>
&lt;td>Var&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Load balancing&lt;/td>
&lt;td>Var&lt;/td>
&lt;td>Var&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>gRPC&lt;/td>
&lt;td>Var&lt;/td>
&lt;td>Yok, Eski paketler mevcut&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Request aggregation&lt;/td>
&lt;td>Yok, Ã–zel geliÅŸtirme gerekiyor&lt;/td>
&lt;td>Var, Basit ise konfigurasyon ile yapÄ±labilir&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Distributed tracing&lt;/td>
&lt;td>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Var&lt;/td>
&lt;td>Var&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>Mac M1 8GB Ã¶zelliklere sahip makinede, docker Ã¼zerinde Ã§alÄ±ÅŸan ortamda, sadece tek bir endpointin olduÄŸu Ã§ok basit bir senaryoda performans testlerimiz iÃ§in 10 bin adet isteÄŸi, 50 concurrent channel Ã¼zerinden Apache Benchmark aracÄ± ile ilettim. Ocelot ortalama 1030 ms, YARP ortalama 1029 ms cevap sÃ¼resi ile hemen hemen aynÄ± sonucu verdiler. TÃ¼ketim iÃ§in 20MB hafÄ±za tÃ¼ketimi ile baÅŸlarken, istekler gelmeye baÅŸlayÄ±nca maksimum 100MB tÃ¼ketime kadar yÃ¼kseldi, CPU iÃ§in ise %10 - %20 arasÄ±nda deÄŸiÅŸkenli gÃ¶steren bir tÃ¼ketim oldu. Bu oranlar YARP ve Ocelot iÃ§in hemen hemen aynÄ±. Testleri yaptÄ±ÄŸÄ±m komutlarda ÅŸu ÅŸekilde:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># YARP&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 100 MB RAM | %10 - %20 CPU&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ab -k -n &lt;span style="color:#ae81ff">10000&lt;/span> -c &lt;span style="color:#ae81ff">50&lt;/span> http://localhost:9090/weather
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Server Software: Kestrel
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Server Hostname: localhost
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Server Port: &lt;span style="color:#ae81ff">9090&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Document Path: /weather
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Document Length: &lt;span style="color:#ae81ff">14&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Concurrency Level: &lt;span style="color:#ae81ff">50&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Time taken &lt;span style="color:#66d9ef">for&lt;/span> tests: 207.561 seconds
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Complete requests: &lt;span style="color:#ae81ff">10000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Failed requests: &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Keep-Alive requests: &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Total transferred: &lt;span style="color:#ae81ff">1470000&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>HTML transferred: &lt;span style="color:#ae81ff">140000&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Requests per second: 48.18 &lt;span style="color:#f92672">[&lt;/span>&lt;span style="color:#75715e">#/sec] (mean)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Time per request: 1037.804 &lt;span style="color:#f92672">[&lt;/span>ms&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#f92672">(&lt;/span>mean&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Time per request: 20.756 &lt;span style="color:#f92672">[&lt;/span>ms&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#f92672">(&lt;/span>mean, across all concurrent requests&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Transfer rate: 6.92 &lt;span style="color:#f92672">[&lt;/span>Kbytes/sec&lt;span style="color:#f92672">]&lt;/span> received
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Connection Times &lt;span style="color:#f92672">(&lt;/span>ms&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> min mean&lt;span style="color:#f92672">[&lt;/span>+/-sd&lt;span style="color:#f92672">]&lt;/span> median max
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Connect: &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> 0.1 &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Processing: &lt;span style="color:#ae81ff">1002&lt;/span> &lt;span style="color:#ae81ff">1029&lt;/span> 122.9 &lt;span style="color:#ae81ff">1015&lt;/span> &lt;span style="color:#ae81ff">2961&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Waiting: &lt;span style="color:#ae81ff">1002&lt;/span> &lt;span style="color:#ae81ff">1028&lt;/span> 122.9 &lt;span style="color:#ae81ff">1015&lt;/span> &lt;span style="color:#ae81ff">2961&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Total: &lt;span style="color:#ae81ff">1002&lt;/span> &lt;span style="color:#ae81ff">1029&lt;/span> 123.0 &lt;span style="color:#ae81ff">1016&lt;/span> &lt;span style="color:#ae81ff">2962&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Percentage of the requests served within a certain time &lt;span style="color:#f92672">(&lt;/span>ms&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 50% &lt;span style="color:#ae81ff">1016&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 66% &lt;span style="color:#ae81ff">1019&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 75% &lt;span style="color:#ae81ff">1021&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 80% &lt;span style="color:#ae81ff">1023&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 90% &lt;span style="color:#ae81ff">1028&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 95% &lt;span style="color:#ae81ff">1033&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 98% &lt;span style="color:#ae81ff">1052&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 99% &lt;span style="color:#ae81ff">1517&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 100% &lt;span style="color:#ae81ff">2962&lt;/span> &lt;span style="color:#f92672">(&lt;/span>longest request&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Ocelot&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 100 MB RAM | %10 - %20 CPU&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ab -k -n &lt;span style="color:#ae81ff">10000&lt;/span> -c &lt;span style="color:#ae81ff">50&lt;/span> http://localhost:9090/weather
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Server Software: Kestrel
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Server Hostname: localhost
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Server Port: &lt;span style="color:#ae81ff">9090&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Document Path: /weather
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Document Length: &lt;span style="color:#ae81ff">14&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Concurrency Level: &lt;span style="color:#ae81ff">50&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Time taken &lt;span style="color:#66d9ef">for&lt;/span> tests: 207.739 seconds
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Complete requests: &lt;span style="color:#ae81ff">10000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Failed requests: &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Keep-Alive requests: &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Total transferred: &lt;span style="color:#ae81ff">1470000&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>HTML transferred: &lt;span style="color:#ae81ff">140000&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Requests per second: 48.14 &lt;span style="color:#f92672">[&lt;/span>&lt;span style="color:#75715e">#/sec] (mean)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Time per request: 1038.695 &lt;span style="color:#f92672">[&lt;/span>ms&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#f92672">(&lt;/span>mean&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Time per request: 20.774 &lt;span style="color:#f92672">[&lt;/span>ms&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#f92672">(&lt;/span>mean, across all concurrent requests&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Transfer rate: 6.91 &lt;span style="color:#f92672">[&lt;/span>Kbytes/sec&lt;span style="color:#f92672">]&lt;/span> received
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Connection Times &lt;span style="color:#f92672">(&lt;/span>ms&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> min mean&lt;span style="color:#f92672">[&lt;/span>+/-sd&lt;span style="color:#f92672">]&lt;/span> median max
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Connect: &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> 0.1 &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Processing: &lt;span style="color:#ae81ff">1001&lt;/span> &lt;span style="color:#ae81ff">1030&lt;/span> 120.0 &lt;span style="color:#ae81ff">1016&lt;/span> &lt;span style="color:#ae81ff">3347&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Waiting: &lt;span style="color:#ae81ff">1001&lt;/span> &lt;span style="color:#ae81ff">1030&lt;/span> 119.9 &lt;span style="color:#ae81ff">1016&lt;/span> &lt;span style="color:#ae81ff">3347&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Total: &lt;span style="color:#ae81ff">1001&lt;/span> &lt;span style="color:#ae81ff">1030&lt;/span> 120.0 &lt;span style="color:#ae81ff">1016&lt;/span> &lt;span style="color:#ae81ff">3349&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Percentage of the requests served within a certain time &lt;span style="color:#f92672">(&lt;/span>ms&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 50% &lt;span style="color:#ae81ff">1016&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 66% &lt;span style="color:#ae81ff">1020&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 75% &lt;span style="color:#ae81ff">1023&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 80% &lt;span style="color:#ae81ff">1025&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 90% &lt;span style="color:#ae81ff">1032&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 95% &lt;span style="color:#ae81ff">1040&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 98% &lt;span style="color:#ae81ff">1061&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 99% &lt;span style="color:#ae81ff">1359&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 100% &lt;span style="color:#ae81ff">3349&lt;/span> &lt;span style="color:#f92672">(&lt;/span>longest request&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="openresty-tabanlÄ±">OpenResty tabanlÄ±&lt;/h2>
&lt;p>Temellerinden yÃ¼ksek performansÄ± ile adÄ±nÄ± duyuran ngnix ve onun Ã¼zerine LuaJIT ile script dili olarak esnek bir geliÅŸtirme ortamÄ± sunan ve JIT desteÄŸi yeniden baÅŸlatmaya gerek kalmadan hot reload Ã¶zelliÄŸini destekleyen Lua kullanÄ±labiliyor. Lua dili Ã§oÄŸu senaryoda iÃ§erdiÄŸi C APIâ€™Ä± sayesinde C kadar yÃ¼ksek performans sunarken aynÄ± zamanda script dili olduÄŸu iÃ§in daha yÃ¼ksek seviyede bir programlama ile, daha geliÅŸtirici dostu yapÄ±sÄ±yla daha esnek geliÅŸtirme yapmaya olanak saÄŸlÄ±yor. C kodundan Lua kodunu veya Lua kodundan C kodunu Ã§aÄŸÄ±rmakta mÃ¼mkÃ¼n, bu sebeplerden Ã¶tÃ¼rÃ¼, beraber kullanÄ±labilen gÃ¼zel bir ikili ortaya Ã§Ä±kmÄ±ÅŸ oluyor. Hatta C ve Lua ikilisi Cloudflare&amp;rsquo;in kendi araÃ§larÄ± iÃ§inde kullandÄ±ÄŸÄ± bir stack, yani networking uygulamarÄ±ndada sÄ±klÄ±kla kullanÄ±lÄ±yor.&lt;/p>
&lt;p>BahsettiÄŸim OpenResty temeline sahip gatewaylerdende sektÃ¶rde Ã§ok sÄ±k tercih edilen ve ismini duyuran Kong, sonrasÄ±nda tamamen open source olduÄŸu iÃ§in dikkat Ã§eken ve kong&amp;rsquo;dan birkaÃ§ gÃ¼zel Ã¶zellikle sÄ±yrÄ±lmayÄ± baÅŸaran Apache APISIX&amp;rsquo;den bahsedip Go tabanlÄ± gatewaylerle devam edeceÄŸiz.&lt;/p>
&lt;h2 id="kong">Kong&lt;/h2>
&lt;p>Kong, API gateway Ã§Ã¶zÃ¼mleri arasÄ±nda Ã¶ne Ã§Ä±kan bir araÃ§tÄ±r. Ocelot ve YARP gibi araÃ§larda bulunan tÃ¼m Ã¶zellikleri iÃ§ermesinin yanÄ± sÄ±ra, 60&amp;rsquo;tan fazla plugin desteÄŸi ile ek Ã¶zellikler sunar. AyrÄ±ca, Lua veya diÄŸer programlama dilleri ile kendi pluginlerinizi geliÅŸtirebilirsiniz. Enterprise versiyonu, GraphQL desteÄŸi, request validation, body gÃ¼ncelleme ve secret manager gibi ekstra Ã¶zellikler saÄŸlar.&lt;/p>
&lt;p>Kong, bir API gatewayâ€™den beklenebilecek yetkilendirme, loglama, request transformation ve rate limiting gibi Ã§oÄŸu Ã¶zelliÄŸi iÃ§erir. Ancak, request aggregation pattern (tek bir istekle birden fazla servisten dÃ¶nen cevabÄ± birleÅŸtirme) gibi bazÄ± Ã¶zellikler iÃ§in ek geliÅŸtirme yapÄ±lmasÄ± gerekir. Native olarak kullanÄ±labilen ve diÄŸer alternatiflerden daha iyi Ã§alÄ±ÅŸacak olan Lua dÄ±ÅŸÄ±nda Go, JavaScript veya Python ile IPC (Inter Process Communication) desteÄŸi sayesindede geliÅŸtirme yapabiliriz ancak daha dÃ¼ÅŸÃ¼k bir performansla karÅŸÄ±laÅŸacaÄŸÄ±z. Bununla birlikte, WebAssembly desteÄŸi sayesinde Go ve Rust dilleri ile IPC yÃ¶ntemlerine gerek kalmadan aÅŸina olduÄŸumuz dillerle yÃ¼ksek performanslÄ± pluginler oluÅŸturabiliyoruz.&lt;/p>
&lt;p>Ocelot ve YARP gibi .NET tabanlÄ± gateway&amp;rsquo;lerden farklÄ± olarak, Kong farklÄ± deployment seÃ§enekleri sunuyor. &amp;ldquo;DB-less&amp;rdquo; mod ile, konfigurasyon dosyalarÄ± Ã¼zerinden yÃ¶netim yapÄ±labilir. Bu mod, CI/CD tabanlÄ± deployment senaryolarÄ±nda oldukÃ§a kullanÄ±ÅŸlÄ±dÄ±r ve state farklÄ±lÄ±klarÄ±ndan kaynaklanabilecek sorunlarÄ± Ã¶nler.&lt;/p>
&lt;img src="https://berkselvi.dev/img/api-gateway-alternatives-from-a-net-developer-standpoint/kong-config-deployment.png" alt="Kong config deployment" loading="lazy" />
&lt;br/>
&lt;p>Kong, ayrÄ±ca traditional olarak adlandÄ±rÄ±lan yÃ¶ntemle veritabanÄ± kullanarak da yapÄ±landÄ±rÄ±labilir. Bu yÃ¶ntemde, PostgreSQL, Cassandra, Redis, InfluxDB ve Kafka gibi veritabanlarÄ± kullanÄ±labilir. Admin API Ã¼zerinden route ve service bilgileri Ã¼zerinde deÄŸiÅŸiklikler yapÄ±labilir. Ancak, bu senaryo veritabanÄ±na ek bir baÄŸÄ±mlÄ±lÄ±k yaratÄ±r ve control plane ile data plane aynÄ± instance Ã¼zerinde Ã§alÄ±ÅŸtÄ±ÄŸÄ± iÃ§in saldÄ±rÄ±lara karÅŸÄ± daha korunaksÄ±z olabilir.&lt;/p>
&lt;img src="https://berkselvi.dev/img/api-gateway-alternatives-from-a-net-developer-standpoint/kong-traditional-deployment.png" alt="Kong traditional deployment" loading="lazy" />
&lt;br/>
&lt;p>Konnect servisi sayesinde uygulayabildiÄŸimiz deployment senaryosu ile data plane ve control plane kÄ±sÄ±mlarÄ±nÄ± birbirinden ayÄ±rarak daha gÃ¼venli bir yapÄ±ya sahip oluyoruz. Konnect, Kong tarafÄ±ndan software as a service olarak sunuluyor ve state yÃ¶netimi iÃ§in ekstra bir veritabanÄ± baÄŸÄ±mlÄ±lÄ±ÄŸÄ± gerektirmiyor.&lt;/p>
&lt;img src="https://berkselvi.dev/img/api-gateway-alternatives-from-a-net-developer-standpoint/kong-konnect-deployment.png" alt="Kong konnect deployment" loading="lazy" />
&lt;br/>
&lt;p>EÄŸer Kong tarafÄ±ndan yÃ¶netilen bir Ã¼rÃ¼nÃ¼ kullanmak istemiyorsak, tÃ¼m sÃ¼recin kendi iÃ§ network aÄŸÄ±mÄ±z Ã¼zerinde yapÄ±lmasÄ±nÄ± istiyorsak Hybrid mod olarak isimlendirilen yÃ¶ntem ile control plane ve veritabanÄ±, data plane&amp;rsquo;den ayrÄ± olarak sistemimizin, birbiri ile iletiÅŸime geÃ§ebilecekleri farklÄ± bir konumuna deploy edilerek, data plane&amp;rsquo;i kontrol etmek iÃ§in kullanÄ±labiliyor&lt;/p>
&lt;img src="https://berkselvi.dev/img/api-gateway-alternatives-from-a-net-developer-standpoint/kong-hybrid-deployment.png" alt="Kong hybrid deployment" loading="lazy" />
&lt;br/>
&lt;p>Local olarak geliÅŸtirme yapmak iÃ§in, Kong&amp;rsquo;un sunduÄŸu Docker Compose dosyasÄ± sayesinde PostgreSQL ile beraber Ã§alÄ±ÅŸabilirsiniz ve ilk Ã§alÄ±ÅŸtÄ±rmada bu dosyadan okuma yapÄ±lÄ±r. EÄŸer Db-less modda Ã§alÄ±ÅŸacaksak, tÃ¼m route&amp;rsquo;larÄ±nÄ±zÄ± bir konfigurasyon dosyasÄ±nda tanÄ±mlamanÄ±z gerekir. AÅŸaÄŸÄ±daki gibi konfigurasyon tanÄ±mÄ±nÄ± yaptÄ±ktan sonra Docker compose dosyamÄ±z ile gatewayâ€™imizi ayaÄŸa kaldÄ±rÄ±yoruz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># kong.yaml&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># a very minimal declarative config file&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">_format_version&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;2.1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">_transform&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">services&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">weather-service&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">url&lt;/span>: &lt;span style="color:#ae81ff">http://host.docker.internal:8080&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">routes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">get-weather&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">paths&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">/weather&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># docker-compose.yml&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">kong&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">image&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;${KONG_DOCKER_TAG:-kong:latest}&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">user&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;${KONG_USER:-kong}&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">environment&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span>: &lt;span style="color:#75715e">*kong-env&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">KONG_ADMIN_ACCESS_LOG&lt;/span>: &lt;span style="color:#ae81ff">/dev/stdout&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">KONG_ADMIN_ERROR_LOG&lt;/span>: &lt;span style="color:#ae81ff">/dev/stderr&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">KONG_PROXY_LISTEN&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;${KONG_PROXY_LISTEN:-0.0.0.0:8000}&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">KONG_ADMIN_LISTEN&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;${KONG_ADMIN_LISTEN:-0.0.0.0:8001}&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">KONG_ADMIN_GUI_LISTEN&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;${KONG_ADMIN_GUI_LISTEN:-0.0.0.0:8002}&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">KONG_PROXY_ACCESS_LOG&lt;/span>: &lt;span style="color:#ae81ff">/dev/stdout&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">KONG_PROXY_ERROR_LOG&lt;/span>: &lt;span style="color:#ae81ff">/dev/stderr&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">KONG_PREFIX&lt;/span>: &lt;span style="color:#ae81ff">${KONG_PREFIX:-/var/run/kong}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">KONG_DECLARATIVE_CONFIG&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/opt/kong/kong.yaml&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">secrets&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">kong_postgres_password&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">networks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">kong-net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ports&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># The following two environment variables default to an insecure value (0.0.0.0)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># according to the CIS Security test.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;${KONG_INBOUND_PROXY_LISTEN:-0.0.0.0}:8000:8000/tcp&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;${KONG_INBOUND_SSL_PROXY_LISTEN:-0.0.0.0}:8443:8443/tcp&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Making them mandatory but undefined, like so would be backwards-breaking:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># - &amp;#34;${KONG_INBOUND_PROXY_LISTEN?Missing inbound proxy host}:8000:8000/tcp&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># - &amp;#34;${KONG_INBOUND_SSL_PROXY_LISTEN?Missing inbound proxy ssl host}:8443:8443/tcp&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Alternative is deactivating check 5.13 in the security bench, if we consider Kong&amp;#39;s own config to be enough security here&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;127.0.0.1:8001:8001/tcp&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;127.0.0.1:8444:8444/tcp&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;127.0.0.1:8002:8002/tcp&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">healthcheck&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">test&lt;/span>: [ &lt;span style="color:#e6db74">&amp;#34;CMD&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;kong&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;health&amp;#34;&lt;/span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">interval&lt;/span>: &lt;span style="color:#ae81ff">10s&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">timeout&lt;/span>: &lt;span style="color:#ae81ff">10s&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">retries&lt;/span>: &lt;span style="color:#ae81ff">10&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">restart&lt;/span>: &lt;span style="color:#66d9ef">on&lt;/span>-&lt;span style="color:#ae81ff">failure:5&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">read_only&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">kong_prefix_vol:${KONG_PREFIX:-/var/run/kong}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">kong_tmp_vol:/tmp&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./config:/opt/kong&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">security_opt&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#66d9ef">no&lt;/span>-&lt;span style="color:#ae81ff">new-privileges&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ...&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>KONG_DATABASE&lt;span style="color:#f92672">=&lt;/span>postgres docker compose --profile database up -d
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Kong ile baÅŸarÄ±lÄ± bir deployment yaptÄ±ktan sonra, belirttiÄŸiniz route ve service bilgilerine yapÄ±lan istekler yÃ¶nlendirilir. Tradational veya hybrid mod ile deployment yaptÄ±ysanÄ±z, bir admin arayÃ¼zÃ¼ Ã¼zerinden servis ve endpoint bilgilerinizi yÃ¶netebilirsiniz.&lt;/p>
&lt;img src="https://berkselvi.dev/img/api-gateway-alternatives-from-a-net-developer-standpoint/kong-admin-gui.png" alt="Kong admin gui" loading="lazy" />
&lt;br/>
&lt;h2 id="apache-apisix">Apache APISIX&lt;/h2>
&lt;p>Apache APISIX, Kong gibi OpenResty Ã¼zerine geliÅŸtirilmiÅŸ bir gateway Ã¼rÃ¼nÃ¼dÃ¼r. Ancak, Kong&amp;rsquo;un sadece enterprise versiyonunda bulunan Ã¶zellikleri open source olarak sunarak Ã¶ne Ã§Ä±kÄ±yor. Bu Ã¶zellikler arasÄ±nda GraphQL, Canary release ve secret management gibi Ã¶zellikler yer alÄ±yor.&lt;/p>
&lt;p>APISIX, yÃ¼ksek sayÄ±da route iÃ§eren sistemlerde Kong&amp;rsquo;a kÄ±yasla daha yÃ¼ksek performans sunuyor. Kong, route&amp;rsquo;lar arasÄ±nda traversal search algoritmasÄ± kullanÄ±rken, APISIX radixtree algoritmasÄ± ile arama yapar ve plugin kullanÄ±lmadÄ±ÄŸÄ±nda %140 daha yÃ¼ksek performans saÄŸlar. AyrÄ±ca, APISIX, konfigurasyonlarÄ±nÄ± depolamak iÃ§in etcd veritabanÄ±nÄ± kullanÄ±r. Bu veritabanÄ±, cloud native Ã§alÄ±ÅŸabilen ve kubernetes ortamÄ±nda yaygÄ±n olarak kullanÄ±lan bir veritabanÄ±dÄ±r.&lt;/p>
&lt;p>APISIX, Ã¼Ã§ farklÄ± deployment senaryosu sunar:&lt;/p>
&lt;ol>
&lt;li>&lt;strong>Traditional YÃ¶ntem&lt;/strong>: Control plane ve data plane aynÄ± instance iÃ§erisinde veritabanÄ±na baÄŸÄ±mlÄ± olarak deploy edilir.&lt;/li>
&lt;li>&lt;strong>Decoupled YÃ¶ntem&lt;/strong>: Control plane ve data plane farklÄ± instancelar ile deploy edilir ve sadece control plane veritabanÄ±na baÄŸÄ±mlÄ±dÄ±r.&lt;/li>
&lt;li>&lt;strong>Standalone YÃ¶ntem&lt;/strong>: VeritabanÄ± kullanmadan konfigurasyon dosyasÄ±ndan okuma yaparak Ã§alÄ±ÅŸÄ±r.&lt;/li>
&lt;/ol>
&lt;p>Local testlerimde, etcd veritabanÄ± ile traditional yÃ¶ntem kullanarak Docker Compose Ã¼zerinden deployment iÅŸlemi gerÃ§ekleÅŸtirdim. APISIX&amp;rsquo;in docker repositorysinde bulunan Docker Compose dosyasÄ±nÄ± kÃ¼Ã§Ã¼k deÄŸiÅŸiklikler yaparak kullandÄ±m. Admin key&amp;rsquo;leri kullanarak Admin API&amp;rsquo;ya istek atabiliyoruz. EÄŸer standalone yÃ¶ntemle deploy edecek olsaydÄ±m, route&amp;rsquo;larÄ± yaml dosyasÄ±nda tanÄ±mlamam gerekecekti.&lt;/p>
&lt;p>EÄŸer enterprise destek almak istenirse, APISIX&amp;rsquo;in geliÅŸtirici takÄ±mÄ± tarafÄ±ndan yÃ¼rÃ¼tÃ¼len &lt;a href="http://api7.ai/">API7&lt;/a> Ã¼zerinden destek alÄ±nabilir.&lt;/p>
&lt;p>Docker Compose dosyalarÄ±nÄ± ve kullandÄ±ÄŸÄ±m kodlarÄ± blog yazÄ±sÄ±nÄ±n sonunda paylaÅŸacaÄŸÄ±m, bÃ¶ylece siz de kendi localinizde hÄ±zlÄ±ca deneyimleyebilirsiniz.&lt;/p>
&lt;img src="https://berkselvi.dev/img/api-gateway-alternatives-from-a-net-developer-standpoint/kong-vs-apisix.png" alt="Kong vs APISIX" loading="lazy" />
&lt;br/>
&lt;p>APISIX&amp;rsquo;in performans testlerinde, 1025 milisaniye ortalama cevap sÃ¼resiyle, 1032 milisaniye ortalama cevap sÃ¼resine sahip olan Kong&amp;rsquo;dan daha performanslÄ± olduÄŸu gÃ¶rÃ¼lebiliyor. TÃ¼ketim olarak, Kong Ã§alÄ±ÅŸÄ±r Ã§alÄ±ÅŸmaz 280MB civarÄ±nda bellek kullanÄ±rken, APISIX 100MB civarÄ±nda bellek kullanmaktadÄ±r. Her iki gateway de %5-10 arasÄ±nda deÄŸiÅŸen CPU tÃ¼ketim oranÄ±na sahip.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Kong&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 280MB RAM | %5 - %10 CPU&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ab -k -n &lt;span style="color:#ae81ff">10000&lt;/span> -c &lt;span style="color:#ae81ff">50&lt;/span> http://localhost:8000/weather
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Server Software: Kestrel
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Server Hostname: localhost
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Server Port: &lt;span style="color:#ae81ff">8000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Document Path: /weather
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Document Length: &lt;span style="color:#ae81ff">14&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Concurrency Level: &lt;span style="color:#ae81ff">50&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Time taken &lt;span style="color:#66d9ef">for&lt;/span> tests: 207.499 seconds
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Complete requests: &lt;span style="color:#ae81ff">10000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Failed requests: &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Keep-Alive requests: &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Total transferred: &lt;span style="color:#ae81ff">2730028&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>HTML transferred: &lt;span style="color:#ae81ff">140000&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Requests per second: 48.19 &lt;span style="color:#f92672">[&lt;/span>&lt;span style="color:#75715e">#/sec] (mean)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Time per request: 1037.494 &lt;span style="color:#f92672">[&lt;/span>ms&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#f92672">(&lt;/span>mean&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Time per request: 20.750 &lt;span style="color:#f92672">[&lt;/span>ms&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#f92672">(&lt;/span>mean, across all concurrent requests&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Transfer rate: 12.85 &lt;span style="color:#f92672">[&lt;/span>Kbytes/sec&lt;span style="color:#f92672">]&lt;/span> received
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Connection Times &lt;span style="color:#f92672">(&lt;/span>ms&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> min mean&lt;span style="color:#f92672">[&lt;/span>+/-sd&lt;span style="color:#f92672">]&lt;/span> median max
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Connect: &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> 0.2 &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Processing: &lt;span style="color:#ae81ff">1002&lt;/span> &lt;span style="color:#ae81ff">1032&lt;/span> 120.5 &lt;span style="color:#ae81ff">1018&lt;/span> &lt;span style="color:#ae81ff">3369&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Waiting: &lt;span style="color:#ae81ff">1002&lt;/span> &lt;span style="color:#ae81ff">1031&lt;/span> 120.5 &lt;span style="color:#ae81ff">1018&lt;/span> &lt;span style="color:#ae81ff">3369&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Total: &lt;span style="color:#ae81ff">1002&lt;/span> &lt;span style="color:#ae81ff">1032&lt;/span> 120.7 &lt;span style="color:#ae81ff">1019&lt;/span> &lt;span style="color:#ae81ff">3373&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Percentage of the requests served within a certain time &lt;span style="color:#f92672">(&lt;/span>ms&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 50% &lt;span style="color:#ae81ff">1019&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 66% &lt;span style="color:#ae81ff">1023&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 75% &lt;span style="color:#ae81ff">1026&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 80% &lt;span style="color:#ae81ff">1028&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 90% &lt;span style="color:#ae81ff">1034&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 95% &lt;span style="color:#ae81ff">1043&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 98% &lt;span style="color:#ae81ff">1066&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 99% &lt;span style="color:#ae81ff">1326&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 100% &lt;span style="color:#ae81ff">3373&lt;/span> &lt;span style="color:#f92672">(&lt;/span>longest request&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># APISIX&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 100MB RAM | %5 - %10 CPU&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ab -k -n &lt;span style="color:#ae81ff">10000&lt;/span> -c &lt;span style="color:#ae81ff">50&lt;/span> http://localhost:9080/weather
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Server Software: APISIX/3.9.0
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Server Hostname: localhost
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Server Port: &lt;span style="color:#ae81ff">9090&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Document Path: /weather
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Document Length: &lt;span style="color:#ae81ff">14&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Concurrency Level: &lt;span style="color:#ae81ff">50&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Time taken &lt;span style="color:#66d9ef">for&lt;/span> tests: 206.130 seconds
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Complete requests: &lt;span style="color:#ae81ff">10000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Failed requests: &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Keep-Alive requests: &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Total transferred: &lt;span style="color:#ae81ff">1520000&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>HTML transferred: &lt;span style="color:#ae81ff">140000&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Requests per second: 48.51 &lt;span style="color:#f92672">[&lt;/span>&lt;span style="color:#75715e">#/sec] (mean)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Time per request: 1030.650 &lt;span style="color:#f92672">[&lt;/span>ms&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#f92672">(&lt;/span>mean&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Time per request: 20.613 &lt;span style="color:#f92672">[&lt;/span>ms&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#f92672">(&lt;/span>mean, across all concurrent requests&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Transfer rate: 7.20 &lt;span style="color:#f92672">[&lt;/span>Kbytes/sec&lt;span style="color:#f92672">]&lt;/span> received
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Connection Times &lt;span style="color:#f92672">(&lt;/span>ms&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> min mean&lt;span style="color:#f92672">[&lt;/span>+/-sd&lt;span style="color:#f92672">]&lt;/span> median max
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Connect: &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> 0.2 &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">7&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Processing: &lt;span style="color:#ae81ff">921&lt;/span> &lt;span style="color:#ae81ff">1025&lt;/span> 126.2 &lt;span style="color:#ae81ff">1012&lt;/span> &lt;span style="color:#ae81ff">3376&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Waiting: &lt;span style="color:#ae81ff">921&lt;/span> &lt;span style="color:#ae81ff">1024&lt;/span> 126.2 &lt;span style="color:#ae81ff">1011&lt;/span> &lt;span style="color:#ae81ff">3375&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Total: &lt;span style="color:#ae81ff">921&lt;/span> &lt;span style="color:#ae81ff">1025&lt;/span> 126.3 &lt;span style="color:#ae81ff">1012&lt;/span> &lt;span style="color:#ae81ff">3378&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Percentage of the requests served within a certain time &lt;span style="color:#f92672">(&lt;/span>ms&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 50% &lt;span style="color:#ae81ff">1012&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 66% &lt;span style="color:#ae81ff">1015&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 75% &lt;span style="color:#ae81ff">1017&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 80% &lt;span style="color:#ae81ff">1018&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 90% &lt;span style="color:#ae81ff">1023&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 95% &lt;span style="color:#ae81ff">1029&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 98% &lt;span style="color:#ae81ff">1047&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 99% &lt;span style="color:#ae81ff">1327&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 100% &lt;span style="color:#ae81ff">3378&lt;/span> &lt;span style="color:#f92672">(&lt;/span>longest request&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="go-tabanlÄ±-alternatifler">Go TabanlÄ± alternatifler&lt;/h1>
&lt;p>Go tabanlÄ± API Gateway alternatifi olarakta en Ã§ok Ã¶ne Ã§Ä±kan, KrakenD Ã¼rÃ¼nÃ¼nÃ¼ ele alacaÄŸÄ±z, ancak Go ile ikinci bir alternatif olarak Tyk veya Traefik API Gateway gibi seÃ§eneklerde tercih edilebilir, ancak bu ikiside Ã¼cretli olarak sunulduÄŸu iÃ§in deneme yapamadÄ±ÄŸÄ±mdan bu anlatÄ±mda yer veremiyorum.&lt;/p>
&lt;h2 id="krakend">KrakenD&lt;/h2>
&lt;p>KrakenD, Go ile geliÅŸtirilmiÅŸ ve hem community hem de enterprise versiyonlarÄ±na sahip bir API gateway Ã¼rÃ¼nÃ¼. 2021 yÄ±lÄ±nda Linux Foundation&amp;rsquo;a baÄŸÄ±ÅŸlanmÄ±ÅŸ olan Lura engine Ã¼zerinde Ã§alÄ±ÅŸÄ±r. DiÄŸer API gateway Ã¼rÃ¼nlerine kÄ±yasla gÃ¼Ã§lÃ¼ bir aggregation sistemi sunar. Kod yazmadan, sadece konfigurasyon dosyalarÄ± ile tÃ¼m aggregation iÅŸlemlerini gerÃ§ekleÅŸtirebilirsiniz.&lt;/p>
&lt;p>KrakenD, veritabanÄ± kullanmadÄ±ÄŸÄ± iÃ§in, deployment seÃ§enekleri arasÄ±nda karar verirken kafa karÄ±ÅŸÄ±klÄ±ÄŸÄ± yaÅŸatmaz, sadece konfigurasyon dosyalarÄ±nÄ± kullanarak iÅŸlemlerimizi gerÃ§ekleÅŸtirebiliriz. Ancak, veritabanÄ± kullanmadÄ±ÄŸÄ± iÃ§in bir admin paneli bulunmamaktadÄ±r. VeritabanÄ± olmamasÄ±, ek hata kaynaklarÄ±nÄ± ortadan kaldÄ±rÄ±r ve daha kolay Ã¶lÃ§eklenebilirlik saÄŸlar.&lt;/p>
&lt;p>TÃ¼m konfigurasyonlar, git ile takip edilebilecek bir konfigurasyon dosyasÄ± Ã¼zerinden yÃ¶netilir. JSON, YAML, TOML gibi farklÄ± dosya formatlarÄ±nÄ± destekliyor. KrakenD&amp;rsquo;nin kendi websitesindeki arayÃ¼z ile konfigurasyonlarÄ± hÄ±zlÄ±ca oluÅŸturabiliriz. Local geliÅŸtirme ortamÄ±nda, sadece konfigurasyon dosyasÄ± Ã¼zerinden Ã§alÄ±ÅŸtÄ±ÄŸÄ± iÃ§in hÄ±zlÄ±ca ayaÄŸa kaldÄ±rabilir ve servisinize istek atabiliriz. Hot reload Ã¶zelliÄŸi ile kÄ±sa bir downtime ile konfigurasyon dosyasÄ±nÄ± gÃ¼ncelleyebilirsiniz. Ancak, production ortamlarÄ±nda bu yÃ¶ntem Ã¶nerilmez, GitOps yÃ¶ntemleri ile yeni bir release almanÄ±z tavsiye edilir. Enterprise versiyonunda OpenAPI importer ve exporter, gzip sÄ±kÄ±ÅŸtÄ±rma ve response validation gibi ek Ã¶zellikler bulunur.&lt;/p>
&lt;img src="https://berkselvi.dev/img/api-gateway-alternatives-from-a-net-developer-standpoint/krakend-designer.png" alt="KrakenD designer" loading="lazy" />
&lt;br/>
&lt;p>KrakenD, Kong ve APISIX&amp;rsquo;ten Ã§ok daha basit bir Docker Compose iÃ§eriÄŸine sahiptir, Ã§Ã¼nkÃ¼ herhangi bir ek baÄŸÄ±mlÄ±lÄ±ÄŸÄ± yoktur. Sadece konfigurasyon dosyasÄ±nÄ±n path&amp;rsquo;ini volume olarak vermeniz yeterlidir. Ã–rnek olmasÄ± aÃ§Ä±sÄ±ndan weather servisini Docker Compose iÃ§erisine ekledim ve krakend.json dosyasÄ±nÄ± hÄ±zlÄ±ca oluÅŸturarak servisi ayaÄŸa kaldÄ±rdÄ±m. Performans testinde Ã§ok iyi sonuÃ§lar verdi.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// krakend.json
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;$schema&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;https://www.krakend.io/schema/krakend.json&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;version&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">3&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;name&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;KrakenD - API Gateway&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;timeout&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;3000ms&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;cache_ttl&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;300s&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;output_encoding&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;json&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;port&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">9090&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;endpoints&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;endpoint&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/weather&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;method&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;GET&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;output_encoding&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;string&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;backend&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;url_pattern&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/weather&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;encoding&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;string&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;sd&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;static&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;method&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;GET&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;host&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;http://service:8080&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;disable_host_sanitize&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># docker-compose.yml&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">version&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;3&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">services&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">krakend&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">image&lt;/span>: &lt;span style="color:#ae81ff">devopsfaith/krakend&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ports&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">9090&lt;/span>:&lt;span style="color:#ae81ff">9090&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./krakend.json:/etc/krakend/krakend.json&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">networks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">krakend-net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">weather-service&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">container_name&lt;/span>: &lt;span style="color:#ae81ff">service&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">build&lt;/span>: &lt;span style="color:#ae81ff">../service/Service.API&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">networks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">krakend-net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ports&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;8080:8080&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">networks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">krakend-net&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">external&lt;/span>: &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>KrakenD, kendi websitesinde de belirttiÄŸi gibi, Kong ve APISIX&amp;rsquo;ten daha hÄ±zlÄ± Ã§alÄ±ÅŸÄ±yor. Benzer test sonuÃ§larÄ±nda, Kong ortalama 1032 milisaniye, APISIX ortalama 1025 milisaniye ile cevap verirken, KrakenD ortalama 1024 milisaniye ile en iyi performansÄ± sunuyor. CPU tÃ¼ketimi %4-6 civarÄ±nda sabit kalÄ±rken en yÃ¼ksek 30MB memory tÃ¼ketiyor. Bu sonuÃ§lar, KrakenD&amp;rsquo;nin diÄŸer rakiplerinden daha az kaynak tÃ¼kettiÄŸini ve buna raÄŸmen daha hÄ±zlÄ± olduÄŸunu gÃ¶steriyor.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># KrakenD&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 30MB RAM | %4 - %6 CPU&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ab -k -n &lt;span style="color:#ae81ff">10000&lt;/span> -c &lt;span style="color:#ae81ff">50&lt;/span> http://localhost:9090/weather
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Server Software:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Server Hostname: localhost
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Server Port: &lt;span style="color:#ae81ff">9090&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Document Path: /weather
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Document Length: &lt;span style="color:#ae81ff">14&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Concurrency Level: &lt;span style="color:#ae81ff">50&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Time taken &lt;span style="color:#66d9ef">for&lt;/span> tests: 206.359 seconds
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Complete requests: &lt;span style="color:#ae81ff">10000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Failed requests: &lt;span style="color:#ae81ff">9&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">(&lt;/span>Connect: 0, Receive: 0, Length: 9, Exceptions: 0&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Non-2xx responses: &lt;span style="color:#ae81ff">9&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Keep-Alive requests: &lt;span style="color:#ae81ff">10000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Total transferred: &lt;span style="color:#ae81ff">2439352&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>HTML transferred: &lt;span style="color:#ae81ff">139874&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Requests per second: 48.46 &lt;span style="color:#f92672">[&lt;/span>&lt;span style="color:#75715e">#/sec] (mean)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Time per request: 1031.795 &lt;span style="color:#f92672">[&lt;/span>ms&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#f92672">(&lt;/span>mean&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Time per request: 20.636 &lt;span style="color:#f92672">[&lt;/span>ms&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#f92672">(&lt;/span>mean, across all concurrent requests&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Transfer rate: 11.54 &lt;span style="color:#f92672">[&lt;/span>Kbytes/sec&lt;span style="color:#f92672">]&lt;/span> received
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Connection Times &lt;span style="color:#f92672">(&lt;/span>ms&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> min mean&lt;span style="color:#f92672">[&lt;/span>+/-sd&lt;span style="color:#f92672">]&lt;/span> median max
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Connect: &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> 0.1 &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">3&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Processing: &lt;span style="color:#ae81ff">1000&lt;/span> &lt;span style="color:#ae81ff">1024&lt;/span> 122.7 &lt;span style="color:#ae81ff">1010&lt;/span> &lt;span style="color:#ae81ff">3021&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Waiting: &lt;span style="color:#ae81ff">1000&lt;/span> &lt;span style="color:#ae81ff">1024&lt;/span> 122.7 &lt;span style="color:#ae81ff">1010&lt;/span> &lt;span style="color:#ae81ff">3021&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Total: &lt;span style="color:#ae81ff">1000&lt;/span> &lt;span style="color:#ae81ff">1024&lt;/span> 122.8 &lt;span style="color:#ae81ff">1010&lt;/span> &lt;span style="color:#ae81ff">3023&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Percentage of the requests served within a certain time &lt;span style="color:#f92672">(&lt;/span>ms&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 50% &lt;span style="color:#ae81ff">1010&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 66% &lt;span style="color:#ae81ff">1012&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 75% &lt;span style="color:#ae81ff">1013&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 80% &lt;span style="color:#ae81ff">1015&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 90% &lt;span style="color:#ae81ff">1018&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 95% &lt;span style="color:#ae81ff">1023&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 98% &lt;span style="color:#ae81ff">1037&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 99% &lt;span style="color:#ae81ff">1520&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 100% &lt;span style="color:#ae81ff">3023&lt;/span> &lt;span style="color:#f92672">(&lt;/span>longest request&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="sonuÃ§">SonuÃ§&lt;/h2>
&lt;p>Ä°ncelediÄŸimiz 5 API gateway Ã¼rÃ¼nÃ¼nÃ¼ karÅŸÄ±laÅŸtÄ±rmak iÃ§in aÅŸaÄŸÄ±daki gibi bir tablo hazÄ±rladÄ±m. Bu tablo, sunumun iÃ§eriÄŸin Ã¶zetini oluÅŸturuyor ve araÅŸtÄ±rmalarÄ±m sonucunda birkaÃ§ Ã¶nemli noktayÄ± vurgulamak istiyorum.&lt;/p>
&lt;h3 id="kong-ve-apisix">&lt;strong>Kong ve APISIX&lt;/strong>&lt;/h3>
&lt;p>EÄŸer farklÄ± projelere sahip takÄ±mlar, tek bir API gateway Ã¼zerinden internete aÃ§Ä±lacaksa ve canlÄ± olarak gÃ¼ncellenebilen bir admin arayÃ¼zÃ¼ne ihtiyaÃ§ duyuyorsa, Kong veya APISIX tercih edilebilir. Her iki gateway de gÃ¼Ã§lÃ¼ Ã¶zelliklere sahip ve geniÅŸletilebilir yapÄ±larÄ± ile Ã¶ne Ã§Ä±kÄ±yorlar. AyrÄ±ca, admin arayÃ¼zÃ¼ sayesinde, konfigurasyonlarÄ± yÃ¶netmek ve gÃ¼ncellemeleri canlÄ± olarak yapmak mÃ¼mkÃ¼n.&lt;/p>
&lt;h3 id="krakend-1">&lt;strong>KrakenD&lt;/strong>&lt;/h3>
&lt;p>EÄŸer API gateway projesi, takÄ±mlarÄ±n ortak sorumluluÄŸunda ise ve geliÅŸtiriciler konfigurasyon dosyasÄ±nÄ± gÃ¼ncelleyip pipeline Ã§alÄ±ÅŸtÄ±rabilirlerse, yÃ¼ksek performans ve dÃ¼ÅŸÃ¼k kaynak tÃ¼ketimi hedeflenen durumlarda, KrakenD iyi bir seÃ§im olabilir. KrakenD, Go ile geliÅŸtirilmiÅŸ olup, gÃ¼Ã§lÃ¼ bir aggregation sistemi sunar ve veritabanÄ± kullanmadÄ±ÄŸÄ± iÃ§in daha kolay Ã¶lÃ§eklenebilir.&lt;/p>
&lt;h3 id="ocelot-ve-yarp">&lt;strong>Ocelot ve YARP&lt;/strong>&lt;/h3>
&lt;p>Performans ve kaynak tÃ¼ketimi kritik deÄŸilse ve aÅŸina olduÄŸumuz bir teknoloji yeterliyse, .NET tabanlÄ± Ocelot veya YARP ile yolumuza devam edebiliriz. Bu araÃ§lar, benzer Ã¶zellikleri farklÄ± ÅŸekillerde destekliyorlar ve .NET ekosistemine entegrasyonlarÄ± kolaydÄ±r.&lt;/p>
&lt;h3 id="diÄŸer-kriterler">&lt;strong>DiÄŸer Kriterler&lt;/strong>&lt;/h3>
&lt;ul>
&lt;li>&lt;strong>Deployment YÃ¶ntemleri&lt;/strong>: Hangi gatewayâ€™in nasÄ±l deploy edileceÄŸi, konfigurasyon dosyalarÄ±nÄ±n yapÄ±sÄ± ve dÃ¼zenlenebilirliÄŸi Ã¶nemlidir.&lt;/li>
&lt;li>&lt;strong>Community ve Enterprise DesteÄŸi&lt;/strong>: Gateway&amp;rsquo;in ne kadar geniÅŸ bir kullanÄ±cÄ± kitlesine sahip olduÄŸu ve destek alabileceÄŸimiz kaynaklarÄ±n bulunup bulunmadÄ±ÄŸÄ± da karar verirken gÃ¶z Ã¶nÃ¼nde bulundurulmalÄ±dÄ±r.&lt;/li>
&lt;/ul>
&lt;p>TÃ¼m ihtiyaÃ§larÄ±mÄ±za tek baÅŸÄ±na kusursuz bir Ã§Ã¶zÃ¼m sunacak bir Ã¼rÃ¼n maalesef yok. Bu nedenle, kendi ihtiyaÃ§larÄ±mÄ±zÄ± deÄŸerlendirerek, seÃ§eceÄŸimiz aracÄ±n Ã¶zelliklerine gÃ¶re karar vermeliyiz. DoÄŸru API gateway seÃ§imi, projenizin baÅŸarÄ±sÄ± iÃ§in kritik bir adÄ±mdÄ±r ve ihtiyaÃ§larÄ±nÄ±za en uygun olanÄ± tercih etmek her zaman en iyi yaklaÅŸÄ±mdÄ±r.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Feature&lt;/th>
&lt;th>YARP&lt;/th>
&lt;th>Ocelot&lt;/th>
&lt;th>Kong&lt;/th>
&lt;th>APISIX&lt;/th>
&lt;th>KrakenD&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Request aggregation&lt;/td>
&lt;td>NO&lt;/td>
&lt;td>Simple, can be done with configuration&lt;/td>
&lt;td>NO&lt;/td>
&lt;td>YES&lt;/td>
&lt;td>Powerful,, can be done with configuration&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>OAuth &amp;amp; OpenID&lt;/td>
&lt;td>YES&lt;/td>
&lt;td>YES&lt;/td>
&lt;td>YES&lt;/td>
&lt;td>YES&lt;/td>
&lt;td>YES&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Request validation&lt;/td>
&lt;td>Needs custom logic&lt;/td>
&lt;td>Needs custom logic&lt;/td>
&lt;td>Comes with enterprise&lt;/td>
&lt;td>YES&lt;/td>
&lt;td>YES&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>HTTP to gRPC&lt;/td>
&lt;td>YES&lt;/td>
&lt;td>NO&lt;/td>
&lt;td>YES&lt;/td>
&lt;td>YES&lt;/td>
&lt;td>YES&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Websocket&lt;/td>
&lt;td>YES&lt;/td>
&lt;td>YES&lt;/td>
&lt;td>?&lt;/td>
&lt;td>YES&lt;/td>
&lt;td>Comes with enterprise&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>State&lt;/td>
&lt;td>File&lt;/td>
&lt;td>File&lt;/td>
&lt;td>File, PostgreSQL, Cassandra, Redis, InfluxDB, Kafka&lt;/td>
&lt;td>File, etcd&lt;/td>
&lt;td>File&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Plugin&lt;/td>
&lt;td>C#&lt;/td>
&lt;td>C#&lt;/td>
&lt;td>&lt;strong>Native&lt;/strong>: Lua &amp;amp; &lt;strong>IPC&lt;/strong>: Go, Javascript, Python &amp;amp; &lt;strong>WASM&lt;/strong>: Go, Rust vs.&lt;/td>
&lt;td>&lt;strong>Native&lt;/strong>: Lua &amp;amp; &lt;strong>IPC&lt;/strong>: Go, Javascript, Python &amp;amp; &lt;strong>WASM&lt;/strong>: Go, Rust vs.&lt;/td>
&lt;td>Go &amp;amp; Lua&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Performance&lt;/td>
&lt;td>&lt;strong>Mean response&lt;/strong>: 1029ms, &lt;strong>Memory&lt;/strong>: 100MB, &lt;strong>CPU&lt;/strong>: %10 - %20&lt;/td>
&lt;td>&lt;strong>Mean response&lt;/strong>: 1030ms, &lt;strong>Memory&lt;/strong>: 100MB, &lt;strong>CPU&lt;/strong>: %10 - %20&lt;/td>
&lt;td>&lt;strong>Mean response&lt;/strong>: 1035ms, &lt;strong>Memory&lt;/strong>: 280MB, &lt;strong>CPU&lt;/strong>: %5 - %10&lt;/td>
&lt;td>&lt;strong>Mean response&lt;/strong>: 1025ms, &lt;strong>Memory&lt;/strong>: 100MB &lt;strong>CPU&lt;/strong>: %5 - %10&lt;/td>
&lt;td>&lt;strong>Mean response&lt;/strong>: 1024ms, &lt;strong>Memory&lt;/strong>: 30MB, &lt;strong>CPU&lt;/strong>: %4 - %6&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>Kaynak koduna eriÅŸmek isterseniz projenin tamamÄ±nÄ± GitHub hesabÄ±mda bulabilirsiniz:&lt;/p>
&lt;p>&lt;a href="https://github.com/berkslv/lecture-api-gateway-comparison">GitHub - berkslv/lecture-api-gateway-comparison&lt;/a>&lt;/p>
&lt;hr>
&lt;h2 id="sonuÃ§-1">SonuÃ§&lt;/h2>
&lt;p>OkuduÄŸunuz iÃ§in teÅŸekkÃ¼rler! ðŸŽ‰ YazÄ±lÄ±m geliÅŸtirme alanÄ±ndaki araÅŸtÄ±rmalarÄ±mÄ± kaÃ§Ä±rmamak iÃ§in &lt;a href="https://x.com/berkslv">@berkslv&lt;/a> adresinden takipte kalabilirsiniz.&lt;/p></content></item><item><title>RSA ile JavaScript'te Åžifreleme ve .NET'te Åžifre Ã‡Ã¶zme NasÄ±l YapÄ±lÄ±r</title><link>https://berkselvi.dev/tr/posts/how-to-use-rsa-for-encryption-in-javascript-and-decryption-in-net/</link><pubDate>Thu, 07 Mar 2024 00:00:00 +0300</pubDate><guid>https://berkselvi.dev/tr/posts/how-to-use-rsa-for-encryption-in-javascript-and-decryption-in-net/</guid><description>&lt;p>Dijital dÃ¼nyada, farklÄ± sistemler arasÄ±ndaki iletiÅŸimin gÃ¼vence altÄ±na alÄ±nmasÄ± Ã§ok Ã¶nemlidir. RSA ÅŸifreleme, iki adet anahtar kullanarak ÅŸifreleme ve ÅŸifre Ã§Ã¶zme iÃ§in saÄŸlam bir yol saÄŸlar. Ã–te yandan, AES gibi simetrik ÅŸifreleme algoritmalarÄ±, ÅŸifreleme ve ÅŸifre Ã§Ã¶zme iÃ§in tek bir anahtar kullanÄ±r. Bu nedenlerle, anahtarÄ± halka aÃ§Ä±k olarak kullanmak ve hatta bir saldÄ±rganÄ±n eline geÃ§se bile sorunlarÄ± Ã¶nlemek iÃ§in asimetrik ÅŸifreleme algoritmalarÄ±ndan olan RSA tercih edilebilir.&lt;/p>
&lt;p>Bu blog yazÄ±sÄ±nda, OpenSSL ile RSA anahtar oluÅŸturmayÄ±, JavaScript&amp;rsquo;te ÅŸifrelemeyi ve .NET&amp;rsquo;te ÅŸifre Ã§Ã¶zmeyi, bir frontend uygulamasÄ± ile bir backend servisi arasÄ±nda gÃ¼venli veri alÄ±ÅŸveriÅŸi saÄŸlayacak uygulamayÄ± ele alacaÄŸÄ±m.&lt;/p></description><content>&lt;p>Dijital dÃ¼nyada, farklÄ± sistemler arasÄ±ndaki iletiÅŸimin gÃ¼vence altÄ±na alÄ±nmasÄ± Ã§ok Ã¶nemlidir. RSA ÅŸifreleme, iki adet anahtar kullanarak ÅŸifreleme ve ÅŸifre Ã§Ã¶zme iÃ§in saÄŸlam bir yol saÄŸlar. Ã–te yandan, AES gibi simetrik ÅŸifreleme algoritmalarÄ±, ÅŸifreleme ve ÅŸifre Ã§Ã¶zme iÃ§in tek bir anahtar kullanÄ±r. Bu nedenlerle, anahtarÄ± halka aÃ§Ä±k olarak kullanmak ve hatta bir saldÄ±rganÄ±n eline geÃ§se bile sorunlarÄ± Ã¶nlemek iÃ§in asimetrik ÅŸifreleme algoritmalarÄ±ndan olan RSA tercih edilebilir.&lt;/p>
&lt;p>Bu blog yazÄ±sÄ±nda, OpenSSL ile RSA anahtar oluÅŸturmayÄ±, JavaScript&amp;rsquo;te ÅŸifrelemeyi ve .NET&amp;rsquo;te ÅŸifre Ã§Ã¶zmeyi, bir frontend uygulamasÄ± ile bir backend servisi arasÄ±nda gÃ¼venli veri alÄ±ÅŸveriÅŸi saÄŸlayacak uygulamayÄ± ele alacaÄŸÄ±m.&lt;/p>
&lt;h2 id="understanding-rsa-encryption">Understanding RSA Encryption&lt;/h2>
&lt;p>RSA (Rivest-Shamir-Adleman), gÃ¼venli veri iletimi iÃ§in yaygÄ±n olarak kullanÄ±lan ilk aÃ§Ä±k anahtarlÄ± kriptosistemlerden biridir. Ä°ki anahtarÄ± iÃ§erir: aÃ§Ä±k anahtar, mesajlarÄ± ÅŸifrelemek iÃ§in aÃ§Ä±kÃ§a paylaÅŸÄ±labilen ve onlarÄ± ÅŸifrelemek iÃ§in gizli tutulmasÄ± gereken bir Ã¶zel anahtar. RSA&amp;rsquo;nÄ±n gÃ¼cÃ¼, iki bÃ¼yÃ¼k asal sayÄ±nÄ±n Ã§arpÄ±mÄ±nÄ± faktÃ¶rleme zorluÄŸunda yatar, bu da gÃ¼venliÄŸini destekler.&lt;/p>
&lt;h2 id="generation-of-publicprivate-key-pairs-with-openssl">Generation of Public/Private key pairs with OpenSSL&lt;/h2>
&lt;p>RSA ÅŸifreleme ve ÅŸifre Ã§Ã¶zmenin uygulanmasÄ±ndaki temel adÄ±mlardan biri, aÃ§Ä±k ve Ã¶zel anahtar Ã§iftlerinin oluÅŸturulmasÄ±dÄ±r. OpenSSL, kriptografi iÃ§in saÄŸlam bir aÃ§Ä±k kaynaklÄ± araÃ§ olan bu anahtarlarÄ± oluÅŸturmanÄ±n basit bir yolunu sunar. Ancak, bu adÄ±m isteÄŸe baÄŸlÄ±dÄ±r. .NET kÃ¼tÃ¼phaneleri baÅŸarÄ±lÄ± bir ÅŸekilde RSA anahtarlarÄ± oluÅŸturur. Ancak, bu gibi aÃ§Ä±k kaynaklÄ± araÃ§larÄ± kullanmak bize standartlarÄ±n gÃ¼vencesini saÄŸlar. Bu bÃ¶lÃ¼m, OpenSSL&amp;rsquo;i kullanarak RSA aÃ§Ä±k/Ã¶zel anahtar Ã§ifti oluÅŸturma sÃ¼recini adÄ±m adÄ±m ele alacaktÄ±r.&lt;/p>
&lt;p>Private anahtar oluÅŸturma iÅŸlemiyle baÅŸlayabiliriz:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ openssl genrsa -out privatekey.pem &lt;span style="color:#ae81ff">2048&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ cat privatekey.pem
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>-----BEGIN PRIVATE KEY-----
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDuOitcIPd5UpGN
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/4GEwNhc4fAmGP6fREJJk/byRgiLiWcyXwdoPwXdXjKSjkSIcETdz/hLAlb6+zNY
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Gi4Ap0S5flZSRiKh60xWRA4vZVgsLqhEi2IsclSlWu3R7KD5dkBGsyf5xlCfNSs4
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>DbYYMgrXXZxXQ0c4qCikpnEB6OpqSzm19Cwrdq9GwophoAPxnf00d7S+y5QpRa+l
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Ca70xQ42FxBpMuK76a1g6i+JtmPgTYqXZ0FCMnUEzBq+u3N8LKoNzcSNdrLgvmHQ
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>oOLFA/9BPe34YgLxoCUi+HhEiLSnvgz/Kn1yprvsz37baYizU/YWFG8s80SPmFsY
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>JARxvZiJAgMBAAECggEAEboc42Jln+7Lu34NmIAUKZc7fE5EVjwpVZnP2Lfq510+
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Y2JsZe64pEAf8cVp5qA6E6pn3scKC2uZZr8t+Kj5xXbX/A/RgGyGte2jA5ZeQQ1o
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>wo7/q3CHiXVyeHpMATwyLMCkoyLFeY9mi6mDiRniMiP6YAj22gmzWoszIhH/rZCO
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>NjdpWRsIkFp8jIiyRhhoaBoJtZ1qV3twk8HH590rgjS7QUGJWK9uUsi5SDh69MsR
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>r/SJ00gTMYFozFd6dB29aKj/p8fSk6qzh2noxU37AuiVc1A2H8Z6SAfRUDSvPkxA
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>FdqVr62iLWmypBX2VYQ2p1pH1N0v8oG7NTxtrxgRTQKBgQD3YdxKNT0dWZJRGPFC
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>DIRZVn86UgDAHRw29aToLARnepE5XOrLSmlGMqbK8vzRyUnlctJyG7x5ure2BMp4
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>gKSLuhz48n7ZvpHyCVnNsqqkc21iM/whL/yKiI11Jz5koXmRDltz9IioQH/PwXvD
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>RJbjxISHjG5YEKlVmztWtTup/QKBgQD2hqouE8JLePAUzK3SlfgVTlmaHDUeJev4
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>u95RWPnMNOOwLUWbGYiKBoJ8uc2nSHmxIvEvEPGNwafR6etf0YocpwDfF5pnPDjk
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>yA4hOdZrCyYa/UDqkB5pHTOZj5iVct1hBNbiANz6kL7Pl+H221U+HxD9rhaDPDez
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>gdYPhLF4fQKBgQCdi2QomlkufOHS5eiXoLMU1iI2eQzjTGawlaYM+iNf503fU05w
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>YxZCT3WroC3kSKXYC1T8uK9CcugWclyje4HPPpq+7GhesZ/unYfkmRlVm/EYbnTu
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>icnyS96Ssohou/FYsOULJrt1M4ZyQA1aoS7bJUclsAiB6zJ8Q1z57ndt3QKBgEwa
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>9p6S6wBxrWw+Y8sHETdCoNa6rotIGbkIBnIGjddE3KWe1EY1c7lomQ/4LEzgSvEs
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>YFivWmLwzeY32LoT7hc6V0KH/tqv9MBsIjCPsmoJXxIl7Mx9AWZh5XQaqHg6pa01
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>2UCcE5wm40EjGlcjDwXGgXBPNhP9mxSHmJXh2QfhAoGANouUrF3qv8ofb1HGrUXx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>DO/WkGMzwbkNmwwdgcGYVsGr3Dv/zx1y3TJEvqNh0ViVgmfdYveCo3VrSawq890U
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>GJZXld2KFE1icEJpNoURkM9okZMzTDIMs+r4vq5Or2jB04mMuoCbG6rjfqUMtkll
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>oAIFOSKH+F3TrXjNgy4/juo&lt;span style="color:#f92672">=&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>-----END PRIVATE KEY-----
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>BaÅŸarÄ±yla private anahtarÄ± oluÅŸturduktan sonra, oluÅŸturduÄŸumuz private anahtar ile public anahtarÄ± oluÅŸturabiliriz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ openssl rsa -in privatekey.pem -outform PEM -pubout -out publickey.pem
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ cat privatekey.pem
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>-----BEGIN PUBLIC KEY-----
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA7jorXCD3eVKRjf+BhMDY
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>XOHwJhj+n0RCSZP28kYIi4lnMl8HaD8F3V4yko5EiHBE3c/4SwJW+vszWBouAKdE
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>uX5WUkYioetMVkQOL2VYLC6oRItiLHJUpVrt0eyg+XZARrMn+cZQnzUrOA22GDIK
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>112cV0NHOKgopKZxAejqaks5tfQsK3avRsKKYaAD8Z39NHe0vsuUKUWvpQmu9MUO
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>NhcQaTLiu+mtYOovibZj4E2Kl2dBQjJ1BMwavrtzfCyqDc3EjXay4L5h0KDixQP/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>QT3t+GIC8aAlIvh4RIi0p74M/yp9cqa77M9+22mIs1P2FhRvLPNEj5hbGCQEcb2Y
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>iQIDAQAB
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>-----END PUBLIC KEY-----
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="setting-up-the-environment-for-net-rsa-decryption">Setting Up the Environment for .NET RSA Decryption&lt;/h2>
&lt;p>.NET ÅŸifre Ã§Ã¶zme iÃ§in .NET 8&amp;rsquo;i kullanacaÄŸÄ±m ve System.Security.Cryptography ad alanÄ±nÄ±ndan faydalanacaÄŸÄ±m. RSA ÅŸifre Ã§Ã¶zme iÃ§in baÅŸka bir nuget paketine ihtiyacÄ±mÄ±z yoktur, bunun iÃ§in ÅŸÃ¶yle bir Helper sÄ±nÄ±f oluÅŸturdum.&lt;/p>
&lt;p>RsaKey&amp;rsquo;i appsettings.json dosyasÄ±ndan okuyoruz. RsaKey alanÄ±nda yeni satÄ±rlar iÃ§in \n eklemeniz gerekir. Bu anahtarÄ± appsettings.json dosyasÄ±na koyduk Ã§Ã¼nkÃ¼ her istekte aynÄ± anahtarÄ± kullanmak istiyoruz. Ancak .NET kÃ¼tÃ¼phanesinin sorumluluÄŸuna bÄ±rakÄ±rsanÄ±z, her baÅŸlangÄ±Ã§ta yeni bir anahtar oluÅŸturulacaktÄ±r.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// appsettings.json
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Logging&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;LogLevel&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Default&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;Information&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Microsoft.AspNetCore&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;Warning&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;AllowedHosts&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;*&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;RsaKey&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;-----BEGIN PRIVATE KEY-----\nMIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQCuan+y++Eqc2Vx3QIt9gv0r6rzfcxpsBRubcWCmI+8tqb40oflv5dViPSiCSWNgg5xKk7K8WTeEQQ6NDg1IJ2OwoQ2dfzat5qlpfV9EeF3u8iTY/hyQaaYFwB77cV9t5Czb8oG/+IIOByorJVds9tAoKjssKUZ3W9IU7ffElZjZrbjoiy/H4z8u9fOq8IL9Zf3pHgzv2FxF4BPJamqr4s1VtMqGJ5g18wV1OD9gcz9pJOHHUVieZ0+xP4WD4+1wCv/uwEgIcqmEs0os6birHZL1X/CSqBSPc8e/+kkZyyzoF+MBWPzvAwmW32alIxz2ZV0Z+jJtoOrh/qVqbrGAf+RAgMBAAECggEAEWYu4IJHg0ZZOZtgRwj7RtjKXzluraFi3GRHdoB1IFCBRiOsamMrO91qeAqdDCmL+saLbyvXEd8VMqA4djZPeWkWqt8ozwHPY9RzMZuZyCm7t9Zad71sWtI6mmJNF/46qWfOudWHbSX51+rFiMAzMFaGm3wAsFyaaBbv6gkohIhVrrMvpIuV8X8JNI8/VNlOR6vExHd/3uWKi8vPrFEFTNQ1UE+WJDkVojcmx0t63jlP8C/O4ofaJeCYRkAaM9+FXnM+jVNf0qZU+3JGYmy1R/B7L+LyrbG2uYTaBa1Ba9zGsXD1HQ4dctK+MltBd4p+MWgHAQV+xuVmGGDkylpb8QKBgQDP9zY4UzLmnt0werJF9SGmAJU51Y/+gannUC/+XYqnK/NA5iUDR86rlYCJbqQCceyMYJSYuePumygWOVL9rHnu1/fTMG/sXnRktmTSFemgeCYfPyn8/KeZKn6E5xw8GbtfLJLA8uM4DakDf9vSpilKDYT4UbZyKgq7/yodPXbgCQKBgQDWs4gL4yOtDLAY/OQKZvoyXClapldkVFRzf97pBJQGLYfdTzkVFviWsgI/yrA+t5tlzaWtZieuv2KsSmazVyO2W5ei9HILx4yRFK7K56OM5o7wqjN62ZmF0R+422YNaAyqYAd9nhLjgdsrmZ9FTxhQ91asBSH1AO3j6xaZUvh1SQKBgAZuo/ur/xgI89hrAxaM1WSYAgWO6Gw7wHCKF2HrrL0s69InDCAE2YyPDDGz/ViiA2n4FsB+h2E65UuCrGFyMzdC8MRUbDHIXhs7VPT2fopbDPrMblUHz3s6SD1+FG57cUMpUsSq/oIeUgrsqnTidMZ4kpNHm7f+OuTDqJ7M5t9ZAoGAAfm2570YR/BU8nXpNztJVAtLCh17sl2gRUvI5kX3grMKi/u9n7cNZH2Qzbt0sa8Iy///ZUAKX249Xy50EXRczMG8/G/ZWMhmP7N8BDvrYlGAwTAftyKnafbJnu7N2pO5ghvOFdbNf7BjLtyD/aRDqgMMlhqZ/GIczjsMgy6jQJkCgYATxkjdW/mnWLDDZAYm1V10Gnm7YDMwX3gKdhpoYleeeapZiDlurkR3YAEvQezcnhv3NpjaKQtF1/3Q0fZJ0wBc5FflaevHRjHTa0IrU5QIa48dLDx+jxn+cUCFx9kirkb7JcfJLZWtToPMLfCZt324P2ogZgWBwweVPiz1/voEXw==\n-----END PRIVATE KEY-----&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cs" data-lang="cs">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Helpers/RsaEncryptionHelper.cs &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">RsaEncryptionHelper&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">readonly&lt;/span> RSA _rsa = RSA.Create();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> RsaEncryptionHelper(IConfiguration configuration)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> privateKeyPem = configuration[&lt;span style="color:#e6db74">&amp;#34;RsaKey&amp;#34;&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#66d9ef">string&lt;/span>.IsNullOrEmpty(privateKeyPem)) &lt;span style="color:#66d9ef">throw&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> ArgumentNullException(nameof(privateKeyPem));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ImportKey(privateKeyPem);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">void&lt;/span> ImportKey(&lt;span style="color:#66d9ef">string&lt;/span> privateKey)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _rsa.ImportFromPem(privateKey.ToCharArray());
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span> GetPublicKey()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> publicKey = _rsa.ExportSubjectPublicKeyInfoPem();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> publicKey;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span> GetPrivateKey()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> privateKey = _rsa.ExportPkcs8PrivateKeyPem();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> privateKey;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span> Encrypt(&lt;span style="color:#66d9ef">string&lt;/span> data)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> dataBytes = Encoding.UTF8.GetBytes(data);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> encryptedData = _rsa.Encrypt(dataBytes, RSAEncryptionPadding.OaepSHA256);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> Convert.ToBase64String(encryptedData);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span> Decrypt(&lt;span style="color:#66d9ef">string&lt;/span> data)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> dataBytes = Convert.FromBase64String(data);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> decryptedData = _rsa.Decrypt(dataBytes, RSAEncryptionPadding.OaepSHA256);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> Encoding.UTF8.GetString(decryptedData);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ve bu helper sÄ±nÄ±fÄ± EncryptionController iÃ§inde kullanarak helper sÄ±nÄ±fÄ±n methodlarÄ±nÄ± kullanÄ±n. Production ortamlarÄ±nda, PrivateKey&amp;rsquo;in kimseye aÃ§Ä±ÄŸa Ã§Ä±karÄ±lmamasÄ± gerekir. Bu gizli tutulmalÄ±dÄ±r.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cs" data-lang="cs">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Controllers/EncryptionController.cs &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">[ApiController]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">[Route(&amp;#34;api/[controller]&lt;/span>&lt;span style="color:#e6db74">&amp;#34;)]
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&lt;/span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">EncryptionController&lt;/span> : ControllerBase
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">readonly&lt;/span> RsaEncryptionHelper _rsaEncryptionHelper;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> EncryptionController(RsaEncryptionHelper rsaEncryptionHelper)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _rsaEncryptionHelper = rsaEncryptionHelper;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e"> [HttpPost(&amp;#34;Encrypt&amp;#34;)]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span> Encrypt([FromBody] EncryptionRequest request)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> _rsaEncryptionHelper.Encrypt(request.Data);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e"> [HttpPost(&amp;#34;Decrypt&amp;#34;)]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span> Decrypt([FromBody] EncryptionRequest request)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> _rsaEncryptionHelper.Decrypt(request.Data);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e"> [HttpGet(&amp;#34;PublicKey&amp;#34;)]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span> PublicKey()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> _rsaEncryptionHelper.GetPublicKey();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e"> [HttpGet(&amp;#34;PrivateKey&amp;#34;)]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span> PrivateKey()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> _rsaEncryptionHelper.GetPrivateKey();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e"> [HttpPost(&amp;#34;ImportKey&amp;#34;)]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">void&lt;/span> ImportKey([FromBody] ImportKeyRequest request)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _rsaEncryptionHelper.ImportKey(request.PrivateKey);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">record&lt;/span> &lt;span style="color:#a6e22e">ImportKeyRequest&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span> PrivateKey { &lt;span style="color:#66d9ef">get&lt;/span>; &lt;span style="color:#66d9ef">init&lt;/span>; } = &lt;span style="color:#66d9ef">null&lt;/span>!;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">record&lt;/span> &lt;span style="color:#a6e22e">EncryptionRequest&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span> Data { &lt;span style="color:#66d9ef">get&lt;/span>; &lt;span style="color:#66d9ef">init&lt;/span>; } = &lt;span style="color:#66d9ef">null&lt;/span>!;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Bu backend tarafÄ±nda yaptÄ±ÄŸÄ±mÄ±z geliÅŸtirmelerden sonra JavaScript tarafÄ±na geÃ§erek devam edebiliriz. YaptÄ±klarÄ±mÄ±z sayesinde, public anahtarÄ±mÄ±zÄ± istemciyle endpoint&amp;rsquo;ten paylaÅŸabiliriz, ardÄ±ndan istemciler bu public anahtarÄ± kullanarak verilerini gÃ¼venli iletiÅŸim iÃ§in ÅŸifreleyebilirler.&lt;/p>
&lt;h2 id="setting-up-the-development-environment-for-javascript-rsa-encryption">Setting Up the Development environment for JavaScript RSA Encryption&lt;/h2>
&lt;p>rnekte, modern tarayÄ±cÄ±lara yerleÅŸik olan ve RSA ÅŸifrelemeyi iÃ§eren kriptografik iÅŸlemleri saÄŸlayan Web Crypto API&amp;rsquo;sini kullanacaÄŸÄ±z. Bu nedenle, herhangi bir npm paketi indirmenize gerek yoktur.&lt;/p>
&lt;p>JavaScript ile tarayÄ±cÄ± uygulamasÄ± geliÅŸtireceksem genellikle Vite ile baÅŸlarÄ±m. Bunu yapmak iÃ§in, aÅŸaÄŸÄ±daki komutu girerek vanilla js veya React ile bir proje baÅŸlatabiliriz. GÃ¶sterim amaÃ§lÄ± kÃ¼Ã§Ã¼k bir React projesi geliÅŸtireceÄŸim, ancak vanilla js ile devam etmeniz durumda bile yeterli olacaktÄ±r.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>npm create vite@latest
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Bundan sonra src/utils/RsaEncryptionHelper.js dosyasÄ±nÄ± oluÅŸturup o dosyayÄ± aÅŸaÄŸÄ±daki gibi dolduracaÄŸÄ±m. Bu dosyanÄ±n method&amp;rsquo;larÄ±yla RSA algoritmasÄ± ile ÅŸifreleyebilir ve ÅŸifresini Ã§Ã¶zebilirsiniz, ancak ÅŸifre Ã§Ã¶zme genellikle backend sorumluluÄŸundadÄ±r Ã§Ã¼nkÃ¼ ÅŸifre Ã§Ã¶zme private anahtar gerektirir ve gÃ¼venlik nedenlerinden dolayÄ± javascript istemcisinin private anahtarlarÄ± herkese aÃ§Ä±k olarak saklamamasÄ± veya private anahtarlara eriÅŸmemesi gerekir. Ancak SSL&amp;rsquo;deki gibi iki yÃ¶nlÃ¼ anahtar ÅŸifrelemeye benzer bir ÅŸey denemek isteyen olursa diye bunuda paylaÅŸÄ±yorum.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// src/utils/RsaEncryptionHelper.js
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">encryptAlgorithm&lt;/span> &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">name&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;RSA-OAEP&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">modulusLength&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">2048&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">publicExponent&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">Uint8Array&lt;/span>([&lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#ae81ff">1&lt;/span>]),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">extractable&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">hash&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">name&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;SHA-256&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">arrayBufferToBase64&lt;/span>(&lt;span style="color:#a6e22e">arrayBuffer&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">byteArray&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">Uint8Array&lt;/span>(&lt;span style="color:#a6e22e">arrayBuffer&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> &lt;span style="color:#a6e22e">byteString&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">let&lt;/span> &lt;span style="color:#a6e22e">i&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>; &lt;span style="color:#a6e22e">i&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#a6e22e">byteArray&lt;/span>.&lt;span style="color:#a6e22e">byteLength&lt;/span>; &lt;span style="color:#a6e22e">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">byteString&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> String.&lt;span style="color:#a6e22e">fromCharCode&lt;/span>(&lt;span style="color:#a6e22e">byteArray&lt;/span>[&lt;span style="color:#a6e22e">i&lt;/span>]);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">b64&lt;/span> &lt;span style="color:#f92672">=&lt;/span> window.&lt;span style="color:#a6e22e">btoa&lt;/span>(&lt;span style="color:#a6e22e">byteString&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">b64&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">base64StringToArrayBuffer&lt;/span>(&lt;span style="color:#a6e22e">b64str&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">byteStr&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">atob&lt;/span>(&lt;span style="color:#a6e22e">b64str&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">bytes&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">Uint8Array&lt;/span>(&lt;span style="color:#a6e22e">byteStr&lt;/span>.&lt;span style="color:#a6e22e">length&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">let&lt;/span> &lt;span style="color:#a6e22e">i&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>; &lt;span style="color:#a6e22e">i&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#a6e22e">byteStr&lt;/span>.&lt;span style="color:#a6e22e">length&lt;/span>; &lt;span style="color:#a6e22e">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">bytes&lt;/span>[&lt;span style="color:#a6e22e">i&lt;/span>] &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">byteStr&lt;/span>.&lt;span style="color:#a6e22e">charCodeAt&lt;/span>(&lt;span style="color:#a6e22e">i&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">bytes&lt;/span>.&lt;span style="color:#a6e22e">buffer&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">convertPemToArrayBuffer&lt;/span>(&lt;span style="color:#a6e22e">pem&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">lines&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">pem&lt;/span>.&lt;span style="color:#a6e22e">split&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;\n&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> &lt;span style="color:#a6e22e">encoded&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">let&lt;/span> &lt;span style="color:#a6e22e">i&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>; &lt;span style="color:#a6e22e">i&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#a6e22e">lines&lt;/span>.&lt;span style="color:#a6e22e">length&lt;/span>; &lt;span style="color:#a6e22e">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">lines&lt;/span>[&lt;span style="color:#a6e22e">i&lt;/span>].&lt;span style="color:#a6e22e">trim&lt;/span>().&lt;span style="color:#a6e22e">length&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">lines&lt;/span>[&lt;span style="color:#a6e22e">i&lt;/span>].&lt;span style="color:#a6e22e">indexOf&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;-----BEGIN RSA PRIVATE KEY-----&amp;#34;&lt;/span>) &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">lines&lt;/span>[&lt;span style="color:#a6e22e">i&lt;/span>].&lt;span style="color:#a6e22e">indexOf&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;-----BEGIN PRIVATE KEY-----&amp;#34;&lt;/span>) &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">lines&lt;/span>[&lt;span style="color:#a6e22e">i&lt;/span>].&lt;span style="color:#a6e22e">indexOf&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;-----BEGIN PUBLIC KEY-----&amp;#34;&lt;/span>) &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">lines&lt;/span>[&lt;span style="color:#a6e22e">i&lt;/span>].&lt;span style="color:#a6e22e">indexOf&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;-----END RSA PRIVATE KEY-----&amp;#34;&lt;/span>) &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">lines&lt;/span>[&lt;span style="color:#a6e22e">i&lt;/span>].&lt;span style="color:#a6e22e">indexOf&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;-----END PRIVATE KEY-----&amp;#34;&lt;/span>) &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">lines&lt;/span>[&lt;span style="color:#a6e22e">i&lt;/span>].&lt;span style="color:#a6e22e">indexOf&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;-----END PUBLIC KEY-----&amp;#34;&lt;/span>) &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">encoded&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#a6e22e">lines&lt;/span>[&lt;span style="color:#a6e22e">i&lt;/span>].&lt;span style="color:#a6e22e">trim&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">base64StringToArrayBuffer&lt;/span>(&lt;span style="color:#a6e22e">encoded&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">export&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">encryptRsa&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> (&lt;span style="color:#a6e22e">str&lt;/span>, &lt;span style="color:#a6e22e">pemString&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">try&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// convert string into ArrayBuffer
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">encodedPlaintext&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">TextEncoder&lt;/span>().&lt;span style="color:#a6e22e">encode&lt;/span>(&lt;span style="color:#a6e22e">str&lt;/span>).&lt;span style="color:#a6e22e">buffer&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">keyArrayBuffer&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">convertPemToArrayBuffer&lt;/span>(&lt;span style="color:#a6e22e">pemString&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// import public key
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">secretKey&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">crypto&lt;/span>.&lt;span style="color:#a6e22e">subtle&lt;/span>.&lt;span style="color:#a6e22e">importKey&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;spki&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">keyArrayBuffer&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">encryptAlgorithm&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> [&lt;span style="color:#e6db74">&amp;#34;encrypt&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// encrypt the text with the public key
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">encrypted&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">crypto&lt;/span>.&lt;span style="color:#a6e22e">subtle&lt;/span>.&lt;span style="color:#a6e22e">encrypt&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">name&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;RSA-OAEP&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">secretKey&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">encodedPlaintext&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// store data into base64 string
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">arrayBufferToBase64&lt;/span>(&lt;span style="color:#a6e22e">encrypted&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">catch&lt;/span> (&lt;span style="color:#a6e22e">error&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">error&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Encryption Error:&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">error&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">export&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">decryptRsa&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> (&lt;span style="color:#a6e22e">str&lt;/span>, &lt;span style="color:#a6e22e">pemString&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">try&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// convert base64 encoded input string into ArrayBuffer
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">encodedPlaintext&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">base64StringToArrayBuffer&lt;/span>(&lt;span style="color:#a6e22e">str&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">keyArrayBuffer&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">convertPemToArrayBuffer&lt;/span>(&lt;span style="color:#a6e22e">pemString&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// import private key
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">secretKey&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">crypto&lt;/span>.&lt;span style="color:#a6e22e">subtle&lt;/span>.&lt;span style="color:#a6e22e">importKey&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;pkcs8&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">keyArrayBuffer&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">encryptAlgorithm&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> [&lt;span style="color:#e6db74">&amp;#34;decrypt&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// decrypt the text with the public key
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">decrypted&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">crypto&lt;/span>.&lt;span style="color:#a6e22e">subtle&lt;/span>.&lt;span style="color:#a6e22e">decrypt&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">name&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;RSA-OAEP&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">secretKey&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">encodedPlaintext&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// decode the decrypted ArrayBuffer output
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">uint8Array&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">Uint8Array&lt;/span>(&lt;span style="color:#a6e22e">decrypted&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">textDecoder&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">TextDecoder&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">decodedString&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">textDecoder&lt;/span>.&lt;span style="color:#a6e22e">decode&lt;/span>(&lt;span style="color:#a6e22e">uint8Array&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">decodedString&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">catch&lt;/span> (&lt;span style="color:#a6e22e">error&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">error&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Decryption Error:&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">error&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Bu yardÄ±mcÄ± yÃ¶ntemleri kullanarak kÃ¼Ã§Ã¼k bir React projesi geliÅŸtirdim. Verileri ÅŸifrelemek ve ÅŸifresini Ã§Ã¶zmek iÃ§in .NET API&amp;rsquo;den paylaÅŸÄ±lacak genel ve Ã¶zel anahtarlarÄ±nÄ±zÄ± kullanabilirsiniz, ancak ÅŸifre Ã§Ã¶zme iÅŸleminin arka uÃ§ta gizli tutulan Ã¶zel anahtarla yapÄ±lmasÄ± gerektiÄŸini unutmayÄ±n.&lt;/p>
&lt;a href="https://lecture-rsa-dotnet-javascript.vercel.app" target="_blank">
&lt;img src="https://berkselvi.dev/img/how-to-use-rsa-for-encryption-in-javascript-and-decryption-in-net/rsa-encryption.webp" alt="RSA Encryption (lecture-rsa-dotnet-javascript.vercel.app)" loading="lazy" />
&lt;p class="image-sub-title">RSA Encryption (lecture-rsa-dotnet-javascript.vercel.app)&lt;/p>
&lt;/a>
&lt;p>Kaynak koduna eriÅŸmek isterseniz projenin tamamÄ±nÄ± GitHub hesabÄ±mda bulabilirsiniz:&lt;/p>
&lt;p>&lt;a href="https://github.com/berkslv/lecture-rsa-dotnet-javascript">GitHub - berkslv/lecture-rsa-dotnet-javascript&lt;/a>&lt;/p>
&lt;hr>
&lt;h2 id="sonuÃ§">SonuÃ§&lt;/h2>
&lt;p>OkuduÄŸunuz iÃ§in teÅŸekkÃ¼rler! ðŸŽ‰ YazÄ±lÄ±m geliÅŸtirme alanÄ±ndaki araÅŸtÄ±rmalarÄ±mÄ± kaÃ§Ä±rmamak iÃ§in &lt;a href="https://x.com/berkslv">@berkslv&lt;/a> adresinden takipte kalabilirsiniz.&lt;/p></content></item><item><title>Ocelot ve Keycloak'i birlikte kullanarak API Gateway'den Mikroservis gÃ¼venliÄŸini nasÄ±l saÄŸlarÄ±z?</title><link>https://berkselvi.dev/tr/posts/how-to-use-ocelot-and-keycloak-together-to-secure-microservices-from-api-gateway/</link><pubDate>Tue, 30 Jan 2024 00:00:00 +0300</pubDate><guid>https://berkselvi.dev/tr/posts/how-to-use-ocelot-and-keycloak-together-to-secure-microservices-from-api-gateway/</guid><description>&lt;p>Mikroservis mimarisinin dinamik dÃ¼nyasÄ±nda, gÃ¼Ã§lÃ¼ bir gÃ¼venliÄŸe olan ihtiyaÃ§ Ã§ok daha Ã¶nemli hale gelmiÅŸtir. KuruluÅŸlar uygulamalarÄ±nÄ± daha kÃ¼Ã§Ã¼k, baÄŸÄ±msÄ±z bir ÅŸekilde deploy edilebilir servislere bÃ¶ldÃ¼kÃ§e, bu servisler arasÄ±nda alÄ±nan ve gÃ¶nderilen verilerin bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ ve gizliliÄŸini saÄŸlamak kritik bir Ã¶nem haline gelir.&lt;/p>
&lt;p>Bu blog yazÄ±sÄ±nda, Ocelot&amp;rsquo;u kullanan ve gÃ¼Ã§lÃ¼ bir aÃ§Ä±k kaynak kimlik ve eriÅŸim yÃ¶netimi Ã§Ã¶zÃ¼mÃ¼ olan Keycloak ile mikroservisleri gÃ¼vence altÄ±na almak iÃ§in kapsamlÄ± bir Ã§Ã¶zÃ¼mÃ¼ keÅŸfedeceÄŸiz. Keycloak&amp;rsquo;u API Gateway&amp;rsquo;in arkasÄ±na yerleÅŸtirerek, bu entegrasyonun kaynaklarÄ± koruduÄŸunu, diÄŸer hizmetlere yÃ¶nelik istekleri kimlik doÄŸruladÄ±ÄŸÄ±nÄ± ve taleplere eriÅŸimi yetkilendirdiÄŸini claim yapÄ±larÄ±nÄ± kullanarak sunar. Bu, mikroservis ekosisteminiz iÃ§in sorunsuz ve gÃ¼venli bir iletiÅŸim Ã§erÃ§evesi sunar. BaÅŸlayalÄ±m.&lt;/p></description><content>&lt;p>Mikroservis mimarisinin dinamik dÃ¼nyasÄ±nda, gÃ¼Ã§lÃ¼ bir gÃ¼venliÄŸe olan ihtiyaÃ§ Ã§ok daha Ã¶nemli hale gelmiÅŸtir. KuruluÅŸlar uygulamalarÄ±nÄ± daha kÃ¼Ã§Ã¼k, baÄŸÄ±msÄ±z bir ÅŸekilde deploy edilebilir servislere bÃ¶ldÃ¼kÃ§e, bu servisler arasÄ±nda alÄ±nan ve gÃ¶nderilen verilerin bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ ve gizliliÄŸini saÄŸlamak kritik bir Ã¶nem haline gelir.&lt;/p>
&lt;p>Bu blog yazÄ±sÄ±nda, Ocelot&amp;rsquo;u kullanan ve gÃ¼Ã§lÃ¼ bir aÃ§Ä±k kaynak kimlik ve eriÅŸim yÃ¶netimi Ã§Ã¶zÃ¼mÃ¼ olan Keycloak ile mikroservisleri gÃ¼vence altÄ±na almak iÃ§in kapsamlÄ± bir Ã§Ã¶zÃ¼mÃ¼ keÅŸfedeceÄŸiz. Keycloak&amp;rsquo;u API Gateway&amp;rsquo;in arkasÄ±na yerleÅŸtirerek, bu entegrasyonun kaynaklarÄ± koruduÄŸunu, diÄŸer hizmetlere yÃ¶nelik istekleri kimlik doÄŸruladÄ±ÄŸÄ±nÄ± ve taleplere eriÅŸimi yetkilendirdiÄŸini claim yapÄ±larÄ±nÄ± kullanarak sunar. Bu, mikroservis ekosisteminiz iÃ§in sorunsuz ve gÃ¼venli bir iletiÅŸim Ã§erÃ§evesi sunar. BaÅŸlayalÄ±m.&lt;/p>
&lt;h2 id="create-keycloak-instance">Create Keycloak instance&lt;/h2>
&lt;p>Docker iÃ§inde Keycloak&amp;rsquo;u Ã§alÄ±ÅŸtÄ±rmak Ã§ok kolaydÄ±r. Bu Docker dosyasÄ±nÄ± projenizin /Identity dizinine yerleÅŸtirin. TÃ¼m kodlarÄ± yazÄ±nÄ±n sonundaki GitHub reposunda bulabilirsiniz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-Dockerfile" data-lang="Dockerfile">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">FROM&lt;/span>&lt;span style="color:#e6db74"> quay.io/keycloak/keycloak:latest as builder &lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># Enable health and metrics support &lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">ENV&lt;/span> KC_HEALTH_ENABLED&lt;span style="color:#f92672">=&lt;/span>true
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">ENV&lt;/span> KC_METRICS_ENABLED&lt;span style="color:#f92672">=&lt;/span>true
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Configure a database vendor &lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">ENV&lt;/span> KC_DB&lt;span style="color:#f92672">=&lt;/span>postgres
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">WORKDIR&lt;/span>&lt;span style="color:#e6db74"> /opt/keycloak &lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># for demonstration purposes only, please make sure to use proper certificates in production instead &lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">RUN&lt;/span> keytool -genkeypair -storepass password -storetype PKCS12 -keyalg RSA -keysize &lt;span style="color:#ae81ff">2048&lt;/span> -dname &lt;span style="color:#e6db74">&amp;#34;CN=server&amp;#34;&lt;/span> -alias server -ext &lt;span style="color:#e6db74">&amp;#34;SAN:c=DNS:localhost,IP:127.0.0.1&amp;#34;&lt;/span> -keystore conf/server.keystore &lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">RUN&lt;/span> /opt/keycloak/bin/kc.sh build &lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">FROM&lt;/span>&lt;span style="color:#e6db74"> quay.io/keycloak/keycloak:latest &lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">COPY&lt;/span> --from&lt;span style="color:#f92672">=&lt;/span>builder /opt/keycloak/ /opt/keycloak/ &lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># change these values to point to a running postgres instance &lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">ENTRYPOINT&lt;/span> [&lt;span style="color:#e6db74">&amp;#34;/opt/keycloak/bin/kc.sh&amp;#34;&lt;/span>]&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>And create docker-compose.yml file that access /Identity/Dockerfile and builds image from it. We can use base image rather than custom Dockerfile but with this approach you can customize much more features of Keycloak like frontend theme and secret keys.&lt;/p>
&lt;p>/Identity/Dockerfile dosyasÄ±na eriÅŸen ve ondan bir image oluÅŸturan docker-compose.yml dosyasÄ±nÄ± oluÅŸturun. Ã–zel Docker dosyasÄ± yerine bir temel image kullanabiliriz, ancak bu yaklaÅŸÄ±mla Keycloak&amp;rsquo;un frontend temasÄ± ve secret key bilgileri gibi Ã§ok daha fazla Ã¶zelliÄŸini Ã¶zelleÅŸtirebilirsiniz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">version&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;3&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">services&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># PostgreSQL for keycloak &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">secured-identity-db&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">container_name&lt;/span>: &lt;span style="color:#ae81ff">secured-identity-db &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">image&lt;/span>: &lt;span style="color:#ae81ff">postgres:16-alpine &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ports&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">6063&lt;/span>:&lt;span style="color:#ae81ff">5432&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">expose&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">6063&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./data/secured-identity-db:/var/lib/postgresql/data &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">restart&lt;/span>: &lt;span style="color:#ae81ff">always &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">environment&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">POSTGRES_PASSWORD=myStrongPassword123 &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">POSTGRES_USER=keycloak &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">POSTGRES_DB=keycloak &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">networks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">secured-network &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Keycloak &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">secured-identity&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">container_name&lt;/span>: &lt;span style="color:#ae81ff">secured-identity &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">build&lt;/span>: &lt;span style="color:#ae81ff">./Keycloak &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">command&lt;/span>: [&lt;span style="color:#e6db74">&amp;#34;start-dev&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ports&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">5053&lt;/span>:&lt;span style="color:#ae81ff">8080&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">expose&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">5053&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">environment&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">KEYCLOAK_ADMIN=admin &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">KEYCLOAK_ADMIN_PASSWORD=admin &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">KC_HOSTNAME_URL=http://localhost:5050/identity &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">KC_DB=postgres &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">KC_DB_USERNAME=keycloak &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">KC_DB_PASSWORD=myStrongPassword123 &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">KC_DB_URL=jdbc:postgresql://secured-identity-db:5432/keycloak &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">depends_on&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">secured-identity-db &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">networks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">secured-network &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">networks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">secured-network&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">driver&lt;/span>: &lt;span style="color:#ae81ff">bridge &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">volumes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">secured-data&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">driver&lt;/span>: &lt;span style="color:#ae81ff">local&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ve sadece bu docker-compose.yml dosyasÄ±ndan docker&amp;rsquo;Ä± Ã§alÄ±ÅŸtÄ±rmamÄ±z yeterlidir.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>docker compose build
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker compose up -d
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="put-keycloak-behind-ocelot-api-gateway-to-protect-resources">Put keycloak behind Ocelot API Gateway to protect resources&lt;/h2>
&lt;img src="https://berkselvi.dev/img/how-to-use-ocelot-and-keycloak-together-to-secure-microservices-from-api-gateway/Microservice-architecture-with-Ocelot-and-Keycloak.webp" alt="Microservice architecture with Ocelot and Keycloak" loading="lazy" />
&lt;p class="image-sub-title">Microservice architecture with Ocelot and Keycloak&lt;/p>
&lt;p>Kimlik hizmetinizin (keycloak) gÃ¼venliÄŸini saÄŸlamak ve diÄŸer hizmetler gibi istek alabilecek uÃ§ noktalarÄ± sÄ±nÄ±rlandÄ±rarak saldÄ±rÄ± vektÃ¶rÃ¼nÃ¼ azaltmak Ã¶nemlidir. Keycloak admin paneline harici bir aÄŸdan eriÅŸilmemelidir, bu Ã¶zelliÄŸe yalnÄ±zca bu aÄŸdaki kiÅŸiler eriÅŸebilir. Daha fazla bilgi edinmek iÃ§in &lt;a href="https://www.keycloak.org/server/reverseproxy">reverse proxy kullanma&lt;/a> hakkÄ±ndaki Keycloak dÃ¶kÃ¼mantasyonunu gÃ¶z atÄ±n.&lt;/p>
&lt;img src="https://berkselvi.dev/img/how-to-use-ocelot-and-keycloak-together-to-secure-microservices-from-api-gateway/Exposed-path-recommendations.webp" alt="Exposed path recommendations" loading="lazy" />
&lt;p class="image-sub-title">Exposed path recommendations&lt;/p>
&lt;p>Ã–ncelikle Ocelot projesini oluÅŸturalÄ±m. Burada .NET 8 kullanÄ±yorum&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>dotnet new sln -n Secured
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet new webapi -o Secured.ApiGateway
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cd Secured.ApiGateway/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet add package Ocelot --version 22.0.1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Projeyi baÅŸarÄ±yla oluÅŸturduktan sonra Program.cs dosyasÄ±nÄ± aÅŸaÄŸÄ±daki gibi deÄŸiÅŸtirip root dizinde ocelot.json dosyasÄ±nÄ± oluÅŸturun.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cs" data-lang="cs">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> builder = WebApplication.CreateBuilder(args);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.Configuration.AddJsonFile(&lt;span style="color:#e6db74">&amp;#34;ocelot.json&amp;#34;&lt;/span>, optional: &lt;span style="color:#66d9ef">false&lt;/span>, reloadOnChange: &lt;span style="color:#66d9ef">true&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.Services.AddOcelot(builder.Configuration);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> app = builder.Build();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">await&lt;/span> app.UseOcelot();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">await&lt;/span> app.RunAsync();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Bundan sonra bu ocelot.json dosyasÄ±nÄ± localhost:5053 Ã¼zerinde Ã§alÄ±ÅŸan keycloak uygulamamÄ±za eriÅŸimi sÄ±nÄ±rlamak iÃ§in kullanabiliriz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Routes&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;DownstreamPathTemplate&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/realms/{everything}&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;DownstreamScheme&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;http&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;DownstreamHostAndPorts&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Host&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;localhost&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Port&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">5053&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;UpstreamPathTemplate&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/identity/realms/{everything}&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;UpstreamHttpMethod&amp;#34;&lt;/span>: [ &lt;span style="color:#e6db74">&amp;#34;Get&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Post&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Put&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Delete&amp;#34;&lt;/span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;DownstreamPathTemplate&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/resources/{everything}&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;DownstreamScheme&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;http&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;DownstreamHostAndPorts&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Host&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;localhost&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Port&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">5053&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;UpstreamPathTemplate&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/identity/resources/{everything}&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;UpstreamHttpMethod&amp;#34;&lt;/span>: [ &lt;span style="color:#e6db74">&amp;#34;Get&amp;#34;&lt;/span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;DownstreamPathTemplate&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/js/{everything}&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;DownstreamScheme&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;http&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;DownstreamHostAndPorts&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Host&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;localhost&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Port&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">5053&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;UpstreamPathTemplate&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/identity/js/{everything}&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;UpstreamHttpMethod&amp;#34;&lt;/span>: [ &lt;span style="color:#e6db74">&amp;#34;Get&amp;#34;&lt;/span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;GlobalConfiguration&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;BaseUrl&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;https://localhost:5050&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Bu yapÄ±landÄ±rmalardan sonra, API Gateway&amp;rsquo;in adresi olan localhost:5050&amp;rsquo;den keycloak&amp;rsquo;a eriÅŸebilirsiniz. Ancak, bu adres aracÄ±lÄ±ÄŸÄ±yla Keycloak yÃ¶netici paneline eriÅŸemezsiniz Ã§Ã¼nkÃ¼ eriÅŸimi sÄ±nÄ±rladÄ±k.&lt;/p>
&lt;p>Keycloak yapÄ±landÄ±rmalarÄ±mÄ±zÄ± yapmak iÃ§in, hala local olarak eriÅŸilebilen keycloak adresinde, yani localhost:5053&amp;rsquo;te yÃ¶netici paneline giriÅŸ yapabiliriz. Deployment senaryosunda, yalnÄ±zca Ocelot&amp;rsquo;un harici internete eriÅŸimi olduÄŸundan emin olacaÄŸÄ±z.&lt;/p>
&lt;p>localhost:5053 adresine admin kullanÄ±cÄ± adÄ± ve admin ÅŸifresiyle giriÅŸ yapabiliriz. Bu kimlik bilgilerini docker-compose.yml dosyasÄ±ndan deÄŸiÅŸtirebiliriz.&lt;/p>
&lt;img src="https://berkselvi.dev/img/how-to-use-ocelot-and-keycloak-together-to-secure-microservices-from-api-gateway/keycloak-1.webp" alt="Keycloak" loading="lazy" />
&lt;p>GiriÅŸ yaptÄ±ktan sonra, kullanÄ±cÄ±larÄ± yÃ¶netmek iÃ§in yeni bir alan (realm) oluÅŸturmak ve uygulamamÄ±z iÃ§in istemci oluÅŸturmak iÃ§in bu aÃ§Ä±lÄ±r menÃ¼den yeni alan (realm) oluÅŸtur seÃ§eneÄŸine tÄ±klÄ±yoruz. &amp;ldquo;Yeni alan (realm) oluÅŸtur&amp;rdquo; dÃ¼ÄŸmesine tÄ±kladÄ±ktan sonra, basitÃ§e &lt;strong>secured&lt;/strong>&amp;lsquo;Ä± alan (realm) adÄ± olarak girin ve diÄŸer her ÅŸeyi olduÄŸu gibi bÄ±rakÄ±n.&lt;/p>
&lt;img src="https://berkselvi.dev/img/how-to-use-ocelot-and-keycloak-together-to-secure-microservices-from-api-gateway/keycloak-2.webp" alt="Keycloak" loading="lazy" />
&lt;p>Clients sekmesinde client oluÅŸtur&amp;rsquo;a tÄ±klayÄ±n. Client ID alanÄ±nÄ± &lt;strong>postman&lt;/strong> olarak adlandÄ±rÄ±n ve geÃ§erli redirect URL&amp;rsquo;sini &lt;a href="https://oauth.pstmn.io/v1/callback">&lt;strong>https://oauth.pstmn.io/v1/callback&lt;/strong>&lt;/a> olarak adlandÄ±rÄ±n. diÄŸer ÅŸeyleri olduÄŸu gibi bÄ±rakÄ±n.&lt;/p>
&lt;img src="https://berkselvi.dev/img/how-to-use-ocelot-and-keycloak-together-to-secure-microservices-from-api-gateway/keycloak-3.webp" alt="Keycloak" loading="lazy" />
&lt;p>KullanÄ±cÄ±lar sekmesinde Keycloak&amp;rsquo;ta oturum aÃ§acak kullanÄ±cÄ±larÄ± ekleyin.&lt;/p>
&lt;img src="https://berkselvi.dev/img/how-to-use-ocelot-and-keycloak-together-to-secure-microservices-from-api-gateway/keycloak-4.webp" alt="Keycloak" loading="lazy" />
&lt;p>Bu adÄ±mlardan sonra, yeni oluÅŸturulan kullanÄ±cÄ±yla Keycloak&amp;rsquo;a giriÅŸ yaparak eriÅŸim belirteci alabiliriz. API gateway&amp;rsquo;e eriÅŸmek iÃ§in Postman kullanÄ±yorum. Postman&amp;rsquo;de Keycloak ile oturum aÃ§abilirsiniz. Yetkilendirme bÃ¶lÃ¼mÃ¼nde OAuth 2.0&amp;rsquo;Ä± seÃ§in ve aÅŸaÄŸÄ±daki gibi yapÄ±landÄ±rÄ±n ve Yeni EriÅŸim Belgesi Al&amp;rsquo;a tÄ±klayÄ±n. Postman, tarayÄ±cÄ± penceresini aÃ§acak ve sizi Keycloak giriÅŸ sayfasÄ±na yÃ¶nlendirecektir, yeni kullanÄ±cÄ±nÄ±zÄ±n kimlik bilgilerini girin. Admin kimlik bilgilerini girmeyin, bu kimlik bilgileri yalnÄ±zca ana (master) alan iÃ§in geÃ§erlidir.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-txt" data-lang="txt">&lt;span style="display:flex;">&lt;span>Grant type: Authorization code
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Auth URL: http://localhost:5050/identity/realms/secured/protocol/openid-connect/auth
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Access Token URL: http://localhost:5050/identity/realms/secured/protocol/openid-connect/token
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Client ID: postman
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Scope: openid profile roles
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Her ÅŸeyi doÄŸru yaptÄ±ysanÄ±z, Postman ile API Gateway&amp;rsquo;in arkasÄ±ndaki Keycloak&amp;rsquo;a baÅŸarÄ±yla kimlik doÄŸrulamasÄ± yaptÄ±nÄ±z ðŸŽ‰&lt;/p>
&lt;h2 id="authenticate-requests-to-other-services">Authenticate requests to other services&lt;/h2>
&lt;p>Ocelot&amp;rsquo;ta bir isteÄŸin kimliÄŸini doÄŸrulamak istiyorsanÄ±z Program.cs ve ocelot.json&amp;rsquo;da aÅŸaÄŸÄ±daki gÃ¼ncellemeleri yapÄ±n. MetadataAddress, JWT doÄŸrulamasÄ± iÃ§in gerekli anahtarlarÄ± alÄ±r. Ancak ekstra network isteklerinden kaÃ§Ä±nmak istiyorsanÄ±z anahtarlarÄ± appsettings.json dosyasÄ±na yerleÅŸtirip kullanabilirsiniz.&lt;/p>
&lt;p>Ocelot.json dosyasÄ±ndaki AuthenticationOptions ile kimlik doÄŸrulama tamamlandÄ±, burada JWT tokenÄ±mÄ±zÄ± Bearer Ã¶nekiyle birlikte gÃ¶ndereceÄŸimizi ve JWT token doÄŸrulamasÄ±nÄ± Program.cs&amp;rsquo;den yapÄ±landÄ±rma ile yapacaÄŸÄ±mÄ±zÄ± sÃ¶ylÃ¼yoruz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cs" data-lang="cs">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> builder = WebApplication.CreateBuilder(args);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.Services
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .AddAuthentication(JwtBearerDefaults.AuthenticationScheme)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .AddJwtBearer(JwtBearerDefaults.AuthenticationScheme, o =&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> o.MetadataAddress = &lt;span style="color:#e6db74">&amp;#34;http://localhost:5050/identity/realms/secured/.well-known/openid-configuration&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> o.RequireHttpsMetadata = &lt;span style="color:#66d9ef">false&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> o.Authority = &lt;span style="color:#e6db74">&amp;#34;http://localhost:5050/realms/secured&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> o.Audience = &lt;span style="color:#e6db74">&amp;#34;account&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.Configuration.AddJsonFile(&lt;span style="color:#e6db74">&amp;#34;ocelot.json&amp;#34;&lt;/span>, optional: &lt;span style="color:#66d9ef">false&lt;/span>, reloadOnChange: &lt;span style="color:#66d9ef">true&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.Services.AddOcelot(builder.Configuration);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> app = builder.Build();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.UseAuthentication();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.UseAuthorization();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">await&lt;/span> app.UseOcelot();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">await&lt;/span> app.RunAsync();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Routes&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;DownstreamPathTemplate&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/get&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;DownstreamScheme&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;https&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;DownstreamHostAndPorts&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Host&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;httpbin.org&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Port&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">443&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;UpstreamPathTemplate&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/test&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;UpstreamHttpMethod&amp;#34;&lt;/span>: [ &lt;span style="color:#e6db74">&amp;#34;Get&amp;#34;&lt;/span> ],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;AuthenticationOptions&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;AuthenticationProviderKey&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;Bearer&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">//...
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="authorize-requests-to-other-services">Authorize requests to other services&lt;/h2>
&lt;p>Yetkilendirme biraz daha zor ve ek Ã§alÄ±ÅŸma gerektirir Ã§Ã¼nkÃ¼ Keycloak, kullanÄ±cÄ± rollerini JWT yÃ¼kÃ¼nde nested yani iÃ§ iÃ§e geÃ§miÅŸ olarak yerleÅŸtirir. AÅŸaÄŸÄ±daki gibi bir ÅŸeydir. GÃ¶rÃ¼ldÃ¼ÄŸÃ¼ gibi, roller alanÄ± realm_access alanÄ± altÄ±na yerleÅŸtirilir. Bu, Ocelot&amp;rsquo;ta karÄ±ÅŸÄ±klÄ±ÄŸa neden olur, Ã§Ã¼nkÃ¼ Ocelot, talepleri string veya object deÄŸerleri olarak okur ve nested alanlarÄ± deÄŸerlendirmez. Bu sorunu Ã¶nlemek iÃ§in Keycloak token eÅŸlemesini yapÄ±landÄ±rÄ±rÄ±z ve nested biÃ§imi kullanmayÄ±z.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">//...
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">&amp;#34;exp&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">1706600524&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;realm_access&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;roles&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;offline_access&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;default-roles-microcommerce&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;uma_authorization&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;customer&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;resource_access&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;account&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;roles&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;manage-account&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;manage-account-links&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;view-profile&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;scope&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;openid email profile&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;preferred_username&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;berkslv&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Bu Ã¶zel eÅŸleme iÃ§in sol menÃ¼den Client scopes&amp;rsquo;a tÄ±klayÄ±n ve rolleri seÃ§in.&lt;/p>
&lt;img src="https://berkselvi.dev/img/how-to-use-ocelot-and-keycloak-together-to-secure-microservices-from-api-gateway/keycloak-5.webp" alt="Keycloak" loading="lazy" />
&lt;p>Rollerin altÄ±nda, Mappers bÃ¶lÃ¼mÃ¼nÃ¼ seÃ§in ve ardÄ±ndan realm roles&amp;rsquo;a tÄ±klayÄ±n.&lt;/p>
&lt;img src="https://berkselvi.dev/img/how-to-use-ocelot-and-keycloak-together-to-secure-microservices-from-api-gateway/keycloak-6.webp" alt="Keycloak" loading="lazy" />
&lt;p>AÃ§Ä±lan menÃ¼de Token Claim Name seÃ§eneÄŸine realm_access.roles hali hazÄ±rda girilidir. Bunu &lt;strong>realm_roles&lt;/strong> olarak gÃ¼ncelliyoruz.&lt;/p>
&lt;img src="https://berkselvi.dev/img/how-to-use-ocelot-and-keycloak-together-to-secure-microservices-from-api-gateway/keycloak-7.webp" alt="Keycloak" loading="lazy" />
&lt;p>Bu konfigÃ¼rasyonlarÄ± yaptÄ±ktan sonra Postman Ã¼zerinden tekrar giriÅŸ yaparak tokenÄ±mÄ±zÄ± gÃ¼ncelliyoruz. GÃ¼ncellenen token ile yaptÄ±ÄŸÄ±mÄ±z isteklerin Ocelot tarafÄ±ndan talep kontrolÃ¼ne tabi olmasÄ± iÃ§in ocelot.json dosyasÄ±nda aÅŸaÄŸÄ±daki gÃ¼ncellemeyi yapÄ±yoruz. KullanÄ±cÄ±mÄ±zda &lt;strong>customer&lt;/strong> rolÃ¼ yoksa 403 yanÄ±tÄ± alÄ±yoruz. Keycloak yÃ¶netici panelinde Ã¶zel rollerinizi oluÅŸturabilir ve atayabilirsiniz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Routes&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;DownstreamPathTemplate&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/get&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;DownstreamScheme&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;https&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;DownstreamHostAndPorts&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Host&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;httpbin.org&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Port&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">443&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;UpstreamPathTemplate&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/test&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;UpstreamHttpMethod&amp;#34;&lt;/span>: [ &lt;span style="color:#e6db74">&amp;#34;Get&amp;#34;&lt;/span> ],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;AuthenticationOptions&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;AuthenticationProviderKey&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;Bearer&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;RouteClaimsRequirement&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;realm_roles&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;customer&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">//...
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Kaynak koduna eriÅŸmek isterseniz projenin tamamÄ±nÄ± GitHub hesabÄ±mda bulabilirsiniz:&lt;/p>
&lt;p>&lt;a href="https://github.com/berkslv/lecture-ocelot-and-keycloak">GitHub - berkslv/lecture-ocelot-and-keycloak&lt;/a>&lt;/p>
&lt;hr>
&lt;h2 id="sonuÃ§">SonuÃ§&lt;/h2>
&lt;p>OkuduÄŸunuz iÃ§in teÅŸekkÃ¼rler! ðŸŽ‰ YazÄ±lÄ±m geliÅŸtirme alanÄ±ndaki araÅŸtÄ±rmalarÄ±mÄ± kaÃ§Ä±rmamak iÃ§in &lt;a href="https://x.com/berkslv">@berkslv&lt;/a> adresinden takipte kalabilirsiniz.&lt;/p></content></item><item><title>.NET ile Background jobs ve Hangfire</title><link>https://berkselvi.dev/tr/posts/background-jobs-and-hangife-in-net/</link><pubDate>Sun, 17 Sep 2023 00:00:00 +0300</pubDate><guid>https://berkselvi.dev/tr/posts/background-jobs-and-hangife-in-net/</guid><description>&lt;p>.NET ekosisteminde bir uygulama geliÅŸtirirken, iÅŸler karmaÅŸÄ±klaÅŸtÄ±ÄŸÄ±nda, bazÄ± yÃ¶ntemlerimizin birden fazla servise gitmesi, yanÄ±tlarÄ±nÄ± deÄŸerlendirmesi ve bu sonuÃ§larÄ± farklÄ± servislere bildirmesi gerekebilir ve bu uzun zaman alabilir! Bu tÃ¼r uzun sÃ¼re Ã§alÄ±ÅŸan yÃ¶ntemleri bir endpoint&amp;rsquo;in arkasÄ±na yerleÅŸtirerek ve TCP baÄŸlantÄ±mÄ±zÄ± o HTTP isteÄŸinin yanÄ±tÄ± iÃ§in aÃ§Ä±k tutarak kaynaklarÄ± boÅŸa harcamak istemeyiz. Bu kullanÄ±mÄ± on demand job olarak adlandÄ±rabiliriz Ã§Ã¼nkÃ¼ bir istek yapÄ±ldÄ±ÄŸÄ±nda Ã§alÄ±ÅŸacaktÄ±r. AyrÄ±ca, belirli gÃ¼nler veya haftanÄ±n belirli zamanlarÄ±nda otomatik olarak Ã§alÄ±ÅŸmasÄ±nÄ± isteyebiliriz, bunu bir recurring job olarak adlandÄ±rabiliriz; Bu tÃ¼r durumlarda, iÅŸimizi uygulamanÄ±n Ã§alÄ±ÅŸtÄ±ÄŸÄ± main thread&amp;rsquo;den farklÄ± bir thread baÅŸlatarak &amp;ldquo;background job&amp;rdquo; kullanabiliriz.&lt;/p></description><content>&lt;p>.NET ekosisteminde bir uygulama geliÅŸtirirken, iÅŸler karmaÅŸÄ±klaÅŸtÄ±ÄŸÄ±nda, bazÄ± yÃ¶ntemlerimizin birden fazla servise gitmesi, yanÄ±tlarÄ±nÄ± deÄŸerlendirmesi ve bu sonuÃ§larÄ± farklÄ± servislere bildirmesi gerekebilir ve bu uzun zaman alabilir! Bu tÃ¼r uzun sÃ¼re Ã§alÄ±ÅŸan yÃ¶ntemleri bir endpoint&amp;rsquo;in arkasÄ±na yerleÅŸtirerek ve TCP baÄŸlantÄ±mÄ±zÄ± o HTTP isteÄŸinin yanÄ±tÄ± iÃ§in aÃ§Ä±k tutarak kaynaklarÄ± boÅŸa harcamak istemeyiz. Bu kullanÄ±mÄ± on demand job olarak adlandÄ±rabiliriz Ã§Ã¼nkÃ¼ bir istek yapÄ±ldÄ±ÄŸÄ±nda Ã§alÄ±ÅŸacaktÄ±r. AyrÄ±ca, belirli gÃ¼nler veya haftanÄ±n belirli zamanlarÄ±nda otomatik olarak Ã§alÄ±ÅŸmasÄ±nÄ± isteyebiliriz, bunu bir recurring job olarak adlandÄ±rabiliriz; Bu tÃ¼r durumlarda, iÅŸimizi uygulamanÄ±n Ã§alÄ±ÅŸtÄ±ÄŸÄ± main thread&amp;rsquo;den farklÄ± bir thread baÅŸlatarak &amp;ldquo;background job&amp;rdquo; kullanabiliriz.&lt;/p>
&lt;p>.NET&amp;rsquo;te arka plan iÅŸlerini yÃ¶netmenin birÃ§ok farklÄ± yÃ¶ntemi bulunmaktadÄ±r. Bu blog yazÄ±sÄ±nda adÄ±m adÄ±m bu yÃ¶ntemlerden bahsedeceÄŸim, nasÄ±l sorunlarÄ± Ã§Ã¶zdÃ¼klerini ve bize hangi sorunlarÄ± getirdiklerini anlatacaÄŸÄ±m ve background job&amp;rsquo;larÄ±yla uÄŸraÅŸÄ±rken en Ã§ok sevdiÄŸim paket olan Hangfire&amp;rsquo;da detaylÄ± kullanÄ±m Ã¶rnekleri sunacaÄŸÄ±m. AyrÄ±ca, tÃ¼m kodlara repodan eriÅŸebilirsiniz:&lt;/p>
&lt;p>&lt;a href="https://github.com/berkslv/lecture-dotnet-background-jobs">GitHub - berkslv/lecture-dotnet-background-jobs&lt;/a>&lt;/p>
&lt;h2 id="taskrun">Task.Run()&lt;/h2>
&lt;p>Background job&amp;rsquo;larÄ±na ihtiyacÄ±m olduÄŸunda aklÄ±ma ilk gelen Ã§Ã¶zÃ¼m, Task.Run() yÃ¶ntemiyle yeni bir thread oluÅŸturmak ve bir methodu onun Ã¼zerinde Ã§alÄ±ÅŸtÄ±rmak oldu. BirÃ§ok dÄ±ÅŸ servise baÄŸÄ±mlÄ±lÄ±ÄŸÄ± olan ve tamamlanmasÄ± 5 dakikaya kadar sÃ¼rebilen bir yÃ¶ntemim var ve bu yÃ¶ntemi oluÅŸturduÄŸum bir controller aracÄ±lÄ±ÄŸÄ±yla bir HTTP isteÄŸi Ã¼zerinden Ã§aÄŸÄ±rÄ±yordum, ancak bu isteÄŸe yanÄ±t vermek sorunluydu Ã§Ã¼nkÃ¼ TCP baÄŸlantÄ±sÄ±nÄ±n 5 dakika boyunca aÃ§Ä±k kalmasÄ± gerekiyordu, bu yÃ¼zden isteÄŸi Ã§aÄŸÄ±rdÄ±ÄŸÄ±mda, iÅŸlem baÅŸarÄ±yla baÅŸlatÄ±ldÄ±ysa, istemciye iÅŸlemin baÅŸarÄ±yla baÅŸlatÄ±ldÄ±ÄŸÄ±nÄ± 200 durum koduyla bildirmem gerekiyor.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cs" data-lang="cs">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// TestService.cs &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">TestService&lt;/span> : ITestService
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">readonly&lt;/span> ILogger&amp;lt;TestService&amp;gt; _logger;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> TestService(ILogger&amp;lt;TestService&amp;gt; logger)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _logger = logger;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">bool&lt;/span> RunTests()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _logger.LogInformation(&lt;span style="color:#e6db74">$&amp;#34;{DateTime.Now} RunTests is started&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ... &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Thread.Sleep(&lt;span style="color:#ae81ff">5000&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ... &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _logger.LogInformation(&lt;span style="color:#e6db74">$&amp;#34;{DateTime.Now} RunTests is finished&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cs" data-lang="cs">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Program.cs &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ... &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.Services.AddTransient&amp;lt;ITestService, TestService&amp;gt;();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ...&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Task.Run() kullanmadan iÅŸlemi Ã§aÄŸÄ±rmazsam, bu Ã¶rnekte tarayÄ±cÄ±da /job endpoint&amp;rsquo;ine yÃ¶nelik istek 3 saniye boyunca yÃ¼kleniyor olacak.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cs" data-lang="cs">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// JobController.cs &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">[ApiController]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">[Route(&amp;#34;[controller]&lt;/span>&lt;span style="color:#e6db74">&amp;#34;)]
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&lt;/span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">JobController&lt;/span> : ControllerBase
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">readonly&lt;/span> ITestService _testService;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> JobController(ITestService testService)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _testService = testService;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e"> [HttpGet]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> IActionResult Get()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _testService.RunTests();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> Ok(&lt;span style="color:#e6db74">&amp;#34;Ok&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Task.Run() ile aÅŸaÄŸÄ±daki gibi kullandÄ±ÄŸÄ±mda, controller baÅŸarÄ±lÄ± bir ÅŸekilde yanÄ±t verecek ve RunTests yÃ¶ntemim arka planda Ã§alÄ±ÅŸmaya devam edecek.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cs" data-lang="cs">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">[HttpGet]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> IActionResult Get()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Task.Run(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _testService.RunTests();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> Ok(&lt;span style="color:#e6db74">&amp;#34;Ok&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="artÄ±lar">ArtÄ±lar&lt;/h3>
&lt;ul>
&lt;li>Ä°steÄŸe baÄŸlÄ± olarak arka planda bir iÅŸlem Ã§alÄ±ÅŸtÄ±rabiliriz.&lt;/li>
&lt;li>Ek bir paket gerektirmez.&lt;/li>
&lt;/ul>
&lt;h3 id="eksiler">Eksiler&lt;/h3>
&lt;ul>
&lt;li>Mevcut durumda recurring job desteÄŸi bulunmamaktadÄ±r, Ã¶zel bir sistem geliÅŸtirilmesi gerekmektedir.&lt;/li>
&lt;li>Dependency Injection kullanÄ±ldÄ±ÄŸÄ±nda, enjekte edilen interface&amp;rsquo;ler main thread Ã¼zerinde kalacaÄŸÄ±ndan, gereken interface&amp;rsquo;Ã¼ Service scope aracÄ±lÄ±ÄŸÄ±yla yeniden oluÅŸturmamÄ±z gerekebilir.&lt;/li>
&lt;li>YÃ¶ntem Ã§alÄ±ÅŸÄ±rken bir hata oluÅŸursa ne olur?&lt;/li>
&lt;/ul>
&lt;h2 id="hosted-service">Hosted Service&lt;/h2>
&lt;p>Ã–nceki Ã¶rneÄŸimizde uygulayamadÄ±ÄŸÄ±mÄ±z yinelenen iÅŸleri yÃ¶netmek iÃ§in kendi sistemimizi geliÅŸtirmemiz gerekiyordu, ancak Hosted servis ile bu yÃ¶netimi kendimiz geliÅŸtirmemize gerek kalmaz, bunun yerine Program.cs dosyasÄ±nda &lt;code>AddHostedService&lt;/code> yÃ¶ntemimizi aÅŸaÄŸÄ±daki gibi Ã§aÄŸÄ±rÄ±rÄ±z ve TestService sÄ±nÄ±fÄ±mÄ±zÄ± BackgroundService sÄ±nÄ±fÄ±ndan tÃ¼retiriz. Bu Ã¶rnekte, RunTests yÃ¶ntemimiz her 10 saniyede bir Ã§alÄ±ÅŸacaktÄ±r. Bu zaman aralÄ±ÄŸÄ±, BackgroundService abstract sÄ±nÄ±fÄ±ndan miras alÄ±nan ExecuteAsync yÃ¶nteminden ayarlanÄ±r.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cs" data-lang="cs">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Program.cs &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ... &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.Services.AddHostedService&amp;lt;TestService&amp;gt;();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ...&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cs" data-lang="cs">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// TestService.cs &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">TestService&lt;/span> : BackgroundService, ITestService
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">readonly&lt;/span> ILogger&amp;lt;TestService&amp;gt; _logger;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> TestService(ILogger&amp;lt;TestService&amp;gt; logger)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _logger = logger;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">bool&lt;/span> RunTests(TestType testType)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> type = Enum.GetName(&lt;span style="color:#66d9ef">typeof&lt;/span>(TestType), testType);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _logger.LogInformation(&lt;span style="color:#e6db74">$&amp;#34;{DateTime.Now} {type} RunTests is started&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ... &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Thread.Sleep(&lt;span style="color:#ae81ff">5000&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ... &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _logger.LogInformation(&lt;span style="color:#e6db74">$&amp;#34;{DateTime.Now} {type} RunTests is finished&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">protected&lt;/span> &lt;span style="color:#66d9ef">override&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> Task ExecuteAsync(CancellationToken stoppingToken)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> timer = &lt;span style="color:#66d9ef">new&lt;/span> PeriodicTimer(TimeSpan.FromSeconds(&lt;span style="color:#ae81ff">10&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">while&lt;/span> (&lt;span style="color:#66d9ef">await&lt;/span> timer.WaitForNextTickAsync(stoppingToken))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> RunTests(TestType.Recurring);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ancak, yÃ¶ntemimizi on demand olarak Ã§alÄ±ÅŸtÄ±rmak istiyorsak, Task.Run() yÃ¶nteminin yardÄ±mÄ±yla yeni bir thread Ã¼zerinden Ã§alÄ±ÅŸÄ±rÄ±z, bu nedenle JobController.cs&amp;rsquo;de herhangi bir deÄŸiÅŸiklik yapmamÄ±za gerek yoktur.&lt;/p>
&lt;h3 id="artÄ±lar-1">ArtÄ±lar&lt;/h3>
&lt;ul>
&lt;li>Recurring job yÃ¶netimi saÄŸlar&lt;/li>
&lt;li>Ek paket kurmaya gerek yoktur&lt;/li>
&lt;/ul>
&lt;h3 id="eksiler-1">Eksiler&lt;/h3>
&lt;ul>
&lt;li>Talep Ã¼zerine Ã§alÄ±ÅŸma iÃ§in bir sistem bulunmamaktadÄ±r.&lt;/li>
&lt;li>YÃ¶ntem Ã§alÄ±ÅŸÄ±rken bir hata alÄ±nÄ±rsa ne olur?&lt;/li>
&lt;/ul>
&lt;h2 id="hangfire">Hangfire&lt;/h2>
&lt;p>Hangfire, job&amp;rsquo;Ä±mÄ±zÄ± tek bir sistem aracÄ±lÄ±ÄŸÄ±yla talep Ã¼zerine ve recurring job&amp;rsquo;larÄ± yÃ¶netmeyi Ã§ok daha kolay hale getirir. DiÄŸer iki yÃ¶ntemde bulunmayan job storage sistemi sayesinde, uygulama o anda Ã§alÄ±ÅŸmÄ±yor olsa bile cron job ile sÃ¼resi gelmiÅŸse ilgili job&amp;rsquo;Ä± otomatik olarak Ã§alÄ±ÅŸtÄ±rÄ±r. Belirli job&amp;rsquo;larÄ± Ã§alÄ±ÅŸtÄ±rabilir ve job oluÅŸturulurken saÄŸlanan id bilgileri ile o job&amp;rsquo;Ä± silme yeteneÄŸine sahip oluruz. AyrÄ±ca, /hangfire adresindeki bir dashboard Ã¼zerinden ÅŸu anda Ã§alÄ±ÅŸan job&amp;rsquo;larÄ±mÄ±zÄ± izleyebiliriz.&lt;/p>
&lt;img src="https://berkselvi.dev/img/background-jobs-and-hangife-in-net/hangfire-dashboard.webp" alt="Hangfire dashboard" loading="lazy" />
&lt;p class="image-sub-title">Hangfire dashboard&lt;/p>
&lt;p>Hangfire resmi olarak Sql Server veritabanÄ±nÄ± destekler, ancak aÃ§Ä±k kaynaklÄ± bir uzantÄ± ile Sqlite ve Postgresql gibi sÄ±k tercih edilen veritabanlarÄ± da kullanÄ±labilir. AyrÄ±ca, Hangfire, Ã¼cretli sÃ¼rÃ¼mÃ¼yle Redis veritabanÄ± desteÄŸi ve batch job&amp;rsquo;larÄ±nÄ±n Ã§alÄ±ÅŸtÄ±rÄ±lmasÄ± gibi enterprise ihtiyaÃ§larÄ± da karÅŸÄ±lar.&lt;/p>
&lt;p>&lt;a href="https://www.hangfire.io/extensions.html">Hangfire â€“ Background Jobs for .NET and .NET Core&lt;/a>&lt;/p>
&lt;p>Bu kÄ±sa Hangfire giriÅŸten sonra, Hangfire&amp;rsquo;Ä± uygulamamÄ±zda nasÄ±l kullanabileceÄŸimiz ve yeteneklerinden kÄ±saca bahsedelim. Ã–rneÄŸimizde job storage olarak Postgresql kullanacaÄŸÄ±z, ancak yukarÄ±daki link Ã¼zerinden istediÄŸiniz veritabanÄ±nÄ± seÃ§ebilirsiniz. UygulamamÄ±za aÅŸaÄŸÄ±daki paketleri yÃ¼kledikten ve Docker ile bir Postgre SQL veritabanÄ± kurduktan sonra, kodlarÄ±mÄ±za geÃ§elim.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>dotnet add package Hangfire
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet add package Hangfire.Core
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet add package Hangfire.PostgreSql
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet add package TimeZoneConverter
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker run -d --name postgres_db -e POSTGRES_USER&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;root&amp;#34;&lt;/span> -e POSTGRES_PASSWORD&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;1234&amp;#34;&lt;/span> -e POSTGRES_DB&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;postgres&amp;#34;&lt;/span> -v postgres_data:/var/lib/postgresql/data -p 5432:5432 postgres
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ä°lk olarak, appsettings.json dosyasÄ±nda Postgresql iÃ§in connection string bilgilerini aÅŸaÄŸÄ±daki gibi saÄŸlÄ±yoruz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;ConnectionStrings&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;HangfireConnection&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;Host=localhost;Port=5432;Password=1234;Username=root;Database=postgres;Pooling=true;Integrated Security=true;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Program.cs&amp;rsquo;de ilgili yapÄ±landÄ±rmalarÄ± aÅŸaÄŸÄ±daki gibi yapÄ±yoruz.&lt;/p>
&lt;p>TZConvert.GetTimeZoneInfo yÃ¶ntemiyle gerekli zaman dilimi bilgisini iÅŸletim sisteminden alÄ±rsÄ±nÄ±z. Bu kod satÄ±rÄ±, local makinenizin, frontend uygulamanÄ±zÄ±n ve cloud makinenizin farklÄ± zaman dilimlerine sahip olabileceÄŸi iÃ§in gereklidir.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cs" data-lang="cs">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> builder = WebApplication.CreateBuilder(args);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ... &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.Services.AddHangfire(config =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> config
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .UseSimpleAssemblyNameTypeSerializer()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .UseRecommendedSerializerSettings()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .UsePostgreSqlStorage(builder.Configuration.GetConnectionString(&lt;span style="color:#e6db74">&amp;#34;HangfireConnection&amp;#34;&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> cronEveryMinute = &lt;span style="color:#e6db74">&amp;#34;*/1 * * * *&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> recurringJobOptions = &lt;span style="color:#66d9ef">new&lt;/span> RecurringJobOptions
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> TimeZone = TZConvert.GetTimeZoneInfo(&lt;span style="color:#e6db74">&amp;#34;Etc/GMT+3&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> RecurringJob.AddOrUpdate&amp;lt;ITestService&amp;gt;(&lt;span style="color:#e6db74">&amp;#34;id-run-and-wait&amp;#34;&lt;/span>, x =&amp;gt; x.RunTests(Guid.NewGuid(), TestType.Recurring, CancellationToken.None), cronEveryMinute, recurringJobOptions);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>});
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.Services.AddHangfireServer();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> app = builder.Build();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ... &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.UseHangfireDashboard();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.MapHangfireDashboard();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.Run();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>To showcase Hangfireâ€™s capabilities, we add a few more endpoints to our controller class.&lt;/p>
&lt;p>&lt;strong>/run,&lt;/strong> we can start a job and that method returns us a job id&lt;/p>
&lt;p>&lt;strong>/stop,&lt;/strong> we can stop the job related to the job id given to us by Hangfire.&lt;/p>
&lt;p>&lt;strong>/continue,&lt;/strong> if many different jobs are to be run but they are dependent on each other, another job can be run after the parent job is finished with the given job id.&lt;/p>
&lt;p>&lt;strong>/reschedule,&lt;/strong> the jobâ€™s working intervals can be dynamically adjusted by cron or TimeSpan.&lt;/p>
&lt;p>&lt;strong>/deschedule,&lt;/strong> recurring jobs can be deleted by their unique id.&lt;/p>
&lt;p>&lt;strong>/trigger,&lt;/strong> we can manually trigger a recurring job.&lt;/p>
&lt;p>Hangfire&amp;rsquo;nin yeteneklerini sergilemek iÃ§in, controller sÄ±nÄ±fÄ±mÄ±za birkaÃ§ ek endpoint ekliyoruz.&lt;/p>
&lt;p>&lt;strong>/run,&lt;/strong> bir job baÅŸlatabilir ve bu yÃ¶ntem bize job&amp;rsquo;Ä±n id bilgisini dÃ¶ndÃ¼rÃ¼r.&lt;/p>
&lt;p>&lt;strong>/stop,&lt;/strong> bize Hangfire tarafÄ±ndan verilen job id ile iliÅŸkili job sÃ¼recini durdurabiliriz.&lt;/p>
&lt;p>&lt;strong>/continue,&lt;/strong> birÃ§ok farklÄ± job&amp;rsquo;Ä±n Ã§alÄ±ÅŸtÄ±rÄ±lmasÄ± gerekiyorsa, ama bunlar birbirlerine baÄŸÄ±mlÄ±ysa, verilen job id ile ana job tamamlandÄ±ktan sonra baÅŸka bir iÅŸ Ã§alÄ±ÅŸtÄ±rÄ±labilir.&lt;/p>
&lt;p>&lt;strong>/reschedule,&lt;/strong> job&amp;rsquo;un Ã§alÄ±ÅŸma aralÄ±klarÄ± cron veya TimeSpan ile dinamik olarak ayarlanabilir.&lt;/p>
&lt;p>&lt;strong>/deschedule,&lt;/strong> recurring job&amp;rsquo;lar, job id bilgileriyle silinebilir.&lt;/p>
&lt;p>&lt;strong>/trigger,&lt;/strong> recurring bir job&amp;rsquo;larÄ± manuel olarak tetikleyebiliriz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cs" data-lang="cs">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// JobController.cs &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">[ApiController]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">[Route(&amp;#34;[controller]&lt;/span>&lt;span style="color:#e6db74">&amp;#34;)]
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&lt;/span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">JobController&lt;/span> : ControllerBase
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e"> [HttpGet(&amp;#34;/run&amp;#34;)]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> IActionResult Run()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> jobId = BackgroundJob.Enqueue&amp;lt;ITestService&amp;gt;(x =&amp;gt; x.RunTests(Guid.NewGuid(), TestType.OnDemand, CancellationToken.None));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> Ok(jobId);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e"> [HttpGet(&amp;#34;/stop&amp;#34;)]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> IActionResult Stop(&lt;span style="color:#66d9ef">string&lt;/span> jobId)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> BackgroundJob.Delete(jobId);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> Ok(&lt;span style="color:#e6db74">&amp;#34;Stopped&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e"> [HttpGet(&amp;#34;/continue&amp;#34;)]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> IActionResult Continue(&lt;span style="color:#66d9ef">string&lt;/span> jobId)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> BackgroundJob.ContinueJobWith&amp;lt;ITestService&amp;gt;(jobId, x =&amp;gt; x.RunTests(Guid.NewGuid(), TestType.OnDemand, CancellationToken.None));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> Ok(&lt;span style="color:#e6db74">&amp;#34;Continued&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e"> [HttpGet(&amp;#34;/reschedule&amp;#34;)]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> IActionResult Reschedule(&lt;span style="color:#66d9ef">string&lt;/span> cron)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> recurringJobOptions = &lt;span style="color:#66d9ef">new&lt;/span> RecurringJobOptions
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> TimeZone = TZConvert.GetTimeZoneInfo(&lt;span style="color:#e6db74">&amp;#34;Etc/GMT+3&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> RecurringJob.AddOrUpdate&amp;lt;ITestService&amp;gt;(&lt;span style="color:#e6db74">&amp;#34;id-run-and-wait&amp;#34;&lt;/span>, x =&amp;gt; x.RunTests(Guid.NewGuid(), TestType.Recurring, CancellationToken.None), cron, recurringJobOptions);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> Ok(&lt;span style="color:#e6db74">&amp;#34;Rescheduled&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e"> [HttpGet(&amp;#34;/deschedule&amp;#34;)]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> IActionResult Deschedule(&lt;span style="color:#66d9ef">string&lt;/span> id)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (String.IsNullOrEmpty(id))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> id = &lt;span style="color:#e6db74">&amp;#34;id-run-and-wait&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> RecurringJob.RemoveIfExists(id);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> Ok(&lt;span style="color:#e6db74">&amp;#34;Descheduled&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e"> [HttpGet(&amp;#34;/trigger&amp;#34;)]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> IActionResult Trigger(&lt;span style="color:#66d9ef">string&lt;/span> id)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (String.IsNullOrEmpty(id))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> id = &lt;span style="color:#e6db74">&amp;#34;id-run-and-wait&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> RecurringJob.TriggerJob(id);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> Ok(&lt;span style="color:#e6db74">&amp;#34;Triggered&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Finally, error management, which is not in our toolkit previously with Task.Run and Hosted service but with Hangfire if an error occurs while running a method, Hangfire runs that method 10 more times with the same parameters at certain time intervals. As an example, we add a method called ThrowRandomly to our TestService class. With this method, we simply add a system that will throw an exception from the method that works with probability 1/2, but Hangfire will try to get successful results by re-running the methods that get errors for us. But errors that catches successfully cannot trigger the retry system. Therefore in the end of catch block we throw again.&lt;/p>
&lt;p>Son olarak, Ã¶nceki Task.Run() ve Hosted servis ile sahip olmadÄ±ÄŸÄ±mÄ±z hata yÃ¶netimi sayesinde Hangfire ile bir yÃ¶ntem Ã§alÄ±ÅŸÄ±rken bir hata oluÅŸursa, Hangfire belirli zaman aralÄ±klarÄ±nda aynÄ± parametrelerle bu yÃ¶ntemi 10 kez daha Ã§alÄ±ÅŸtÄ±rÄ±r. Bir Ã¶rnek olarak, TestService sÄ±nÄ±fÄ±mÄ±za ThrowRandomly adÄ±nda bir method ekliyoruz. Bu method ile, 1/2 olasÄ±lÄ±kla gerÃ§ekleÅŸen bir exception fÄ±rlatan yapÄ± oluÅŸturuyoruz, ancak Hangfire, bizim iÃ§in hata alan methodlarÄ± tekrar Ã§alÄ±ÅŸtÄ±rarak baÅŸarÄ±lÄ± sonuÃ§lar elde etmeye Ã§alÄ±ÅŸÄ±r. Ancak baÅŸarÄ±lÄ± bir ÅŸekilde catch&amp;rsquo;lenen exception&amp;rsquo;lar, yeniden deneme sistemini tetiklemez. Bu nedenle catch bloÄŸunun sonunda tekrar bir exception fÄ±rlatÄ±yoruz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cs" data-lang="cs">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// TestService.cs &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">TestService&lt;/span> : ITestService
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">readonly&lt;/span> ILogger&amp;lt;TestService&amp;gt; _logger;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> TestService(ILogger&amp;lt;TestService&amp;gt; logger)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _logger = logger;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">bool&lt;/span> RunTests(Guid id, TestType testType, CancellationToken cancellationToken)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> type = Enum.GetName(&lt;span style="color:#66d9ef">typeof&lt;/span>(TestType), testType);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">try&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _logger.LogInformation(&lt;span style="color:#e6db74">$&amp;#34;{DateTime.Now} {type} RunTests is started. Id: {id}&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cancellationToken.ThrowIfCancellationRequested();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ... &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Thread.Sleep(&lt;span style="color:#ae81ff">5000&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ThrowRandomly();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ... &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _logger.LogInformation(&lt;span style="color:#e6db74">$&amp;#34;{DateTime.Now} {type} RunTests is finished. Id: {id}&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">catch&lt;/span> (OperationCanceledException exception)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _logger.LogError(&lt;span style="color:#e6db74">$&amp;#34;{DateTime.Now} {type} RunTests is failed. Exception: {exception.Message} Id: {id}&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">throw&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">catch&lt;/span>(Exception exception)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _logger.LogError(&lt;span style="color:#e6db74">$&amp;#34;{DateTime.Now} {type} RunTests is failed. Exception: {exception.Message} Id: {id}&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">throw&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">void&lt;/span> ThrowRandomly()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> random = &lt;span style="color:#66d9ef">new&lt;/span> Random();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> number = random.Next(&lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#ae81ff">3&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (number == &lt;span style="color:#ae81ff">2&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">throw&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> Exception(&lt;span style="color:#e6db74">&amp;#34;Error is throwed!&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>AyrÄ±ca, Hangfire ayrÄ± servis Ã¼zerinde Ã§alÄ±ÅŸÄ±r, bu ihtiyaÃ§larÄ±nÄ±za baÄŸlÄ± olarak iyi veya kÃ¶tÃ¼ olabilir. Ã–lÃ§eklendirme gerektiÄŸinde uygulama ve Hangfire sunucularÄ±nÄ± ayÄ±rabilir ve bunlarÄ± farklÄ± makinelerde Ã§alÄ±ÅŸtÄ±rabiliriz.&lt;/p>
&lt;h3 id="artÄ±lar-2">ArtÄ±lar&lt;/h3>
&lt;ul>
&lt;li>GÃ¼Ã§lÃ¼ bir soyutlama ile talep Ã¼zerine ve yinelenen iÅŸleri birlikte yÃ¶netebilir.&lt;/li>
&lt;li>Cron iÅŸ zamanlamasÄ±nÄ± dinamik olarak ayarlayabiliriz ve zamanlamasÄ± Ã§ok hassastÄ±r.&lt;/li>
&lt;li>Ã‡alÄ±ÅŸan ve cron job&amp;rsquo;larÄ±mÄ±zÄ± Dashboard ile izleyebiliriz.&lt;/li>
&lt;li>Zorunlu interface uygulamasÄ± veya baÅŸka Ã¶zel bir uygulama yoktur, yalnÄ±zca Hangfire tarafÄ±ndan saÄŸlanan yÃ¶ntemleri kullanarak job&amp;rsquo;larÄ±mÄ±zÄ± yÃ¶netebiliriz.&lt;/li>
&lt;/ul>
&lt;h3 id="eksiler-2">Eksiler&lt;/h3>
&lt;ul>
&lt;li>Harici depolama gereklidir, varsayÄ±lan olarak SQL Server ile Ã§alÄ±ÅŸÄ±r.&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="sonuÃ§">SonuÃ§&lt;/h2>
&lt;p>OkuduÄŸunuz iÃ§in teÅŸekkÃ¼rler! ðŸŽ‰ YazÄ±lÄ±m geliÅŸtirme alanÄ±ndaki araÅŸtÄ±rmalarÄ±mÄ± kaÃ§Ä±rmamak iÃ§in &lt;a href="https://x.com/berkslv">@berkslv&lt;/a> adresinden takipte kalabilirsiniz.&lt;/p></content></item><item><title>Dotnet ve Vue.js uygulamasÄ±nÄ± Keycloak ile nasÄ±l gÃ¼venliÄŸi saÄŸlanÄ±r?</title><link>https://berkselvi.dev/tr/posts/how-to-secure-dotnet-vue-application-with-keycloak/</link><pubDate>Mon, 21 Aug 2023 00:00:00 +0300</pubDate><guid>https://berkselvi.dev/tr/posts/how-to-secure-dotnet-vue-application-with-keycloak/</guid><description>&lt;p>Bu yazÄ±da, dotnet ve vue uygulamalarÄ±mÄ±zÄ± keycloak kullanarak nasÄ±l gÃ¼vence altÄ±na alabileceÄŸimizi konuÅŸacaÄŸÄ±m.&lt;/p>
&lt;p>Ã–ncelikle, Keycloak uygulamamÄ±zÄ± docker kullanarak Ã§alÄ±ÅŸtÄ±rÄ±yoruz, bu uygulamayÄ± Azure veya benzeri bir bulut saÄŸlayÄ±cÄ±sÄ±nda yayÄ±nlarsanÄ±z, production uygulamalarÄ±nÄ±zda kolayca kullanabilirsiniz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>docker run -p 8080:8080 -e KEYCLOAK_ADMIN&lt;span style="color:#f92672">=&lt;/span>admin -e KEYCLOAK_ADMIN_PASSWORD&lt;span style="color:#f92672">=&lt;/span>admin quay.io/keycloak/keycloak:22.0.1 start-dev
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Keycloak Ã§alÄ±ÅŸtÄ±ktan sonra, localhost:8080/admin adresine kullanÄ±cÄ± adÄ±: admin ve ÅŸifre: admin ile giriÅŸ yaptÄ±ktan sonra sol taraftan uygulamamÄ±z iÃ§in bir alan (realm) oluÅŸtururuz. Ana (master) alan keycloak&amp;rsquo;un kendi kullanÄ±mÄ±na atandÄ±ÄŸÄ±ndan, baÅŸka bir realm Ã¼zerinde Ã§alÄ±ÅŸmamÄ±z gerekmektedir.&lt;/p></description><content>&lt;p>Bu yazÄ±da, dotnet ve vue uygulamalarÄ±mÄ±zÄ± keycloak kullanarak nasÄ±l gÃ¼vence altÄ±na alabileceÄŸimizi konuÅŸacaÄŸÄ±m.&lt;/p>
&lt;p>Ã–ncelikle, Keycloak uygulamamÄ±zÄ± docker kullanarak Ã§alÄ±ÅŸtÄ±rÄ±yoruz, bu uygulamayÄ± Azure veya benzeri bir bulut saÄŸlayÄ±cÄ±sÄ±nda yayÄ±nlarsanÄ±z, production uygulamalarÄ±nÄ±zda kolayca kullanabilirsiniz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>docker run -p 8080:8080 -e KEYCLOAK_ADMIN&lt;span style="color:#f92672">=&lt;/span>admin -e KEYCLOAK_ADMIN_PASSWORD&lt;span style="color:#f92672">=&lt;/span>admin quay.io/keycloak/keycloak:22.0.1 start-dev
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Keycloak Ã§alÄ±ÅŸtÄ±ktan sonra, localhost:8080/admin adresine kullanÄ±cÄ± adÄ±: admin ve ÅŸifre: admin ile giriÅŸ yaptÄ±ktan sonra sol taraftan uygulamamÄ±z iÃ§in bir alan (realm) oluÅŸtururuz. Ana (master) alan keycloak&amp;rsquo;un kendi kullanÄ±mÄ±na atandÄ±ÄŸÄ±ndan, baÅŸka bir realm Ã¼zerinde Ã§alÄ±ÅŸmamÄ±z gerekmektedir.&lt;/p>
&lt;img src="https://berkselvi.dev/img/how-to-secure-dotnet-vue-application-with-keycloak/create-realm.webp" alt="Create realm" loading="lazy" />
&lt;p class="image-sub-title">Create realm&lt;/p>
&lt;img src="https://berkselvi.dev/img/how-to-secure-dotnet-vue-application-with-keycloak/create-realm-confirmation.webp" alt="Create realm confirmation" loading="lazy" />
&lt;p class="image-sub-title">Create realm confirmation&lt;/p>
&lt;p>Realmâ€™i oluÅŸturduktan sonra client kÄ±smÄ±ndan vue adÄ±nda bir client oluÅŸturuyoruz. YÃ¶nlendirme URL&amp;rsquo;lerimiz Vue uygulamamÄ±zÄ±n URL&amp;rsquo;sidir. production ortamÄ± iÃ§in ek gÃ¼ncellemeler yapmanÄ±z gerekebilir.&lt;/p>
&lt;p>Vue uygulamamÄ±zda kullanmak Ã¼zere KullanÄ±cÄ±lar menÃ¼sÃ¼nden dotnet-vue realm altÄ±nda kullanÄ±cÄ±lar oluÅŸturabiliriz.&lt;/p>
&lt;p>UygulamamÄ±z iÃ§in kullanÄ±cÄ± oluÅŸturmak istiyorsak realm ayarlarÄ±nda bu seÃ§eneÄŸi aÃ§arak kullanÄ±cÄ±larÄ±mÄ±zÄ±n keycloak&amp;rsquo;a kayÄ±t olmalarÄ±nÄ± saÄŸlayabiliriz.&lt;/p>
&lt;h2 id="vue">Vue&lt;/h2>
&lt;p>Bu konfigÃ¼rasyonlarÄ± tamamladÄ±ktan sonra keycloak admin paneli ile iÅŸimiz bitiyor, vue uygulamamÄ±za yetkisiz bir istek geldiÄŸinde onu keycloak giriÅŸ sayfamÄ±za yÃ¶nlendirmemiz gerekiyor. Bunun iÃ§in &lt;a href="https://medium.com/keycloak/secure-vue-js-app-with-keycloak-94814181e344">Secure Vue.js app with Keycloak&lt;/a> makalesinden yararlanÄ±yoruz.&lt;/p>
&lt;p>Vue uygulamamÄ±zÄ± vite kullanarak ÅŸu ÅŸekilde oluÅŸturabiliriz, sorulan sorulardan Vue ve Javascript seÃ§ip devam edebilirsiniz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>npm create vite@latest vue
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cd vue
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>npm install
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>npm run dev
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Daha sonra main.js iÃ§eriÄŸini aÅŸaÄŸÄ±daki gibi gÃ¼ncelliyoruz. Bu komut dosyasÄ±, yetkisiz oturum aÃ§ma isteklerini yeniden yÃ¶nlendirir ve token&amp;rsquo;Ä±n sÃ¼resinin onTokenExpired ile sona ermesi durumunda token&amp;rsquo;Ä± refrest token kullanarak gÃ¼nceller. Bu iÅŸlem sonrasÄ±nda uygulamayÄ± npm run dev ile Ã§alÄ±ÅŸtÄ±rÄ±p http://localhost:5173 adresine gidersek keycloak giriÅŸ urlâ€™si yÃ¶nlendirilecektir. OluÅŸturduÄŸumuz kullanÄ±cÄ± bilgileriyle giriÅŸ yaparsak sistemimize giriÅŸ yapmÄ±ÅŸ olacaÄŸÄ±z.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> { &lt;span style="color:#a6e22e">createApp&lt;/span> } &lt;span style="color:#a6e22e">from&lt;/span> &lt;span style="color:#e6db74">&amp;#34;vue&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> &lt;span style="color:#e6db74">&amp;#34;./style.css&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> &lt;span style="color:#a6e22e">App&lt;/span> &lt;span style="color:#a6e22e">from&lt;/span> &lt;span style="color:#e6db74">&amp;#34;./App.vue&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> &lt;span style="color:#a6e22e">Keycloak&lt;/span> &lt;span style="color:#a6e22e">from&lt;/span> &lt;span style="color:#e6db74">&amp;#34;keycloak-js&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> &lt;span style="color:#a6e22e">initOptions&lt;/span> &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">url&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;http://localhost:8080&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">realm&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;dotnet-vue&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">clientId&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;vue&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">onLoad&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;login-required&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> &lt;span style="color:#a6e22e">keycloak&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">Keycloak&lt;/span>(&lt;span style="color:#a6e22e">initOptions&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">keycloak&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .&lt;span style="color:#a6e22e">init&lt;/span>({ &lt;span style="color:#a6e22e">onLoad&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">initOptions&lt;/span>.&lt;span style="color:#a6e22e">onLoad&lt;/span> })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .&lt;span style="color:#a6e22e">then&lt;/span>((&lt;span style="color:#a6e22e">auth&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#a6e22e">auth&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> window.&lt;span style="color:#a6e22e">location&lt;/span>.&lt;span style="color:#a6e22e">reload&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Authenticated&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">createApp&lt;/span>(&lt;span style="color:#a6e22e">App&lt;/span>).&lt;span style="color:#a6e22e">mount&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;#app&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .&lt;span style="color:#66d9ef">catch&lt;/span>((&lt;span style="color:#a6e22e">error&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#a6e22e">error&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">error&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Authenticated Failed&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">keycloak&lt;/span>.&lt;span style="color:#a6e22e">onTokenExpired&lt;/span> &lt;span style="color:#f92672">=&lt;/span> () =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Token expired&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">keycloak&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .&lt;span style="color:#a6e22e">updateToken&lt;/span>(&lt;span style="color:#ae81ff">30&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">60&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .&lt;span style="color:#a6e22e">then&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Token renewed&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .&lt;span style="color:#66d9ef">catch&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">keycloak&lt;/span>.&lt;span style="color:#a6e22e">login&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">export&lt;/span> &lt;span style="color:#66d9ef">default&lt;/span> &lt;span style="color:#a6e22e">keycloak&lt;/span>;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="net">.NET&lt;/h2>
&lt;p>.NET 6 ile aÅŸaÄŸÄ±daki gibi bir webapi projesi oluÅŸturabiliriz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>cd dotnet
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet new sln -n Secured
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet new webapi -o Secured.API
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cd Secured.API
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet watch run
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Keycloak ve .NET&amp;rsquo;in desteklediÄŸi standartlar sayesinde Program.cs&amp;rsquo;de yapacaÄŸÄ±mÄ±z konfigÃ¼rasyonlarla Ã¶zel bir kod yazmadan sadece yetkilendirebiliyoruz. Bu kodda, ihraÃ§Ã§Ä± ile tokenÄ±n nereden geldiÄŸini doÄŸruluyoruz ve IssuerSigningKey sayesinde keycloak&amp;rsquo;a gitmeden oluÅŸturulan tokenÄ± doÄŸrulayabiliyoruz.&lt;/p>
&lt;p>RequireHttpsMetadata yalnÄ±zca geliÅŸtirme ortamÄ± iÃ§in kullanÄ±lmalÄ±dÄ±r; production ortamÄ±nda Ã§alÄ±ÅŸan bir uygulamanÄ±z varsa bu satÄ±rÄ± silebilirsiniz; deÄŸeri true olarak deÄŸerlendirilecektir.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cs" data-lang="cs">&lt;span style="display:flex;">&lt;span>builder.Services.AddSwaggerGen();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ... &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> issuer = builder.Configuration[&lt;span style="color:#e6db74">&amp;#34;Jwt:Issuer&amp;#34;&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> key = builder.Configuration[&lt;span style="color:#e6db74">&amp;#34;Jwt:Key&amp;#34;&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.Services.AddAuthentication(options =&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> options.DefaultAuthenticateScheme = JwtBearerDefaults.AuthenticationScheme;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> options.DefaultChallengeScheme = JwtBearerDefaults.AuthenticationScheme;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .AddJwtBearer(o =&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> o.Authority = issuer;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> o.RequireHttpsMetadata = &lt;span style="color:#66d9ef">false&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> o.TokenValidationParameters = &lt;span style="color:#66d9ef">new&lt;/span> Microsoft.IdentityModel.Tokens.TokenValidationParameters
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ValidateIssuer = &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ValidateAudience = &lt;span style="color:#66d9ef">false&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ValidateLifetime = &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ValidateIssuerSigningKey = &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ValidIssuer = issuer,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> IssuerSigningKey = &lt;span style="color:#66d9ef">new&lt;/span> SymmetricSecurityKey(Encoding.UTF8.GetBytes(key))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ... &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> app = builder.Build();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ... &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.UseAuthentication();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.UseAuthorization();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ... &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.Run();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Appsettings.json dosyasÄ±ndaki verileri aÅŸaÄŸÄ±daki gibi tutarak builder.Configuration adresinden eriÅŸebiliriz. RSA256 anahtarÄ±na keycloak admin panelinde ilgili realm altÄ±nda Realm ayarlarÄ± menÃ¼sÃ¼ndeki Keys sekmesindeki RSA256 Kid deÄŸerinden ulaÅŸabilirsiniz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;Jwt&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Issuer&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;https://localhost:8080/realms/dotnet-vue&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;Key&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;secret-rsa-key&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;span style="color:#960050;background-color:#1e0010">,&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="consuming-net-api-from-vue-app">Consuming .NET API from Vue app&lt;/h2>
&lt;p>Ã–ncelikle .NET projemize CORS ayarlarÄ±nÄ± ve Authorize niteliklerini ekliyoruz. Bunun iÃ§in &lt;code>Program.cs&lt;/code>yi aÅŸaÄŸÄ±daki gibi dÃ¼zenliyoruz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cs" data-lang="cs">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ... &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.Services.AddCors(options =&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> options.AddDefaultPolicy(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> policy =&amp;gt; policy.WithOrigins(&lt;span style="color:#e6db74">&amp;#34;http://localhost:5137&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .AllowAnyHeader()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .AllowAnyMethod()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .AllowAnyOrigin()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>});
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ... &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> app = builder.Build();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// app.UseHttpsRedirection(); &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.UseCors();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>WeatherForecastController.cs dosyasÄ± aÅŸaÄŸÄ±daki attirbute ile yetkilendirme gerektirir.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cs" data-lang="cs">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ... &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">[Authorize]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">WeatherForecastController&lt;/span> : ControllerBase
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ...&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Daha sonra aÅŸaÄŸÄ±daki komutla vue uygulamamÄ±za axios kÃ¼tÃ¼phanesini kuruyoruz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>npm install axios
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Kurulumdan sonra services isimli bir klasÃ¶r oluÅŸturup &lt;code>base.api.js&lt;/code> isimli dosyamÄ±zda axios konfigÃ¼rasyonlarÄ±nÄ± yapÄ±yoruz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> &lt;span style="color:#a6e22e">axios&lt;/span> &lt;span style="color:#a6e22e">from&lt;/span> &lt;span style="color:#e6db74">&amp;#34;axios&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> &lt;span style="color:#a6e22e">keycloak&lt;/span> &lt;span style="color:#a6e22e">from&lt;/span> &lt;span style="color:#e6db74">&amp;#34;../main&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">http&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">axios&lt;/span>.&lt;span style="color:#a6e22e">create&lt;/span>({
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">baseURL&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;http://localhost:5050&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">headers&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;Content-Type&amp;#34;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;application/json&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>});
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">http&lt;/span>.&lt;span style="color:#a6e22e">interceptors&lt;/span>.&lt;span style="color:#a6e22e">request&lt;/span>.&lt;span style="color:#a6e22e">use&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">async&lt;/span> (&lt;span style="color:#a6e22e">config&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">token&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">localStorage&lt;/span>.&lt;span style="color:#a6e22e">getItem&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;vue-token&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">config&lt;/span>.&lt;span style="color:#a6e22e">headers&lt;/span> &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">Authorization&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">`Bearer &lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">keycloak&lt;/span>.&lt;span style="color:#a6e22e">token&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">`&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">Accept&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;application/json&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">config&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#a6e22e">error&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Promise.&lt;span style="color:#a6e22e">reject&lt;/span>(&lt;span style="color:#a6e22e">error&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">export&lt;/span> &lt;span style="color:#66d9ef">default&lt;/span> &lt;span style="color:#a6e22e">http&lt;/span>;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ã–rnek bir endpoint olan WeatherForecast&amp;rsquo;e eriÅŸmek iÃ§in, aynÄ± dizine &lt;code>weather.api.js&lt;/code> dosyasÄ±nÄ± oluÅŸturuyoruz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> &lt;span style="color:#a6e22e">axios&lt;/span> &lt;span style="color:#a6e22e">from&lt;/span> &lt;span style="color:#e6db74">&amp;#34;./base.api&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">export&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">getWeather&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> () =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">axios&lt;/span>.&lt;span style="color:#a6e22e">get&lt;/span>(&lt;span style="color:#e6db74">`/WeatherForecast`&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">response&lt;/span>.&lt;span style="color:#a6e22e">data&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>App.vue&lt;/code>da API isteÄŸimizi yaparak verileri gÃ¶rÃ¼ntÃ¼lÃ¼yoruz, burada logout yÃ¶ntemi ile Ã§Ä±kÄ±ÅŸ yapabiliyoruz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-vue" data-lang="vue">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;&lt;span style="color:#f92672">script&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> &lt;span style="color:#a6e22e">Keycloak&lt;/span> &lt;span style="color:#a6e22e">from&lt;/span> &lt;span style="color:#e6db74">&amp;#39;./main&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> { &lt;span style="color:#a6e22e">getWeather&lt;/span> } &lt;span style="color:#a6e22e">from&lt;/span> &lt;span style="color:#e6db74">&amp;#39;./service/weather.api&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">export&lt;/span> &lt;span style="color:#66d9ef">default&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">name&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;App&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">data&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">weathers&lt;/span>&lt;span style="color:#f92672">:&lt;/span> []
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">async&lt;/span> &lt;span style="color:#a6e22e">mounted&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">weathers&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">await&lt;/span> &lt;span style="color:#a6e22e">getWeather&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">methods&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">logout&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">Keycloak&lt;/span>.&lt;span style="color:#a6e22e">logout&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/&lt;span style="color:#f92672">script&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;&lt;span style="color:#f92672">template&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">button&lt;/span> &lt;span style="color:#f92672">@click&lt;/span>&lt;span style="color:#e6db74">=&amp;#34;logout&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">style&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;margin-bottom: 30px;&amp;#34;&lt;/span>&amp;gt;&lt;span style="color:#a6e22e">Logout&lt;/span>&amp;lt;/&lt;span style="color:#f92672">button&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">table&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">tr&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">th&lt;/span>&amp;gt;Date&amp;lt;/&lt;span style="color:#f92672">th&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">th&lt;/span>&amp;gt;&lt;span style="color:#a6e22e">Summary&lt;/span>&amp;lt;/&lt;span style="color:#f92672">th&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;/&lt;span style="color:#f92672">tr&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">tr&lt;/span> &lt;span style="color:#f92672">v-for&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;weather in weathers&amp;#34;&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">td&lt;/span>&amp;gt;{{ &lt;span style="color:#a6e22e">weather&lt;/span>.&lt;span style="color:#a6e22e">date&lt;/span> }}&amp;lt;/&lt;span style="color:#f92672">td&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">td&lt;/span>&amp;gt;{{ &lt;span style="color:#a6e22e">weather&lt;/span>.&lt;span style="color:#a6e22e">summary&lt;/span> }}&amp;lt;/&lt;span style="color:#f92672">td&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;/&lt;span style="color:#f92672">tr&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;/&lt;span style="color:#f92672">table&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/&lt;span style="color:#f92672">template&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Kaynak koduna eriÅŸmek isterseniz projenin tamamÄ±nÄ± GitHub hesabÄ±mda bulabilirsiniz:&lt;/p>
&lt;p>&lt;a href="https://github.com/berkslv/lecture-dotnet-vue-keycloak">GitHub - berkslv/lecture-dotnet-vue-keycloak&lt;/a>&lt;/p>
&lt;hr>
&lt;h2 id="sonuÃ§">SonuÃ§&lt;/h2>
&lt;p>OkuduÄŸunuz iÃ§in teÅŸekkÃ¼rler! ðŸŽ‰ YazÄ±lÄ±m geliÅŸtirme alanÄ±ndaki araÅŸtÄ±rmalarÄ±mÄ± kaÃ§Ä±rmamak iÃ§in &lt;a href="https://x.com/berkslv">@berkslv&lt;/a> adresinden takipte kalabilirsiniz.&lt;/p></content></item><item><title>Zero downtime ile Deployment: Azure DevOps Deployment Slots Kullanarak Azure App Service Deployment iÅŸlemi</title><link>https://berkselvi.dev/tr/posts/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/</link><pubDate>Sun, 21 May 2023 00:00:00 +0300</pubDate><guid>https://berkselvi.dev/tr/posts/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/</guid><description>&lt;p>Selamlar! Azure App Service&amp;rsquo;te tek instance olarak Ã§alÄ±ÅŸan uygulamamÄ±zÄ± Azure DevOps iÅŸlem hatlarÄ±nÄ± kullanarak daÄŸÄ±tÄ±rken bÃ¼yÃ¼k olasÄ±lÄ±kla birkaÃ§ saniyelik kesinti yaÅŸanacaktÄ±r. Ã‡Ã¼nkÃ¼ tek instance olarak Ã§alÄ±ÅŸan uygulamanÄ±n yeni sÃ¼rÃ¼me gÃ¼ncellenmesi iÃ§in yeniden baÅŸlatÄ±lmasÄ± gerekecektir. En kÃ¶tÃ¼ senaryoda, uygulama sÃ¼rÃ¼mlerimizin geÃ§iÅŸinde bir hata oluÅŸmasÄ± durumunda geri alma nedeniyle kesinti sÃ¼resi uzayacaktÄ±r.&lt;/p>
&lt;p>Bu Ã¶zel sorunu app servisi iÃ§in deployment slot Ã¶zelliÄŸini kullanarak Ã§Ã¶zebiliriz. Bu Ã¶zellikle, genellikle ayrÄ± Ã¶rnekler olarak aynÄ± app servis planÄ±nda Ã§alÄ±ÅŸan iki farklÄ± Ã¶rnek, genellikle staging ve production uygulamalarÄ±, birbirinden ayrÄ± Ã¶rnekler olarak Ã§alÄ±ÅŸÄ±r ve production ortamÄ±na geÃ§iÅŸ yapÄ±ldÄ±ÄŸÄ±nda app servisi tarafÄ±ndan deÄŸiÅŸtirme iÅŸlemi yÃ¶netilir ve kesinti yaÅŸanmaz.&lt;/p></description><content>&lt;p>Selamlar! Azure App Service&amp;rsquo;te tek instance olarak Ã§alÄ±ÅŸan uygulamamÄ±zÄ± Azure DevOps iÅŸlem hatlarÄ±nÄ± kullanarak daÄŸÄ±tÄ±rken bÃ¼yÃ¼k olasÄ±lÄ±kla birkaÃ§ saniyelik kesinti yaÅŸanacaktÄ±r. Ã‡Ã¼nkÃ¼ tek instance olarak Ã§alÄ±ÅŸan uygulamanÄ±n yeni sÃ¼rÃ¼me gÃ¼ncellenmesi iÃ§in yeniden baÅŸlatÄ±lmasÄ± gerekecektir. En kÃ¶tÃ¼ senaryoda, uygulama sÃ¼rÃ¼mlerimizin geÃ§iÅŸinde bir hata oluÅŸmasÄ± durumunda geri alma nedeniyle kesinti sÃ¼resi uzayacaktÄ±r.&lt;/p>
&lt;p>Bu Ã¶zel sorunu app servisi iÃ§in deployment slot Ã¶zelliÄŸini kullanarak Ã§Ã¶zebiliriz. Bu Ã¶zellikle, genellikle ayrÄ± Ã¶rnekler olarak aynÄ± app servis planÄ±nda Ã§alÄ±ÅŸan iki farklÄ± Ã¶rnek, genellikle staging ve production uygulamalarÄ±, birbirinden ayrÄ± Ã¶rnekler olarak Ã§alÄ±ÅŸÄ±r ve production ortamÄ±na geÃ§iÅŸ yapÄ±ldÄ±ÄŸÄ±nda app servisi tarafÄ±ndan deÄŸiÅŸtirme iÅŸlemi yÃ¶netilir ve kesinti yaÅŸanmaz.&lt;/p>
&lt;p>Bu yazÄ±da, Ã§ok basit bir Dotnet Web API projesi oluÅŸturacak, Azure DevOps Repository kullanarak barÄ±ndÄ±racak, Azure DevOps pipeline ile CI/CD pipeline oluÅŸturarak Azure App Service&amp;rsquo;e daÄŸÄ±tacak ve deployment slot Ã¶zelliÄŸi ile kesintisiz deployment yapacaÄŸÄ±z. AÅŸaÄŸÄ±daki adÄ±mlarÄ± takip ederek sÃ¼reci 5 adÄ±mda tamamlayacaÄŸÄ±z. BaÅŸlayalÄ±m.&lt;/p>
&lt;ol>
&lt;li>UygulamanÄ±n OluÅŸturulmasÄ±&lt;/li>
&lt;li>Azure DevOps Repo&lt;/li>
&lt;li>Azure DevOps build pipeline&lt;/li>
&lt;li>Azure App service&lt;/li>
&lt;li>Zero downtime testing&lt;/li>
&lt;/ol>
&lt;p>##Â UygulamanÄ±n OluÅŸturulmasÄ±&lt;/p>
&lt;p>Deploy etmek iÃ§in basit bir Dotnet Web API projesi oluÅŸturuyoruz. Bunun iÃ§in aÅŸaÄŸÄ±daki komutlarÄ± kullanÄ±yoruz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>mkdir backend
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cd ./backend
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet new sln -n Slot
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet new webapi -n Slot.API
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet sln add ./Slot.API/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>properties/launchSetting.json dosyasÄ±ndaki &lt;em>profiles.http&lt;/em> Ã¶zelliÄŸini aÅŸaÄŸÄ±daki gibi gÃ¼ncelliyoruz. Burada yalnÄ±zca &lt;em>applicationUrl&lt;/em> ve &lt;em>launchBrowser&lt;/em> Ã¶zelliklerini gÃ¼ncelledik.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#e6db74">&amp;#34;profiles&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;http&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;commandName&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;Project&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;dotnetRunMessages&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;launchBrowser&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">false&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;launchUrl&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;swagger&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;applicationUrl&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;http://localhost:5050&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;environmentVariables&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;ASPNETCORE_ENVIRONMENT&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;Development&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>AÅŸaÄŸÄ±daki gÃ¼ncellemeyi Program.cs dosyasÄ±nda yaparak, uygulamanÄ±n eriÅŸilebilir ve /health uÃ§ noktasÄ±na yapÄ±lan isteklere yanÄ±t verebileceÄŸini test edeceÄŸiz. UygulamanÄ±zda bir veritabanÄ± kullanÄ±yorsanÄ±z, &lt;a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.extensions.dependencyinjection.entityframeworkcorehealthchecksbuilderextensions.adddbcontextcheck?view=dotnet-plat-ext-8.0">AddDbContextCheck&lt;/a> yÃ¶ntemi ile veritabanÄ±na eriÅŸimde bir sorun olup olmadÄ±ÄŸÄ±nÄ± da test edebilirsiniz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cs" data-lang="cs">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> builder = WebApplication.CreateBuilder(args);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ... &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>builder.Services.AddHealthChecks();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> app = builder.Build();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ... &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// app.UseHttpsRedirection(); &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.MapControllers();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.UseHealthChecks(&lt;span style="color:#e6db74">&amp;#34;/health&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app.Run();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>UygulamamÄ±z iÃ§in bu kadar! Åžimdi ÅŸu komutlarÄ± Ã§alÄ±ÅŸtÄ±rarak localhost:5050/health adresine eriÅŸebiliriz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>cd ./Slot.API
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dotnet run
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>curl -4 http://localhost:5050/health
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Healthy&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Daha sonra uygulamamÄ±zÄ± daÄŸÄ±tmak iÃ§in Docker kullanacaÄŸÄ±z, bu yÃ¼zden Dockerfile dosyamÄ±zÄ± sln dosyamÄ±zla aynÄ± dizine koyuyoruz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-Dockerfile" data-lang="Dockerfile">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Build Stage &lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">FROM&lt;/span>&lt;span style="color:#e6db74"> mcr.microsoft.com/dotnet/aspnet:7.0-alpine AS base &lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">WORKDIR&lt;/span>&lt;span style="color:#e6db74"> /app &lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">EXPOSE&lt;/span>&lt;span style="color:#e6db74"> 8080 &lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># Publish Stage &lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">FROM&lt;/span>&lt;span style="color:#e6db74"> mcr.microsoft.com/dotnet/sdk:7.0-alpine AS build &lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">COPY&lt;/span> &lt;span style="color:#f92672">[&lt;/span>&lt;span style="color:#e6db74">&amp;#34;Slot.API/Slot.API.csproj&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Slot.API/&amp;#34;&lt;/span>&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">RUN&lt;/span> dotnet restore &lt;span style="color:#e6db74">&amp;#34;Slot.API/Slot.API.csproj&amp;#34;&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">COPY&lt;/span> . . &lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">WORKDIR&lt;/span>&lt;span style="color:#e6db74"> &amp;#34;/Slot.API&amp;#34; &lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">RUN&lt;/span> dotnet build &lt;span style="color:#e6db74">&amp;#34;Slot.API.csproj&amp;#34;&lt;/span> -c Release -o /app/build &lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">FROM&lt;/span>&lt;span style="color:#e6db74"> build AS publish &lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">RUN&lt;/span> dotnet publish &lt;span style="color:#e6db74">&amp;#34;Slot.API.csproj&amp;#34;&lt;/span> -c Release -o /app/publish /p:UseAppHost&lt;span style="color:#f92672">=&lt;/span>false &lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">FROM&lt;/span>&lt;span style="color:#e6db74"> base AS final &lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">WORKDIR&lt;/span>&lt;span style="color:#e6db74"> /app &lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">COPY&lt;/span> --from&lt;span style="color:#f92672">=&lt;/span>publish /app/publish . &lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">ENV&lt;/span> ASPNETCORE_URLS&lt;span style="color:#f92672">=&lt;/span>http://*:8080 &lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">ENV&lt;/span> ASPNETCORE_ENVIRONMENT&lt;span style="color:#f92672">=&lt;/span>Production
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">ENTRYPOINT&lt;/span> [&lt;span style="color:#e6db74">&amp;#34;dotnet&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Slot.API.dll&amp;#34;&lt;/span>]&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>AÅŸaÄŸÄ±daki iki komutu kullanarak imajÄ± baÅŸarÄ±yla oluÅŸturup container&amp;rsquo;Ä± build edip Ã§alÄ±ÅŸtÄ±rabiliriz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>docker build -t deployment-slots-demo .
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker run -it -p 80:8080 deployment-slots-demo -n deployment-slots-demo-container
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="uygulamanÄ±n-Ã§alÄ±ÅŸÄ±yor-olduÄŸunu-doÄŸrulayÄ±n">UygulamanÄ±n Ã‡alÄ±ÅŸÄ±yor OlduÄŸunu DoÄŸrulayÄ±n&lt;/h2>
&lt;p>Ã–nceki adÄ±mda saÄŸlÄ±k kontrolÃ¼ Ã¶zelliÄŸi ile uygulamamÄ±zÄ± oluÅŸturduktan sonra, bu adrese her saniye bir istek yaparak uygulamanÄ±n eriÅŸilebilir olduÄŸunu doÄŸrulayabiliriz. Bu ÅŸekilde, Azure&amp;rsquo;a daÄŸÄ±tÄ±ldÄ±ÄŸÄ±nda eriÅŸilebilir olduÄŸunu doÄŸrulamÄ±ÅŸ olacaÄŸÄ±z.&lt;/p>
&lt;p>Bu bÃ¶lÃ¼mde, uygulamanÄ±n her 50 milisaniyede bir istek yaparak eriÅŸilebilir olup olmadÄ±ÄŸÄ±nÄ± doÄŸrulamak iÃ§in basit bir Node.js script&amp;rsquo;i yazacaÄŸÄ±z. Bunun iÃ§in aÅŸaÄŸÄ±daki komutlarÄ± kullanÄ±yoruz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>mkdir health-check
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>npm init -y
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>touch index.js
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>npm install node-fetch
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>AÅŸaÄŸÄ±daki kÄ±smÄ± package.json dosyasÄ±na ekliyoruz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#e6db74">&amp;#34;scripts&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;start&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;node index.js&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;span style="color:#960050;background-color:#1e0010">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;type&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;module&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>index.js dosyamÄ±zÄ± aÅŸaÄŸÄ±daki gibi oluÅŸturabiliriz. Bu kod ile belirtilen url&amp;rsquo;e her 50 milisaniyede bir istek yapacak ve yanÄ±tÄ± konsola yazacaktÄ±r.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> &lt;span style="color:#a6e22e">fetch&lt;/span> &lt;span style="color:#a6e22e">from&lt;/span> &lt;span style="color:#e6db74">&amp;#34;node-fetch&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> (&lt;span style="color:#a6e22e">url&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">try&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">fetch&lt;/span>(&lt;span style="color:#a6e22e">url&lt;/span>, {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">method&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;GET&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">response&lt;/span>.&lt;span style="color:#a6e22e">text&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">result&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Healthy&amp;#34;&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#66d9ef">new&lt;/span> Date().&lt;span style="color:#a6e22e">toISOString&lt;/span>()&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">, &lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">url&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74"> result is not OK`&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">catch&lt;/span> (&lt;span style="color:#a6e22e">error&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#66d9ef">new&lt;/span> Date().&lt;span style="color:#a6e22e">toISOString&lt;/span>()&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">, &lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">url&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74"> error is &lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">error&lt;/span>.&lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">`&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">setInterval&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">check&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;http://localhost:5050/health&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }, &lt;span style="color:#ae81ff">50&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">setInterval&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">check&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;http://localhost:5050/health&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }, &lt;span style="color:#ae81ff">50&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>})();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>API projemizde UseHttpsRedirection middleware&amp;rsquo;ini kapatmazsanÄ±z, geÃ§ersiz bir SSL sertifikasÄ± hatasÄ± alabilirsiniz. Bunu aÅŸaÄŸÄ±daki gibi dÃ¼zeltebilirsiniz.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> &lt;span style="color:#a6e22e">fetch&lt;/span> &lt;span style="color:#a6e22e">from&lt;/span> &lt;span style="color:#e6db74">&amp;#34;node-fetch&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> &lt;span style="color:#a6e22e">https&lt;/span> &lt;span style="color:#a6e22e">from&lt;/span> &lt;span style="color:#e6db74">&amp;#34;https&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">httpsAgent&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">https&lt;/span>.&lt;span style="color:#a6e22e">Agent&lt;/span>({
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">rejectUnauthorized&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>});
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> (&lt;span style="color:#a6e22e">url&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">try&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">fetch&lt;/span>(&lt;span style="color:#a6e22e">url&lt;/span>, {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">method&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;GET&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">agent&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">httpsAgent&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">response&lt;/span>.&lt;span style="color:#a6e22e">text&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">result&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Healthy&amp;#34;&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#66d9ef">new&lt;/span> Date().&lt;span style="color:#a6e22e">toISOString&lt;/span>()&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">, &lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">url&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74"> result is not OK`&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">catch&lt;/span> (&lt;span style="color:#a6e22e">error&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#66d9ef">new&lt;/span> Date().&lt;span style="color:#a6e22e">toISOString&lt;/span>()&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">, &lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">url&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74"> error is &lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">error&lt;/span>.&lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">`&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">setInterval&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">check&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;https://localhost:5051/health&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }, &lt;span style="color:#ae81ff">50&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">setInterval&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">check&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;https://localhost:5051/health&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }, &lt;span style="color:#ae81ff">50&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>})();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="azure-devops-repo">Azure DevOps Repo&lt;/h2>
&lt;p>Azure DevOps hesabÄ±mÄ±za giriÅŸ yapÄ±yoruz ve aÅŸaÄŸÄ±daki gibi yeni bir repo oluÅŸturuyoruz.&lt;/p>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-1.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-2.webp" alt="Azure deployment" loading="lazy" />
&lt;p>Bu repo&amp;rsquo;yu bilgisayarÄ±mÄ±za klonluyoruz, yazdÄ±ÄŸÄ±mÄ±z kodu bu repo klasÃ¶rÃ¼ne taÅŸÄ±yoruz ve kodlarÄ± origin&amp;rsquo;e iletiyoruz.&lt;/p>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-3.webp" alt="Azure deployment" loading="lazy" />
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>git add .
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git commit -m &lt;span style="color:#e6db74">&amp;#34;inital commit&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git push origin
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-4.webp" alt="Azure deployment" loading="lazy" />
&lt;h2 id="azure-devops-build-pipeline">Azure DevOps build pipeline&lt;/h2>
&lt;p>Pipeline ekranÄ±nda, en saÄŸ Ã¼stteki New pipeline dÃ¼ÄŸmesine tÄ±klÄ±yoruz. ArdÄ±ndan aÅŸaÄŸÄ±daki adÄ±mlarÄ± izleyerek docker dosyasÄ±nÄ± oluÅŸturup ve Azure Container Registry&amp;rsquo;e iteleriyoruz.&lt;/p>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-5.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-6.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-7.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-8.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-9.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-10.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-11.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-12.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-13.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-14.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-15.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-16.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-17.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-18.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-19.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-20.webp" alt="Azure deployment" loading="lazy" />
&lt;p>Åžimdi Azure Container Registry&amp;rsquo;de image deployment iÅŸlemimizin baÅŸarÄ±lÄ± olduÄŸunu kontrol ediyoruz.&lt;/p>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-21.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-22.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-23.webp" alt="Azure deployment" loading="lazy" />
&lt;p>GÃ¶rÃ¼ldÃ¼ÄŸÃ¼ gibi, boru hattÄ± Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±ÄŸÄ±nda, Docker image&amp;rsquo;i baÅŸarÄ±yla Azure Container Registry&amp;rsquo;de oluÅŸturulmuÅŸ ve kullanÄ±lmak Ã¼zere bizi bekliyor. Bu ayarlarÄ±n ardÄ±ndan, main branch&amp;rsquo;de /backend dizininde yapÄ±lan her deÄŸiÅŸiklik ile tetiklenerek yeni bir Docker image&amp;rsquo;i oluÅŸturulacak.&lt;/p>
&lt;h2 id="azure-app-service">Azure App service&lt;/h2>
&lt;p>Azure App servisi, gÃ¼venlik, yÃ¼k dengeleme, otomatik Ã¶lÃ§eklendirme gibi Ã¶zellikleriyle Azure tarafÄ±ndan yÃ¶netilen web uygulamalarÄ±nÄ± daÄŸÄ±tmamÄ±za olanak tanÄ±r. Azure app servisleri ekranÄ± Ã¼zerinden yeni bir app servisi oluÅŸturabiliriz.&lt;/p>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-24.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-25.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-26.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-27.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-28.webp" alt="Azure deployment" loading="lazy" />
&lt;p>App servisini oluÅŸturduktan sonra, Container Registry ÅŸifresini yapÄ±landÄ±rma sekmesinden gÃ¼ncellemeniz gerekebilir.&lt;/p>
&lt;p>##Â Azure DevOps release pipeline&lt;/p>
&lt;p>release pipeline ile, build pipeline tarafÄ±ndan oluÅŸturulan Docker image&amp;rsquo;i kullanarak App servisine deploy edilir ve uygulamamÄ±zÄ± yayÄ±nlamÄ±ÅŸ oluruz.&lt;/p>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-29.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-30.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-31.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-32.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-33.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-34.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-35.webp" alt="Azure deployment" loading="lazy" />
&lt;p>Staging daÄŸÄ±tÄ±mÄ±na girdiÄŸimizde, staging versiyonumuz iÃ§in daÄŸÄ±tÄ±m alÄ±rÄ±z ve Docker image&amp;rsquo;inde yaptÄ±ÄŸÄ±mÄ±z deÄŸiÅŸikliklerin canlÄ± hale gelmesini saÄŸlamak iÃ§in uygulama servisimizi yeniden baÅŸlatÄ±rÄ±z.&lt;/p>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-36.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-37.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-38.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-39.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-40.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-41.webp" alt="Azure deployment" loading="lazy" />
&lt;p>production aÅŸamasÄ±nda, app service&amp;rsquo;de bir deployment yapmÄ±yoruz, bunun yerine staging aÅŸamasÄ±yla deÄŸiÅŸim iÅŸlemini gerÃ§ekleÅŸtiriyoruz ve bu ÅŸekilde, production eriÅŸiminde herhangi bir kesinti yaÅŸamadan staging&amp;rsquo;de Ã§alÄ±ÅŸan uygulamamÄ±zÄ± production ile deÄŸiÅŸtirdiÄŸimiz iÃ§in production uygulamamÄ±za eriÅŸebiliyoruz.&lt;/p>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-42.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-43.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-44.webp" alt="Azure deployment" loading="lazy" />
&lt;br/>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-45.webp" alt="Azure deployment" loading="lazy" />
&lt;p>Åžimdi, main bracnh&amp;rsquo;te yapÄ±lan herhangi bir deÄŸiÅŸiklik Ã¶nce build pipeline (CI) ile geÃ§ecek, ardÄ±ndan release pipeline (CD) geÃ§ecek ve release, staging ortamÄ±na yapÄ±lacak. Production ortamÄ±na geÃ§mek isterseniz, production deployment iÅŸlemi manuel olarak release ekranÄ±ndan tetiklenmelidir.&lt;/p>
&lt;img src="https://berkselvi.dev/img/achieving-zero-downtime-azure-app-service-deployment-using-azure-devops-and-deployment-slots/azure-deployment-46.webp" alt="Azure deployment" loading="lazy" />
&lt;h2 id="zero-downtime-testing">Zero downtime testing&lt;/h2>
&lt;p>UygulamamÄ±z iÃ§in gerekli pipeline&amp;rsquo;larÄ± baÅŸarÄ±yla oluÅŸturduk, bundan sonra release sÄ±rasÄ±nda herhangi bir kesinti olup olmadÄ±ÄŸÄ±nÄ± test etmemiz gerekecek. Bunun iÃ§in &lt;em>health-check/index.js&lt;/em> dosyamÄ±zÄ± aÅŸaÄŸÄ±daki gibi gÃ¼ncelliyorum ve uygulamayÄ± npm run start komutuyla Ã§alÄ±ÅŸtÄ±rÄ±p pipeline&amp;rsquo;Ä± tetikliyorum. ArdÄ±ndan, konsolda herhangi bir hata mesajÄ± almadan, yani herhangi bir kesinti olmadan deployment sÃ¼recini tamamlÄ±yorum!&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> &lt;span style="color:#a6e22e">fetch&lt;/span> &lt;span style="color:#a6e22e">from&lt;/span> &lt;span style="color:#e6db74">&amp;#34;node-fetch&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> (&lt;span style="color:#a6e22e">url&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">try&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">fetch&lt;/span>(&lt;span style="color:#a6e22e">url&lt;/span>, {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">method&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;GET&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">response&lt;/span>.&lt;span style="color:#a6e22e">text&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">result&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Healthy&amp;#34;&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#66d9ef">new&lt;/span> Date().&lt;span style="color:#a6e22e">toISOString&lt;/span>()&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">, &lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">url&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74"> result is not OK`&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">catch&lt;/span> (&lt;span style="color:#a6e22e">error&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#66d9ef">new&lt;/span> Date().&lt;span style="color:#a6e22e">toISOString&lt;/span>()&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">, &lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">url&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74"> error is &lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">error&lt;/span>.&lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">`&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">setInterval&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">check&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;https://deployment-slot-demo.azurewebsites.net/health&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }, &lt;span style="color:#ae81ff">50&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">setInterval&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">check&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;https://deployment-slot-demo-staging.azurewebsites.net/health&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }, &lt;span style="color:#ae81ff">50&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>})();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Benzer bir iÅŸlemi deployment slots Ã¶zelliÄŸi uygulamayan bir App Service ile denersek, aÅŸaÄŸÄ±daki gibi bir hata alÄ±rÄ±z.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>2023-11-14T12:28:39.506Z, &lt;span style="color:#f92672">[&lt;/span>some-url&lt;span style="color:#f92672">]&lt;/span>/health error is request to &lt;span style="color:#f92672">[&lt;/span>some-url&lt;span style="color:#f92672">]&lt;/span>/health failed, reason: connect ETIMEDOUT 100.100.100.100:443
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;h2 id="sonuÃ§">SonuÃ§&lt;/h2>
&lt;p>OkuduÄŸunuz iÃ§in teÅŸekkÃ¼rler! ðŸŽ‰ YazÄ±lÄ±m geliÅŸtirme alanÄ±ndaki araÅŸtÄ±rmalarÄ±mÄ± kaÃ§Ä±rmamak iÃ§in &lt;a href="https://x.com/berkslv">@berkslv&lt;/a> adresinden takipte kalabilirsiniz.&lt;/p></content></item><item><title>React-router-dom kullanarak bir React uygulamasÄ±nÄ± Docker ile Nginx'e nasÄ±l deploy ederiz?</title><link>https://berkselvi.dev/tr/posts/how-to-deploy-a-react-app-with-nginx-using-docker-with-react-router-dom/</link><pubDate>Sat, 21 Jan 2023 00:00:00 +0300</pubDate><guid>https://berkselvi.dev/tr/posts/how-to-deploy-a-react-app-with-nginx-using-docker-with-react-router-dom/</guid><description>&lt;p>Bir React uygulamasÄ±nÄ± deploy etmek istiyorsanÄ±z, web sunucusuna deployment veya Docker gibi bir container aracÄ± kullanma gibi birkaÃ§ seÃ§enek mevcuttur. Bu kÄ±lavuzda, bir React uygulamasÄ±nÄ± Nginx kullanarak Docker ile nasÄ±l deploy edebileceÄŸimizi gÃ¶receÄŸiz. Nginx, yÃ¼ksek performansÄ± ve dÃ¼ÅŸÃ¼k kaynak kullanÄ±mÄ± ile tanÄ±nan popÃ¼ler bir aÃ§Ä±k kaynaklÄ± web sunucusudur. React uygulamamÄ±z iÃ§in bir Docker dosyasÄ± oluÅŸturacaÄŸÄ±z ve uygulamayÄ± sunmak iÃ§in Nginx&amp;rsquo;i kullanacaÄŸÄ±z. AyrÄ±ca, Nginx&amp;rsquo;e uygulamayÄ± nasÄ±l sunacaÄŸÄ±nÄ± sÃ¶ylemek iÃ§in bir Nginx yapÄ±landÄ±rma dosyasÄ± da oluÅŸturacaÄŸÄ±z. Son olarak, uygulamamÄ±zÄ±n bir Docker image&amp;rsquo;ini oluÅŸturacak ve uygulamayÄ± deploy etmek iÃ§in bir Docker container Ã§alÄ±ÅŸtÄ±racaÄŸÄ±z.&lt;/p></description><content>&lt;p>Bir React uygulamasÄ±nÄ± deploy etmek istiyorsanÄ±z, web sunucusuna deployment veya Docker gibi bir container aracÄ± kullanma gibi birkaÃ§ seÃ§enek mevcuttur. Bu kÄ±lavuzda, bir React uygulamasÄ±nÄ± Nginx kullanarak Docker ile nasÄ±l deploy edebileceÄŸimizi gÃ¶receÄŸiz. Nginx, yÃ¼ksek performansÄ± ve dÃ¼ÅŸÃ¼k kaynak kullanÄ±mÄ± ile tanÄ±nan popÃ¼ler bir aÃ§Ä±k kaynaklÄ± web sunucusudur. React uygulamamÄ±z iÃ§in bir Docker dosyasÄ± oluÅŸturacaÄŸÄ±z ve uygulamayÄ± sunmak iÃ§in Nginx&amp;rsquo;i kullanacaÄŸÄ±z. AyrÄ±ca, Nginx&amp;rsquo;e uygulamayÄ± nasÄ±l sunacaÄŸÄ±nÄ± sÃ¶ylemek iÃ§in bir Nginx yapÄ±landÄ±rma dosyasÄ± da oluÅŸturacaÄŸÄ±z. Son olarak, uygulamamÄ±zÄ±n bir Docker image&amp;rsquo;ini oluÅŸturacak ve uygulamayÄ± deploy etmek iÃ§in bir Docker container Ã§alÄ±ÅŸtÄ±racaÄŸÄ±z.&lt;/p>
&lt;h2 id="Ã¶nkoÅŸullar">Ã–nkoÅŸullar:&lt;/h2>
&lt;ul>
&lt;li>Docker hakkÄ±nda temel bir bilgi&lt;/li>
&lt;li>Deploy edilecek bir React uygulamasÄ±&lt;/li>
&lt;/ul>
&lt;h2 id="step-1-create-a-dockerfile">Step 1: Create a Dockerfile&lt;/h2>
&lt;p>Ä°lk adÄ±m, React uygulamamÄ±z iÃ§in bir Docker dosyasÄ± oluÅŸturmaktÄ±r. Bu dosya, uygulamamÄ±zÄ±n bir Docker gÃ¶rÃ¼ntÃ¼sÃ¼nÃ¼ nasÄ±l oluÅŸturacaÄŸÄ±mÄ±za dair talimatlar iÃ§erecektir. Ä°ÅŸte Nginx ile bir React uygulamasÄ± iÃ§in bir Docker dosyasÄ± Ã¶rneÄŸi:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-Dockerfile" data-lang="Dockerfile">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Use an official Node runtime as a parent image&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">FROM&lt;/span>&lt;span style="color:#e6db74"> node:19-alpine as build&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># Set the working directory to /app&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">WORKDIR&lt;/span>&lt;span style="color:#e6db74"> /app&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># Copy the package.json and package-lock.json to the container&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">COPY&lt;/span> package*.json ./&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># Install dependencies&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">RUN&lt;/span> npm install&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># Copy the rest of the application code to the container&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">COPY&lt;/span> . .&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># Build the React app&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">RUN&lt;/span> npm run build&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># Use an official Nginx runtime as a parent image&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">FROM&lt;/span>&lt;span style="color:#e6db74"> nginx:1.21.0-alpine&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># Copy the ngnix.conf to the container&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">COPY&lt;/span> ngnix.conf /etc/nginx/conf.d/default.conf&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># Copy the React app build files to the container&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">COPY&lt;/span> --from&lt;span style="color:#f92672">=&lt;/span>build /app/build /usr/share/nginx/html&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># Expose port 80 for Nginx&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">EXPOSE&lt;/span>&lt;span style="color:#e6db74"> 80&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># Start Nginx when the container starts&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">CMD&lt;/span> [&lt;span style="color:#e6db74">&amp;#34;nginx&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;-g&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;daemon off;&amp;#34;&lt;/span>]&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Bu Docker dosyasÄ±, offical Node runtime ana image&amp;rsquo;i olarak kullanarak React uygulamasÄ±nÄ± kurmak ve derlemek iÃ§in kullanÄ±r. Daha sonra React uygulamasÄ±nÄ± sunmak iÃ§in resmi Nginx runtime ana image&amp;rsquo;ini base olarak kullanÄ±r.&lt;/p>
&lt;h1 id="step-2-create-an-nginx-configuration-file">Step 2: Create an Nginx configuration file&lt;/h1>
&lt;p>Sonraki adÄ±m olarak, Nginx&amp;rsquo;e uygulamamÄ±zÄ± nasÄ±l sunacaÄŸÄ±nÄ± sÃ¶ylemek iÃ§in bir Nginx yapÄ±landÄ±rma dosyasÄ± oluÅŸturmamÄ±z gerekiyor. Ä°ÅŸte bir Ã¶rnek yapÄ±landÄ±rma dosyasÄ±:&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-conf" data-lang="conf">server {
listen 80;
server_name example.com;
root /usr/share/nginx/html;
index index.html;
location / {
try_files $uri $uri/ /index.html;
}
}
&lt;/code>&lt;/pre>&lt;p>&lt;strong>Bu &lt;code>nginx.conf&lt;/code> dosyasÄ±nÄ± Dockerfile ile aynÄ± dizine oluÅŸturmalÄ±sÄ±nÄ±z.&lt;/strong> Bu yapÄ±landÄ±rma dosyasÄ±, Nginx&amp;rsquo;in port 80&amp;rsquo;de dinlemesini ve React uygulamasÄ±nÄ± sunmasÄ±nÄ± saÄŸlar. try_files yÃ¶nergesi, Nginx&amp;rsquo;e istenen dosyayÄ± sunmaya Ã§alÄ±ÅŸmasÄ±nÄ±, ardÄ±ndan dosyayÄ± iÃ§eren dizini ve son olarak istenen dosya veya dizin mevcut deÄŸilse index.html dosyasÄ±nÄ± sunmaya Ã§alÄ±ÅŸmasÄ±nÄ± sÃ¶yler.&lt;/p>
&lt;h1 id="step-3-build-the-docker-image">Step 3: Build the Docker image&lt;/h1>
&lt;p>Docker dosyasÄ± ve Nginx yapÄ±landÄ±rma dosyasÄ± oluÅŸturulduktan sonra, ÅŸimdi Docker image&amp;rsquo;i oluÅŸturabiliriz. Docker dosyasÄ±nÄ± iÃ§eren dizine gidin ve aÅŸaÄŸÄ±daki komutu Ã§alÄ±ÅŸtÄ±rÄ±n:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>docker build -t my-react-app .
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Bu komut, Docker&amp;rsquo;a mevcut dizindeki Docker dosyasÄ±nÄ± kullanarak bir image oluÅŸturmasÄ±nÄ± ve ona my-react-app adÄ±nÄ± etiketlemesini sÃ¶yler. Komutun sonundaki nokta, Docker&amp;rsquo;Ä±n oluÅŸturma baÄŸlamÄ± olarak mevcut dizini kullanmasÄ±nÄ± saÄŸlar.&lt;/p>
&lt;h1 id="step-4-run-the-docker-container">Step 4: Run the Docker container&lt;/h1>
&lt;p>OluÅŸturulan Docker gÃ¶rÃ¼ntÃ¼sÃ¼yle ÅŸimdi aÅŸaÄŸÄ±daki komutu kullanarak bir container Ã§alÄ±ÅŸtÄ±rabiliriz:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>docker run -p 80:80 my-react-app
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Bu komut, my-react-app Docker gÃ¶rÃ¼ntÃ¼sÃ¼nden bir konteyner oluÅŸturur ve konteynerdeki 80 numaralÄ± baÄŸlantÄ± noktasÄ±nÄ± ana makinedeki 80 numaralÄ± baÄŸlantÄ± noktasÄ±na eÅŸler. ArdÄ±ndan, web tarayÄ±cÄ±nÄ±zda http://localhost adresine giderek React uygulamanÄ±za eriÅŸebilirsiniz.&lt;/p>
&lt;p>Tebrikler, bir React uygulamasÄ±nÄ± Nginx kullanarak Docker ile baÅŸarÄ±yla daÄŸÄ±ttÄ±nÄ±z! ArtÄ±k bu yÃ¶ntemi kullanarak React uygulamalarÄ±nÄ±zÄ± Docker&amp;rsquo;Ä± destekleyen herhangi bir sunucuya veya sunucu platformuna kolayca deploy edebilirsiniz.&lt;/p>
&lt;h1 id="step-5-use-docker-compose-to-deploy-the-app">Step 5: Use Docker Compose to deploy the app&lt;/h1>
&lt;p>UygulamanÄ±zÄ± deploy etmek iÃ§in daha basit bir yaklaÅŸÄ±mÄ± tercih ediyorsanÄ±z, container&amp;rsquo;larÄ±nÄ±zÄ± yÃ¶netmek iÃ§in Docker Compose&amp;rsquo;u kullanabilirsiniz. Docker Compose, Ã§oklu container Docker uygulamalarÄ±nÄ± tanÄ±mlamanÄ±za ve Ã§alÄ±ÅŸtÄ±rmanÄ±za olanak tanÄ±yan bir araÃ§tÄ±r.&lt;/p>
&lt;p>Docker Compose&amp;rsquo;u kullanmak iÃ§in, projenizin root dizininde bir docker-compose.yml dosyasÄ± oluÅŸturmanÄ±z gerekecektir. Ä°ÅŸte Ã¶nceki Docker dosyasÄ±yla kullanabileceÄŸiniz bir Ã¶rnek docker-compose.yml dosyasÄ±:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">version&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;3&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">services&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">my-react-app&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">build&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">context&lt;/span>: &lt;span style="color:#ae81ff">.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dockerfile&lt;/span>: &lt;span style="color:#ae81ff">Dockerfile&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ports&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;80:80&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./ngnix.conf:/etc/nginx/conf.d/default.conf&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Bu docker-compose.yml dosyasÄ±nda, my-react-app adÄ±nda tek bir servis tanÄ±mlÄ±yoruz. OluÅŸturma baÄŸlamÄ±nÄ± (.) ve Docker dosyasÄ±nÄ±n adÄ±nÄ± Dockerfile olarak belirtiyoruz. AyrÄ±ca, konteynerdeki 80 numaralÄ± baÄŸlantÄ± noktasÄ±nÄ± ana makinedeki 80 numaralÄ± baÄŸlantÄ± noktasÄ±na ports yapÄ±landÄ±rmasÄ± kullanarak eÅŸleriz.&lt;/p>
&lt;p>Son olarak, ana makinedeki ngnix.conf dosyasÄ±nÄ± konteynerin Nginx yapÄ±landÄ±rma dizinindeki default.conf dosyasÄ±na eÅŸleyen bir volume baÄŸlarÄ±z. Bu, Docker gÃ¶rÃ¼ntÃ¼sÃ¼nÃ¼ yeniden oluÅŸturmadan Nginx yapÄ±landÄ±rmasÄ±nÄ± Ã¶zelleÅŸtirmemizi saÄŸlar.&lt;/p>
&lt;p>Bu docker-compose.yml dosyasÄ±nÄ± kullanmak iÃ§in, sadece dosyayÄ± iÃ§eren dizine gidin ve aÅŸaÄŸÄ±daki komutu Ã§alÄ±ÅŸtÄ±rÄ±n:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker-compose up -d
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Bu komut, Docker Compose&amp;rsquo;un my-react-app servisini Docker dosyasÄ±nÄ± kullanarak oluÅŸturmasÄ±nÄ± ve bir konteyner Ã§alÄ±ÅŸtÄ±rmasÄ±nÄ± sÃ¶yler. -d bayraÄŸÄ±, konteynerin arka planda Ã§alÄ±ÅŸmasÄ±nÄ± saÄŸlayan detached modunda Ã§alÄ±ÅŸtÄ±rÄ±r. ArdÄ±ndan, web tarayÄ±cÄ±nÄ±zda http://localhost adresine giderek React uygulamanÄ±za eriÅŸebilirsiniz.&lt;/p>
&lt;p>Tebrikler! Bir React uygulamasÄ±nÄ± Nginx kullanarak Docker ve Docker Compose ile baÅŸarÄ±yla daÄŸÄ±ttÄ±nÄ±z. ArtÄ±k React uygulamalarÄ±nÄ±zÄ± Docker&amp;rsquo;Ä± destekleyen herhangi bir sunucuya veya barÄ±ndÄ±rma platformuna kolayca daÄŸÄ±tabilirsiniz.&lt;/p>
&lt;hr>
&lt;h2 id="sonuÃ§">SonuÃ§&lt;/h2>
&lt;p>OkuduÄŸunuz iÃ§in teÅŸekkÃ¼rler! ðŸŽ‰ YazÄ±lÄ±m geliÅŸtirme alanÄ±ndaki araÅŸtÄ±rmalarÄ±mÄ± kaÃ§Ä±rmamak iÃ§in &lt;a href="https://x.com/berkslv">@berkslv&lt;/a> adresinden takipte kalabilirsiniz.&lt;/p></content></item><item><title>Bir ÅŸey nasÄ±l Ã§ok iyi Ã¶ÄŸrenilir</title><link>https://berkselvi.dev/tr/posts/how-to-learn-something-very-well/</link><pubDate>Wed, 09 Mar 2022 10:01:10 +0300</pubDate><guid>https://berkselvi.dev/tr/posts/how-to-learn-something-very-well/</guid><description>&lt;p>NasÄ±l Ã¶ÄŸreneceÄŸinizi Ã¶ÄŸrendiÄŸinizde, bilgi ile dÃ¼nyadaki hemen hemen tÃ¼m olasÄ±lÄ±klarÄ±n kilidini aÃ§arsÄ±nÄ±z. BazÄ±larÄ±nÄ±z pratiÄŸin bilgiden daha Ã¶nemli olduÄŸunu dÃ¼ÅŸÃ¼nebilir, ama inanÄ±n bana, Ã§alÄ±ÅŸma alanÄ±nÄ±z hakkÄ±nda bir ÅŸey bilmiyorsanÄ±z, pratik yapamazsÄ±nÄ±z ve yapabilirseniz de iÅŸe yaramaz Ã§Ã¼nkÃ¼ altta yatan sÃ¼reÃ§leri bilmiyorsunuzdur.&lt;/p>
&lt;p>Bu kÄ±lavuz basit ve sonuÃ§ odaklÄ±dÄ±r, &lt;a href="https://www.goodreads.com/book/show/18770267-make-it-stick">bu harika kitapla&lt;/a> konu hakkÄ±nda daha fazla bilgi edinebilirsiniz.&lt;/p>
&lt;h2 id="Ã¶ÄŸrenmeden-Ã¶nce">Ã–ÄŸrenmeden Ã¶nce&lt;/h2>
&lt;p>Zihin sabit deÄŸildir ve geliÅŸtirilebilir, sadece zihin ve IQ deÄŸil, entelektÃ¼el beceriler de Ã§alÄ±ÅŸarak geliÅŸtirilebilir. Her ÅŸeyden Ã¶nce saÄŸlam bir Ã¶z disipline sahip olmalÄ±sÄ±nÄ±z, bu farklÄ± ÅŸekillerde kazanÄ±labilir, ancak kendi yolunuzu bulmalÄ± ve izlemelisiniz. Dilerseniz askeri disiplin yÃ¶ntemlerini takip edebilir, dilerseniz UzakdoÄŸu felsefelerine sadÄ±k kalabilirsiniz. Tamamen size kalmÄ±ÅŸ.&lt;/p></description><content>&lt;p>NasÄ±l Ã¶ÄŸreneceÄŸinizi Ã¶ÄŸrendiÄŸinizde, bilgi ile dÃ¼nyadaki hemen hemen tÃ¼m olasÄ±lÄ±klarÄ±n kilidini aÃ§arsÄ±nÄ±z. BazÄ±larÄ±nÄ±z pratiÄŸin bilgiden daha Ã¶nemli olduÄŸunu dÃ¼ÅŸÃ¼nebilir, ama inanÄ±n bana, Ã§alÄ±ÅŸma alanÄ±nÄ±z hakkÄ±nda bir ÅŸey bilmiyorsanÄ±z, pratik yapamazsÄ±nÄ±z ve yapabilirseniz de iÅŸe yaramaz Ã§Ã¼nkÃ¼ altta yatan sÃ¼reÃ§leri bilmiyorsunuzdur.&lt;/p>
&lt;p>Bu kÄ±lavuz basit ve sonuÃ§ odaklÄ±dÄ±r, &lt;a href="https://www.goodreads.com/book/show/18770267-make-it-stick">bu harika kitapla&lt;/a> konu hakkÄ±nda daha fazla bilgi edinebilirsiniz.&lt;/p>
&lt;h2 id="Ã¶ÄŸrenmeden-Ã¶nce">Ã–ÄŸrenmeden Ã¶nce&lt;/h2>
&lt;p>Zihin sabit deÄŸildir ve geliÅŸtirilebilir, sadece zihin ve IQ deÄŸil, entelektÃ¼el beceriler de Ã§alÄ±ÅŸarak geliÅŸtirilebilir. Her ÅŸeyden Ã¶nce saÄŸlam bir Ã¶z disipline sahip olmalÄ±sÄ±nÄ±z, bu farklÄ± ÅŸekillerde kazanÄ±labilir, ancak kendi yolunuzu bulmalÄ± ve izlemelisiniz. Dilerseniz askeri disiplin yÃ¶ntemlerini takip edebilir, dilerseniz UzakdoÄŸu felsefelerine sadÄ±k kalabilirsiniz. Tamamen size kalmÄ±ÅŸ.&lt;/p>
&lt;p>Ve unutmayÄ±n, para gibi deÄŸerli ÅŸeyler birikir. Buna bilgi de dahildir ve ne kadar Ã§ok yeni ÅŸeyler Ã¶ÄŸrenirseniz, yeni ÅŸeyleri Ã¶ÄŸrenmek ve anlamlandÄ±rmak o kadar kolay olur.&lt;/p>
&lt;h2 id="Ã¶ÄŸrenmek-deÄŸil">Ã–ÄŸrenmek deÄŸil&lt;/h2>
&lt;p>AynÄ± konuyu tekrar tekrar Ã§alÄ±ÅŸmak, aynÄ± ÅŸeyleri tekrar tekrar okumak Ã¶ÄŸrenme hissi yaratabilir ama bu bÃ¼yÃ¼k ihtimalle yanlÄ±ÅŸ bir duygudur. Ã¶ÄŸrenme duygusu ve akÄ±cÄ±lÄ±k birbiriyle kolayca karÄ±ÅŸtÄ±rÄ±labilir.&lt;/p>
&lt;p>Kendinizi test etmeden devam etmeyin, bu ÅŸekilde Ã¶ÄŸrendiÄŸinizi dÃ¼ÅŸÃ¼nebilirsiniz, ancak bÃ¼yÃ¼k olasÄ±lÄ±kla bu da yanlÄ±ÅŸ bir duygu olacaktÄ±r.&lt;/p>
&lt;h2 id="yapÄ±lacak-ÅŸeyler">YapÄ±lacak ÅŸeyler&lt;/h2>
&lt;p>HafÄ±zadan hatÄ±rlama, tekrarlÄ± okuma gibi yÃ¶ntemlere gÃ¶re Ã§ok daha harika bir yÃ¶ntemdir. Makaleleri okurken cÃ¼mlelerin veya paragraflarÄ±n baÅŸÄ±nda durun ve â€œAna fikir nedir? Vermek istediÄŸiniz mesaj nedir?â€ Bunun gibi sorular sormak, geri arama yÃ¶ntemimiz iÃ§in harika bir uygulamadÄ±r. Bu sayede Ã¶ÄŸrenilen konularla ilgili zihinsel baÄŸlantÄ±lar gÃ¼Ã§lendirilecektir.&lt;/p>
&lt;p>BÃ¶lÃ¼m sonu sorularÄ± ve kendi oluÅŸturduÄŸunuz sorular harika Ã¶ÄŸrenme yÃ¶ntemleridir. Burada quizlerde ve sÄ±navlarda kullanÄ±labilir, Quizleri bir Ã¶ÄŸrenme aracÄ± olarak kullanmak tehlike aÃ§Ä±sÄ±ndan alÄ±ÅŸÄ±lmÄ±ÅŸÄ±n dÄ±ÅŸÄ±nda olabilir, ancak hatÄ±rlama iÃ§in Ã§ok iyi Ã§alÄ±ÅŸÄ±r ve sorulara verdiÄŸiniz cevaplar Ã¶nemlidir. Eksiklerinizi bu ÅŸekilde ortaya koyabilirsiniz ve bu alanlarÄ± tamamlamak sizi ileriye taÅŸÄ±yacaktÄ±r.&lt;/p>
&lt;p>Bu iki yÃ¶ntem tamamen geri arama (callback) ile ilgilidir. Geri Ã§aÄŸÄ±rma konusundaki son sÃ¶z, ne kadar zorlayÄ±cÄ± olursa, etkilerinin o kadar kalÄ±cÄ± olacaÄŸÄ±dÄ±r.&lt;/p>
&lt;p>Blok Ã§alÄ±ÅŸmanÄ±n kÄ±sa vadeli faydalarÄ±nÄ± kullanmak yerine, konuya aralÄ±klÄ± Ã§alÄ±ÅŸma ile yaklaÅŸmak bilgiyi daha kalÄ±cÄ± hale getirecektir. Gerekli aralÄ±k, Ã§alÄ±ÅŸÄ±lan konuya ve kiÅŸiye baÄŸlÄ±dÄ±r. 1 gÃ¼n, 1 hafta, 1 ay gibi. Bir konuyu periyodik olarak hatÄ±rlamaya Ã§alÄ±ÅŸmak, onu hafÄ±zada kalÄ±cÄ± kÄ±lar ve artÄ±k bir refleks gibi olur.&lt;/p>
&lt;p>Bir matematik konusuyla ilgili benzer sorularÄ± arka arkaya Ã§Ã¶zmek aÅŸinalÄ±k hissi yaratÄ±r, ancak uygulama sÄ±rasÄ±nda aynÄ± konudaki diÄŸer sorularla farklÄ±lÄ±klarÄ± ve benzerlikleri gÃ¶rmenize yardÄ±mcÄ± olmaz. SorularÄ± Ã§Ã¶zerken soru tekrarÄ± yaptÄ±ÄŸÄ±nÄ±zÄ± fark ederseniz hemen farklÄ± soru tÃ¼rlerine geÃ§in.&lt;/p>
&lt;p>Ã–ÄŸrendiÄŸiniz konuya yeni anlam katmanlarÄ± eklemek detaylandÄ±rmadÄ±r. Buna bir Ã¶rnek, bir konuyu not alÄ±rken kendi cÃ¼mlelerinizle ifade etmek ve gerÃ§ek hayatla iliÅŸkisini incelemektir. Yeni Ã¶ÄŸrenilen konunun daha Ã¶nce Ã¶ÄŸrendiklerinizle iliÅŸkisini incelemek Ã¶ÄŸrenmeyi artÄ±rÄ±r. Konuyu kendiniz ve hayatÄ±nÄ±z ile iliÅŸkilendirin.&lt;/p>
&lt;p>Ã–ÄŸrenmeden Ã¶nce Ã¼retin. Bir matematik sorusunu cevap verilmeden Ã¶nce bildiklerinizle Ã§Ã¶zmeye Ã§alÄ±ÅŸmak, Ã§Ã¶zÃ¼m anlatÄ±ldÄ±ktan sonra Ã§Ã¶zÃ¼mÃ¼ kavramanÄ±zÄ± ve hatÄ±rlamanÄ±zÄ± kolaylaÅŸtÄ±rÄ±r.&lt;/p>
&lt;p>Geri Ã§aÄŸÄ±rma ve detaylandÄ±rmayÄ± harmanlayÄ±n. Bir konu veya dersten sonra kendinize sorun, â€œNasÄ±l gitti? Daha iyi olabilir mi? Bu sana geÃ§miÅŸten bir ÅŸey hatÄ±rlatÄ±yor mu?â€ Bunun gibi sorular sormak Ã¶ÄŸrenmeye yardÄ±mcÄ± olur ve buna &lt;strong>yansÄ±tma&lt;/strong> denir.&lt;/p>
&lt;hr>
&lt;h2 id="sonuÃ§">SonuÃ§&lt;/h2>
&lt;p>OkuduÄŸunuz iÃ§in teÅŸekkÃ¼rler! ðŸŽ‰ YazÄ±lÄ±m geliÅŸtirme alanÄ±ndaki araÅŸtÄ±rmalarÄ±mÄ± kaÃ§Ä±rmamak iÃ§in &lt;a href="https://x.com/berkslv">@berkslv&lt;/a> adresinden takipte kalabilirsiniz.&lt;/p></content></item><item><title>Her GeliÅŸtiricinin Sahip OlmasÄ± Gereken 5 Temel Felsefe</title><link>https://berkselvi.dev/tr/posts/5-core-philosophies-that-every-developer-should-have/</link><pubDate>Sun, 26 Sep 2021 00:00:00 +0300</pubDate><guid>https://berkselvi.dev/tr/posts/5-core-philosophies-that-every-developer-should-have/</guid><description>&lt;p>Ben kendim, yazÄ±lÄ±mÄ±n bir iÅŸten Ã¶nce bir yaÅŸam felsefesi olduÄŸunu dÃ¼ÅŸÃ¼nÃ¼yorum ve Ã§oÄŸu sorunu bir yazÄ±lÄ±m geliÅŸtirici olarak yaklaÅŸarak ve bu ÅŸekilde Ã§Ã¶zerek bÃ¼yÃ¼k keyif alÄ±yorum. Bu makalede, bu felsefenin temel taÅŸlarÄ±ndan bahsedeceÄŸim.&lt;/p>
&lt;h2 id="iÃ§indekiler">Ä°Ã§indekiler&lt;/h2>
&lt;ul>
&lt;li>Sorumlu bir kiÅŸi olun&lt;/li>
&lt;li>Kodunuzda hiÃ§bir ÅŸeyi mahvetmeyin&lt;/li>
&lt;li>MÃ¼kemmeliyetÃ§i olmayÄ±n&lt;/li>
&lt;li>VarlÄ±ÄŸÄ±nÄ±z bilginizdir&lt;/li>
&lt;li>TopluluÄŸunuzu geliÅŸtirin!&lt;/li>
&lt;/ul>
&lt;h2 id="sorumlu-bir-kiÅŸi-olun">Sorumlu bir kiÅŸi olun&lt;/h2>
&lt;p>Bir programcÄ± olarak, yazdÄ±ÄŸÄ±nÄ±z JavaScript kodunda bir hata varsa, bu hatanÄ±n nedeninin C++ derleyicisi olduÄŸunu sÃ¶yleyemezsiniz. Bu saÃ§ma gelebilir, ancak bu durumu kendinize uyarlamayÄ± dÃ¼ÅŸÃ¼nÃ¼n!&lt;/p></description><content>&lt;p>Ben kendim, yazÄ±lÄ±mÄ±n bir iÅŸten Ã¶nce bir yaÅŸam felsefesi olduÄŸunu dÃ¼ÅŸÃ¼nÃ¼yorum ve Ã§oÄŸu sorunu bir yazÄ±lÄ±m geliÅŸtirici olarak yaklaÅŸarak ve bu ÅŸekilde Ã§Ã¶zerek bÃ¼yÃ¼k keyif alÄ±yorum. Bu makalede, bu felsefenin temel taÅŸlarÄ±ndan bahsedeceÄŸim.&lt;/p>
&lt;h2 id="iÃ§indekiler">Ä°Ã§indekiler&lt;/h2>
&lt;ul>
&lt;li>Sorumlu bir kiÅŸi olun&lt;/li>
&lt;li>Kodunuzda hiÃ§bir ÅŸeyi mahvetmeyin&lt;/li>
&lt;li>MÃ¼kemmeliyetÃ§i olmayÄ±n&lt;/li>
&lt;li>VarlÄ±ÄŸÄ±nÄ±z bilginizdir&lt;/li>
&lt;li>TopluluÄŸunuzu geliÅŸtirin!&lt;/li>
&lt;/ul>
&lt;h2 id="sorumlu-bir-kiÅŸi-olun">Sorumlu bir kiÅŸi olun&lt;/h2>
&lt;p>Bir programcÄ± olarak, yazdÄ±ÄŸÄ±nÄ±z JavaScript kodunda bir hata varsa, bu hatanÄ±n nedeninin C++ derleyicisi olduÄŸunu sÃ¶yleyemezsiniz. Bu saÃ§ma gelebilir, ancak bu durumu kendinize uyarlamayÄ± dÃ¼ÅŸÃ¼nÃ¼n!&lt;/p>
&lt;p>Bir iÅŸ almadan Ã¶nce, o iÅŸin gereksinimlerini iyi planlayÄ±n Ã§Ã¼nkÃ¼ projede uzun bir yol kat ettiÄŸinizde ve bir mÃ¼ÅŸteriye veya patronunuza gittiÄŸinizde size geÃ§erli bir soru sorarlar, &amp;ldquo;neden bunu Ã¶nceden dÃ¼ÅŸÃ¼nmediniz&amp;rdquo; Bu tÃ¼r durumlarÄ± gÃ¶z Ã¶nÃ¼nde bulundurarak iÅŸe koyulursanÄ±z, karÅŸÄ±laÅŸabileceÄŸiniz herhangi bir soruya hazÄ±rlÄ±klÄ± olun. Ancak verdiÄŸiniz cevap kesinlikle &amp;ldquo;bu imkansÄ±z yapÄ±lacak bir ÅŸey deÄŸil!&amp;rdquo; olmamalÄ±dÄ±r. O problem iÃ§in uygun farklÄ± Ã§Ã¶zÃ¼m alternatifleri sunmaya Ã§alÄ±ÅŸmalÄ±sÄ±nÄ±z.&lt;/p>
&lt;h2 id="kodunuzda-hiÃ§bir-ÅŸeyi-mahvetmeyin">Kodunuzda hiÃ§bir ÅŸeyi mahvetmeyin&lt;/h2>
&lt;p>YazÄ±lÄ±mÄ± bir bina gibi dÃ¼ÅŸÃ¼nÃ¼n, bir apartmandaki bir pencere kÄ±rÄ±ldÄ±ÄŸÄ±nda ve onarÄ±lmadÄ±ÄŸÄ±nda, baÅŸka bir pencere kÄ±rÄ±ldÄ±ÄŸÄ±nda ve kimse ilgilenmezse, bu bÃ¶yle devam eder ve sonunda duvarlara grafiti yazÄ±lmaya baÅŸlar ve bina tamamen dÃ¼zensiz hale gelir. Sonra; asla kÄ±rÄ±k bir camla yaÅŸamayÄ±n. Bu yazÄ±lÄ±m iÃ§in kÄ±rÄ±k cam Ã¶rneÄŸi, gelecekteki hatalara yol aÃ§abilecek kÃ¶tÃ¼ tasarÄ±mÄ± ve kÃ¶tÃ¼ bir kodu iÃ§erebilir.&lt;/p>
&lt;p>AslÄ±nda bu durum oldukÃ§a bilimsel, fizikte entropiyi dÃ¼ÅŸÃ¼nÃ¼rseniz, dÃ¼zensizlik her zaman artmak ister. Bunu engellememek size baÄŸlÄ±dÄ±r. YazÄ±lÄ±mda bir hata varsa, yeni bir Ã¶zellik eklemeye odaklanmaktan Ã¶nce onu dÃ¼zeltmeye odaklanÄ±n ve devam edin. Bunu yapamam dediÄŸinizde deÄŸil, yaptÄ±m dediÄŸinizde durun.&lt;/p>
&lt;h2 id="mÃ¼kemmeliyetÃ§i-olmayÄ±n">MÃ¼kemmeliyetÃ§i olmayÄ±n&lt;/h2>
&lt;p>Harika bir fikriniz varsa, Ã¼zerinde bir yÄ±l veya iki yÄ±l Ã§alÄ±ÅŸtÄ±ktan ve yayÄ±nladÄ±ktan sonra, geri bildirimlerden Ã¶ÄŸrenmek Ã§ok hayal kÄ±rÄ±klÄ±ÄŸÄ± olabilir ve gerÃ§ekten deÄŸersiz bir fikir olduÄŸunu Ã¶ÄŸrenmek. Herhangi bir projede kusursuz ilerlemeden Ã¶nce, o projenin temel Ã¶zelliklerine sahip bir MVP&amp;rsquo;ye sahip olmak ve onu yayÄ±nlamak, geri bildirimleri deÄŸerlendirmek ve her ÅŸey yolundaysa ilerlemek Ã§ok daha mantÄ±klÄ±dÄ±r.&lt;/p>
&lt;p>KÄ±sacasÄ±, mÃ¼kemmeliyetÃ§ilik genellikle yazÄ±lÄ±m iÃ§in iÅŸe yaramaz. ÃœrÃ¼nden emin olmak ve sonra onu mÃ¼kemmelleÅŸtirmek daha iyi bir fikirdir. SonuÃ§ olarak, dÃ¼nya her gÃ¼n deÄŸiÅŸiyor ve her dakika yeni teknolojiler ve Ã¼rÃ¼nler ortaya Ã§Ä±kÄ±yor!&lt;/p>
&lt;h2 id="varlÄ±ÄŸÄ±nÄ±z-bilginizdir">VarlÄ±ÄŸÄ±nÄ±z bilginizdir&lt;/h2>
&lt;p>Bilginiz ve deneyiminiz en Ã¶nemli varlÄ±ÄŸÄ±nÄ±zdÄ±r. Ancak bu varlÄ±klar zamanla eskimiÅŸ olabilir, Ã¶zellikle teknoloji dÃ¼nyasÄ±nda, her ÅŸey Ã§ok hÄ±zlÄ± bir ÅŸekilde deÄŸiÅŸiyor. Bir yÄ±l Ã¶nce sahip olduÄŸunuz deÄŸerli varlÄ±klar ÅŸimdi deÄŸersiz olabilir. Bu yÃ¼zden gÃ¼ncel kalmaya odaklanmalÄ±sÄ±nÄ±z.&lt;/p>
&lt;p>Bir bilgi ve deneyim portfÃ¶yÃ¼nÃ¼ yÃ¶netmek, finansal varlÄ±klarÄ± yÃ¶netmek gibi belirli gereksinimlere sahiptir;&lt;/p>
&lt;ol>
&lt;li>
&lt;p>Ciddi yatÄ±rÄ±mcÄ±lar alÄ±ÅŸkanlÄ±k olarak dÃ¼zenli olarak yatÄ±rÄ±m yaparlar: DÃ¼zenli olarak yatÄ±rÄ±m yaparsanÄ±z, ne kadar az veya Ã§ok kazanÄ±rsanÄ±z kazanÄ±n, toplamda bÃ¼yÃ¼k bir kar elde edersiniz.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Ã‡eÅŸitlendirme uzun vadeli baÅŸarÄ±nÄ±n anahtarÄ±dÄ±r: Ne kadar fazla teknolojiye hakim olursanÄ±z, deÄŸiÅŸime o kadar iyi adapte olabilirsiniz.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>AkÄ±llÄ± yatÄ±rÄ±mcÄ±lar portfÃ¶ylerini dÃ¼ÅŸÃ¼k risk, dÃ¼ÅŸÃ¼k getiri ve yÃ¼ksek risk, yÃ¼ksek getiri yatÄ±rÄ±mlarÄ± arasÄ±nda dengelemektedir: TÃ¼m varlÄ±ÄŸÄ±nÄ±zÄ± (zaman ve Ã§aba) gelecekte deÄŸerli olacaÄŸÄ±nÄ± dÃ¼ÅŸÃ¼ndÃ¼ÄŸÃ¼nÃ¼z yÃ¼ksek getirili bir varlÄ±ÄŸa yatÄ±rmak yerine, varlÄ±ÄŸÄ±nÄ±zÄ± gÃ¼venli dall&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>ara dalÄ±n ve varlÄ±ÄŸÄ±nÄ±zÄ± aynÄ± kutuya koymayÄ±n.&lt;/p>
&lt;ol start="4">
&lt;li>
&lt;p>YatÄ±rÄ±mcÄ±lar maksimum getiri iÃ§in dÃ¼ÅŸÃ¼k al ve yÃ¼ksek satÄ±n: Gelecekte deÄŸer kazanacaÄŸÄ±nÄ± dÃ¼ÅŸÃ¼ndÃ¼ÄŸÃ¼nÃ¼z varlÄ±klara yatÄ±rÄ±m yapmak bÃ¼yÃ¼k getiriler saÄŸlayabilir.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>PortfÃ¶yler periyodik olarak gÃ¶zden geÃ§irilmeli ve yeniden dengelenmelidir: Ã‡ok dalgalÄ± bir endÃ¼stride iÅŸ yapÄ±yoruz, bu yÃ¼zden yatÄ±rÄ±mlarÄ±nÄ±zÄ± dÃ¼zenli olarak gÃ¶zden geÃ§irmeli ve deÄŸer kaybeden varlÄ±klara dikkat etmelisiniz.&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>Ancak tÃ¼m bu hedeflerin en Ã¶nemlisi ve vazgeÃ§ilmezi dÃ¼zenli olarak yatÄ±rÄ±m yapmaktÄ±r. YatÄ±rÄ±m yapmazsanÄ±z, nereye yatÄ±rÄ±m yaparsanÄ±z yapmanÄ±zÄ±n bir Ã¶nemi yoktur. Bu hedeflere ulaÅŸmanÄ±n bir aracÄ± olarak kullanabileceÄŸiniz birkaÃ§ araÃ§ aÅŸaÄŸÄ±da verilmiÅŸtir.&lt;/p>
&lt;ol>
&lt;li>
&lt;p>Her yÄ±l en az bir yeni dil Ã¶ÄŸrenin. FarklÄ± diller aynÄ± sorunlarÄ± farklÄ± yollarla Ã§Ã¶zer. FarklÄ± yaklaÅŸÄ±mlarÄ± Ã¶ÄŸrenmek dÃ¼ÅŸÃ¼nme yeteneÄŸinizi geniÅŸletebilir ve rutine sÄ±kÄ±ÅŸÄ±p kalmaktan kaÃ§Ä±nmanÄ±za yardÄ±mcÄ± olabilir.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Her Ã§eyrek teknik bir kitap okuyun. AlÄ±ÅŸkanlÄ±k kazandÄ±ktan sonra, ayda bir kitap okuyun. Kullanmakta olduÄŸunuz teknolojileri Ã¶ÄŸrendikten sonra, farklÄ± dallarda Ã§alÄ±ÅŸÄ±n ve ilgisiz dallarda Ã§alÄ±ÅŸÄ±n.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Teknik olmayan kitaplar da okuyun. Bilgisayarlar insanlar iÃ§indir ve insanlarÄ± daha iyi anlarsanÄ±z, onlarÄ±n Ã§Ã¶zÃ¼mlerine Ã§ok daha iyi yaklaÅŸabilirsiniz.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Yerel kullanÄ±cÄ± gruplarÄ±na katÄ±lÄ±n. Sadece gitmeyin ve dinlemeyin, aktif olarak katÄ±lÄ±n. Ä°zolasyon kariyerinize Ã¶lÃ¼mcÃ¼l olabilir.&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>Bu teknolojilerden herhangi birini bir projede kullansanÄ±z veya hatta Ã¶zgeÃ§miÅŸinize koyduÄŸunuzda Ã¶nemli deÄŸil. BunlarÄ± Ã¶ÄŸrenmek Ã¶ÄŸrenme yeteneÄŸinizi artÄ±rÄ±r ve problem Ã§Ã¶zme yeteneÄŸinize katkÄ± saÄŸlar.&lt;/p>
&lt;p>Bir sorunla karÅŸÄ±laÅŸÄ±rsanÄ±z ve bunun cevabÄ±nÄ± bilmiyorsanÄ±z, bu sorunu bir hedef olarak seÃ§in ve Ã¶ÄŸrenmeye Ã§alÄ±ÅŸÄ±n. EtrafÄ±nÄ±zda bir guruya sorun, etrafÄ±nÄ±zda yoksa Ã§evrimiÃ§i bir tane bulun. Bu hem sorunu yanÄ±tlayacak hem de aÄŸÄ±nÄ±zÄ± geniÅŸletecektir. SÃ¼rekli olarak Ã¶ÄŸrenmeye devam edin. OtobÃ¼ste seyahat ederken okuyacak bir ÅŸey taÅŸÄ±yÄ±n ve deÄŸerlendirin.&lt;/p>
&lt;p>Bir kitapÃ§Ä±nÄ±n size pazarladÄ±ÄŸÄ± Ã¼rÃ¼nÃ¼n en iyi Ã¼rÃ¼nÃ¼ olmadÄ±ÄŸÄ± gibi, arama motorlarÄ±nda ilk sÄ±ralara Ã§Ä±kan iÃ§eriÄŸe gÃ¼venmeyin, doÄŸruluÄŸunu dÃ¼ÅŸÃ¼nÃ¼n ve kafanÄ±zda tartÄ±n ve sorgusuz sualsiz kabul etmeyin.&lt;/p>
&lt;h2 id="topluluÄŸunuzu-geliÅŸtirin">TopluluÄŸunuzu geliÅŸtirin!&lt;/h2>
&lt;p>Etkili iletiÅŸiminiz olmadÄ±ÄŸÄ±nda iyi bir fikir yetimdir. GeliÅŸtiriciler olarak, son kullanÄ±cÄ±larla iletiÅŸim kurarken veya belgeler oluÅŸtururken, patronlarÄ±mÄ±z veya Ã¼stlerimizle iletiÅŸim kurarken iletiÅŸim becerilerimizi kullanÄ±yoruz. Ä°letiÅŸim becerilerinizi gÃ¼Ã§lendirmenin birkaÃ§ yolu ÅŸunlardÄ±r;&lt;/p>
&lt;ol>
&lt;li>
&lt;p>Bir programcÄ± olarak gÃ¶reviniz kelime oyunlarÄ± oynamak deÄŸil, istediÄŸiniz bilgileri doÄŸru ve net bir ÅŸekilde iletmektir. Ne demek istediÄŸinizi planlayÄ±n. Bir taslak yazÄ±n. Sonra kendinize sorun, &amp;ldquo;Bu sÃ¶ylemek istediÄŸim her ÅŸeyi kapsÄ±yor mu?&amp;rdquo; Bu gereksinimi karÅŸÄ±layana kadar tekrarlayÄ±n. Bu planÄ± sadece bir belge yazarken deÄŸil, toplantÄ±lar ve konuÅŸmalar Ã¶ncesinde, hatta Ã¶nemsediÄŸiniz mÃ¼ÅŸterilerle buluÅŸmadan Ã¶nce yapÄ±n.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Bilgi aktarabiliyorsanÄ±z, doÄŸru iletiÅŸimi saÄŸlayabilirsiniz. Bu nedenle, diÄŸer kiÅŸinin karÅŸÄ±layabileceÄŸi bilgi seviyesini belirlemelisiniz.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Ä°letiÅŸimin Ã§eÅŸitli yollarÄ± vardÄ±r. BazÄ± mÃ¼ÅŸteriler e-posta ile bilgilendirilmek isteyebilirken, diÄŸerleri telefonla aranmak isteyebilir.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Ä°nsanlarÄ±n sizi dinlemesini istiyorsanÄ±z, yapmanÄ±z gereken ilk ÅŸey onlarÄ± dinlemektir. Bir toplantÄ±yÄ± diyaloga dÃ¶nÃ¼ÅŸtÃ¼rebilirseniz, bundan daha iyisi yoktur.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Ä°nsanlarÄ± bekletmeyin, size geri dÃ¶neceÄŸim, en kÄ±sa sÃ¼rede cevaplayacaÄŸÄ±m gibi ÅŸeyler sÃ¶yleyerek insanlarÄ± bekletmeyin.&lt;/p>
&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h2 id="sonuÃ§">SonuÃ§&lt;/h2>
&lt;p>OkuduÄŸunuz iÃ§in teÅŸekkÃ¼rler! ðŸŽ‰ YazÄ±lÄ±m geliÅŸtirme alanÄ±ndaki araÅŸtÄ±rmalarÄ±mÄ± kaÃ§Ä±rmamak iÃ§in &lt;a href="https://x.com/berkslv">@berkslv&lt;/a> adresinden takipte kalabilirsiniz.&lt;/p></content></item></channel></rss>